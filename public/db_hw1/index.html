<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="naver-site-verification" content="7727e68f404d4c7be584f2b673b9943ab5c6b9ab"/><meta data-react-helmet="true" name="google-site-verification" content="fygLmB3YoAnXWkSTMHoemYurOt8ZBEdT2K5M1qZQL5E"/><meta data-react-helmet="true" name="twitter:image" content="/static/9b8be93c483a945adf8eeca2ec4bf692/common2.jpg"/><meta data-react-helmet="true" name="twitter:description" content="Edward Sciore의 Java 기반 SimpleDB 개선 과제를 수행합니다."/><meta data-react-helmet="true" name="twitter:title" content="Boston College SimpleDB 개선 과제 part 1"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" property="og:site_name" content="Boston College SimpleDB 개선 과제 part 1"/><meta data-react-helmet="true" property="og:url"/><meta data-react-helmet="true" property="og:image" content="/static/9b8be93c483a945adf8eeca2ec4bf692/common2.jpg"/><meta data-react-helmet="true" property="og:description" content="Edward Sciore의 Java 기반 SimpleDB 개선 과제를 수행합니다."/><meta data-react-helmet="true" property="og:title" content="Boston College SimpleDB 개선 과제 part 1"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" http-equiv="Content-Type" content="text/html;charset=UTF-8"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1.0"/><meta data-react-helmet="true" name="description" content="Edward Sciore의 Java 기반 SimpleDB 개선 과제를 수행합니다."/><meta name="generator" content="Gatsby 4.19.2"/><style data-href="/styles.69a4e1e9c4403d061256.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:#2f2f2f;color:#eee;font-family:Roboto Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5em;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#363636}:not(pre)>code[class*=language-]{border-radius:.2em;padding:.1em;white-space:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1.25em 1em;position:relative}.language-css>code,.language-sass>code,.language-scss>code{color:#fd9170}[class*=language-] .namespace{opacity:.7}.token.atrule{color:#c792ea}.token.attr-name{color:#ffcb6b}.token.attr-value,.token.attribute{color:#a5e844}.token.boolean{color:#c792ea}.token.builtin{color:#ffcb6b}.token.cdata,.token.char{color:#80cbc4}.token.class{color:#ffcb6b}.token.class-name{color:#f2ff00}.token.comment{color:#616161}.token.constant{color:#c792ea}.token.deleted{color:#f66}.token.doctype{color:#616161}.token.entity{color:#f66}.token.function{color:#c792ea}.token.hexcode{color:#f2ff00}.token.id,.token.important{color:#c792ea;font-weight:700}.token.inserted{color:#80cbc4}.token.keyword{color:#c792ea}.token.number{color:#fd9170}.token.operator{color:#89ddff}.token.prolog{color:#616161}.token.property{color:#80cbc4}.token.pseudo-class,.token.pseudo-element{color:#a5e844}.token.punctuation{color:#89ddff}.token.regex{color:#f2ff00}.token.selector{color:#f66}.token.string{color:#a5e844}.token.symbol{color:#c792ea}.token.tag{color:#f66}.token.unit{color:#fd9170}.token.url,.token.variable{color:#f66}:host,:root{--fa-font-solid:normal 900 1em/1 "Font Awesome 6 Solid";--fa-font-regular:normal 400 1em/1 "Font Awesome 6 Regular";--fa-font-light:normal 300 1em/1 "Font Awesome 6 Light";--fa-font-thin:normal 100 1em/1 "Font Awesome 6 Thin";--fa-font-duotone:normal 900 1em/1 "Font Awesome 6 Duotone";--fa-font-brands:normal 400 1em/1 "Font Awesome 6 Brands"}svg:not(:host).svg-inline--fa,svg:not(:root).svg-inline--fa{box-sizing:content-box;overflow:visible}.svg-inline--fa{display:var(--fa-display,inline-block);height:1em;overflow:visible;vertical-align:-.125em}.svg-inline--fa.fa-2xs{vertical-align:.1em}.svg-inline--fa.fa-xs{vertical-align:0}.svg-inline--fa.fa-sm{vertical-align:-.07143em}.svg-inline--fa.fa-lg{vertical-align:-.2em}.svg-inline--fa.fa-xl{vertical-align:-.25em}.svg-inline--fa.fa-2xl{vertical-align:-.3125em}.svg-inline--fa.fa-pull-left{margin-right:var(--fa-pull-margin,.3em);width:auto}.svg-inline--fa.fa-pull-right{margin-left:var(--fa-pull-margin,.3em);width:auto}.svg-inline--fa.fa-li{top:.25em;width:var(--fa-li-width,2em)}.svg-inline--fa.fa-fw{width:var(--fa-fw-width,1.25em)}.fa-layers svg.svg-inline--fa{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.fa-layers-counter,.fa-layers-text{display:inline-block;position:absolute;text-align:center}.fa-layers{display:inline-block;height:1em;position:relative;text-align:center;vertical-align:-.125em;width:1em}.fa-layers svg.svg-inline--fa{-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-text{left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter{background-color:var(--fa-counter-background-color,#ff253a);border-radius:var(--fa-counter-border-radius,1em);box-sizing:border-box;color:var(--fa-inverse,#fff);line-height:var(--fa-counter-line-height,1);max-width:var(--fa-counter-max-width,5em);min-width:var(--fa-counter-min-width,1.5em);overflow:hidden;padding:var(--fa-counter-padding,.25em .5em);right:var(--fa-right,0);text-overflow:ellipsis;top:var(--fa-top,0);-webkit-transform:scale(var(--fa-counter-scale,.25));transform:scale(var(--fa-counter-scale,.25));-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-bottom-right{bottom:var(--fa-bottom,0);right:var(--fa-right,0);top:auto;-webkit-transform:scale(var(--fa-layers-scale,.25));transform:scale(var(--fa-layers-scale,.25));-webkit-transform-origin:bottom right;transform-origin:bottom right}.fa-layers-bottom-left{bottom:var(--fa-bottom,0);left:var(--fa-left,0);right:auto;top:auto;-webkit-transform:scale(var(--fa-layers-scale,.25));transform:scale(var(--fa-layers-scale,.25));-webkit-transform-origin:bottom left;transform-origin:bottom left}.fa-layers-top-right{right:var(--fa-right,0);top:var(--fa-top,0);-webkit-transform:scale(var(--fa-layers-scale,.25));transform:scale(var(--fa-layers-scale,.25));-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-top-left{left:var(--fa-left,0);right:auto;top:var(--fa-top,0);-webkit-transform:scale(var(--fa-layers-scale,.25));transform:scale(var(--fa-layers-scale,.25));-webkit-transform-origin:top left;transform-origin:top left}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-2xs{font-size:.625em;line-height:.1em;vertical-align:.225em}.fa-xs{font-size:.75em;line-height:.08333em;vertical-align:.125em}.fa-sm{font-size:.875em;line-height:.07143em;vertical-align:.05357em}.fa-lg{font-size:1.25em;line-height:.05em;vertical-align:-.075em}.fa-xl{font-size:1.5em;line-height:.04167em;vertical-align:-.125em}.fa-2xl{font-size:2em;line-height:.03125em;vertical-align:-.1875em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:var(--fa-li-margin,2.5em);padding-left:0}.fa-ul>li{position:relative}.fa-li{left:calc(var(--fa-li-width, 2em)*-1);line-height:inherit;position:absolute;text-align:center;width:var(--fa-li-width,2em)}.fa-border{border-color:var(--fa-border-color,#eee);border-radius:var(--fa-border-radius,.1em);border-style:var(--fa-border-style,solid);border-width:var(--fa-border-width,.08em);padding:var(--fa-border-padding,.2em .25em .15em)}.fa-pull-left{float:left;margin-right:var(--fa-pull-margin,.3em)}.fa-pull-right{float:right;margin-left:var(--fa-pull-margin,.3em)}.fa-beat{-webkit-animation-delay:var(--fa-animation-delay,0);animation-delay:var(--fa-animation-delay,0);-webkit-animation-direction:var(--fa-animation-direction,normal);animation-direction:var(--fa-animation-direction,normal);-webkit-animation-duration:var(--fa-animation-duration,1s);animation-duration:var(--fa-animation-duration,1s);-webkit-animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-iteration-count:var(--fa-animation-iteration-count,infinite);-webkit-animation-name:fa-beat;animation-name:fa-beat;-webkit-animation-timing-function:var(--fa-animation-timing,ease-in-out);animation-timing-function:var(--fa-animation-timing,ease-in-out)}.fa-bounce{-webkit-animation-delay:var(--fa-animation-delay,0);animation-delay:var(--fa-animation-delay,0);-webkit-animation-direction:var(--fa-animation-direction,normal);animation-direction:var(--fa-animation-direction,normal);-webkit-animation-duration:var(--fa-animation-duration,1s);animation-duration:var(--fa-animation-duration,1s);-webkit-animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-iteration-count:var(--fa-animation-iteration-count,infinite);-webkit-animation-name:fa-bounce;animation-name:fa-bounce;-webkit-animation-timing-function:var(--fa-animation-timing,cubic-bezier(.28,.84,.42,1));animation-timing-function:var(--fa-animation-timing,cubic-bezier(.28,.84,.42,1))}.fa-fade{-webkit-animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-iteration-count:var(--fa-animation-iteration-count,infinite);-webkit-animation-name:fa-fade;animation-name:fa-fade;-webkit-animation-timing-function:var(--fa-animation-timing,cubic-bezier(.4,0,.6,1));animation-timing-function:var(--fa-animation-timing,cubic-bezier(.4,0,.6,1))}.fa-beat-fade,.fa-fade{-webkit-animation-delay:var(--fa-animation-delay,0);animation-delay:var(--fa-animation-delay,0);-webkit-animation-direction:var(--fa-animation-direction,normal);animation-direction:var(--fa-animation-direction,normal);-webkit-animation-duration:var(--fa-animation-duration,1s);animation-duration:var(--fa-animation-duration,1s)}.fa-beat-fade{-webkit-animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-iteration-count:var(--fa-animation-iteration-count,infinite);-webkit-animation-name:fa-beat-fade;animation-name:fa-beat-fade;-webkit-animation-timing-function:var(--fa-animation-timing,cubic-bezier(.4,0,.6,1));animation-timing-function:var(--fa-animation-timing,cubic-bezier(.4,0,.6,1))}.fa-flip{-webkit-animation-delay:var(--fa-animation-delay,0);animation-delay:var(--fa-animation-delay,0);-webkit-animation-direction:var(--fa-animation-direction,normal);animation-direction:var(--fa-animation-direction,normal);-webkit-animation-duration:var(--fa-animation-duration,1s);animation-duration:var(--fa-animation-duration,1s);-webkit-animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-iteration-count:var(--fa-animation-iteration-count,infinite);-webkit-animation-name:fa-flip;animation-name:fa-flip;-webkit-animation-timing-function:var(--fa-animation-timing,ease-in-out);animation-timing-function:var(--fa-animation-timing,ease-in-out)}.fa-shake{-webkit-animation-duration:var(--fa-animation-duration,1s);animation-duration:var(--fa-animation-duration,1s);-webkit-animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-iteration-count:var(--fa-animation-iteration-count,infinite);-webkit-animation-name:fa-shake;animation-name:fa-shake;-webkit-animation-timing-function:var(--fa-animation-timing,linear);animation-timing-function:var(--fa-animation-timing,linear)}.fa-shake,.fa-spin{-webkit-animation-delay:var(--fa-animation-delay,0);animation-delay:var(--fa-animation-delay,0);-webkit-animation-direction:var(--fa-animation-direction,normal);animation-direction:var(--fa-animation-direction,normal)}.fa-spin{-webkit-animation-duration:var(--fa-animation-duration,2s);animation-duration:var(--fa-animation-duration,2s);-webkit-animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-iteration-count:var(--fa-animation-iteration-count,infinite);-webkit-animation-name:fa-spin;animation-name:fa-spin;-webkit-animation-timing-function:var(--fa-animation-timing,linear);animation-timing-function:var(--fa-animation-timing,linear)}.fa-spin-reverse{--fa-animation-direction:reverse}.fa-pulse,.fa-spin-pulse{-webkit-animation-direction:var(--fa-animation-direction,normal);animation-direction:var(--fa-animation-direction,normal);-webkit-animation-duration:var(--fa-animation-duration,1s);animation-duration:var(--fa-animation-duration,1s);-webkit-animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-iteration-count:var(--fa-animation-iteration-count,infinite);-webkit-animation-name:fa-spin;animation-name:fa-spin;-webkit-animation-timing-function:var(--fa-animation-timing,steps(8));animation-timing-function:var(--fa-animation-timing,steps(8))}@media (prefers-reduced-motion:reduce){.fa-beat,.fa-beat-fade,.fa-bounce,.fa-fade,.fa-flip,.fa-pulse,.fa-shake,.fa-spin,.fa-spin-pulse{-webkit-animation-delay:-1ms;animation-delay:-1ms;-webkit-animation-duration:1ms;animation-duration:1ms;-webkit-animation-iteration-count:1;animation-iteration-count:1;transition-delay:0s;transition-duration:0s}}@-webkit-keyframes fa-beat{0%,90%{-webkit-transform:scale(1);transform:scale(1)}45%{-webkit-transform:scale(var(--fa-beat-scale,1.25));transform:scale(var(--fa-beat-scale,1.25))}}@keyframes fa-beat{0%,90%{-webkit-transform:scale(1);transform:scale(1)}45%{-webkit-transform:scale(var(--fa-beat-scale,1.25));transform:scale(var(--fa-beat-scale,1.25))}}@-webkit-keyframes fa-bounce{0%{-webkit-transform:scale(1) translateY(0);transform:scale(1) translateY(0)}10%{-webkit-transform:scale(var(--fa-bounce-start-scale-x,1.1),var(--fa-bounce-start-scale-y,.9)) translateY(0);transform:scale(var(--fa-bounce-start-scale-x,1.1),var(--fa-bounce-start-scale-y,.9)) translateY(0)}30%{-webkit-transform:scale(var(--fa-bounce-jump-scale-x,.9),var(--fa-bounce-jump-scale-y,1.1)) translateY(var(--fa-bounce-height,-.5em));transform:scale(var(--fa-bounce-jump-scale-x,.9),var(--fa-bounce-jump-scale-y,1.1)) translateY(var(--fa-bounce-height,-.5em))}50%{-webkit-transform:scale(var(--fa-bounce-land-scale-x,1.05),var(--fa-bounce-land-scale-y,.95)) translateY(0);transform:scale(var(--fa-bounce-land-scale-x,1.05),var(--fa-bounce-land-scale-y,.95)) translateY(0)}57%{-webkit-transform:scale(1) translateY(var(--fa-bounce-rebound,-.125em));transform:scale(1) translateY(var(--fa-bounce-rebound,-.125em))}64%{-webkit-transform:scale(1) translateY(0);transform:scale(1) translateY(0)}to{-webkit-transform:scale(1) translateY(0);transform:scale(1) translateY(0)}}@keyframes fa-bounce{0%{-webkit-transform:scale(1) translateY(0);transform:scale(1) translateY(0)}10%{-webkit-transform:scale(var(--fa-bounce-start-scale-x,1.1),var(--fa-bounce-start-scale-y,.9)) translateY(0);transform:scale(var(--fa-bounce-start-scale-x,1.1),var(--fa-bounce-start-scale-y,.9)) translateY(0)}30%{-webkit-transform:scale(var(--fa-bounce-jump-scale-x,.9),var(--fa-bounce-jump-scale-y,1.1)) translateY(var(--fa-bounce-height,-.5em));transform:scale(var(--fa-bounce-jump-scale-x,.9),var(--fa-bounce-jump-scale-y,1.1)) translateY(var(--fa-bounce-height,-.5em))}50%{-webkit-transform:scale(var(--fa-bounce-land-scale-x,1.05),var(--fa-bounce-land-scale-y,.95)) translateY(0);transform:scale(var(--fa-bounce-land-scale-x,1.05),var(--fa-bounce-land-scale-y,.95)) translateY(0)}57%{-webkit-transform:scale(1) translateY(var(--fa-bounce-rebound,-.125em));transform:scale(1) translateY(var(--fa-bounce-rebound,-.125em))}64%{-webkit-transform:scale(1) translateY(0);transform:scale(1) translateY(0)}to{-webkit-transform:scale(1) translateY(0);transform:scale(1) translateY(0)}}@-webkit-keyframes fa-fade{50%{opacity:var(--fa-fade-opacity,.4)}}@keyframes fa-fade{50%{opacity:var(--fa-fade-opacity,.4)}}@-webkit-keyframes fa-beat-fade{0%,to{opacity:var(--fa-beat-fade-opacity,.4);-webkit-transform:scale(1);transform:scale(1)}50%{opacity:1;-webkit-transform:scale(var(--fa-beat-fade-scale,1.125));transform:scale(var(--fa-beat-fade-scale,1.125))}}@keyframes fa-beat-fade{0%,to{opacity:var(--fa-beat-fade-opacity,.4);-webkit-transform:scale(1);transform:scale(1)}50%{opacity:1;-webkit-transform:scale(var(--fa-beat-fade-scale,1.125));transform:scale(var(--fa-beat-fade-scale,1.125))}}@-webkit-keyframes fa-flip{50%{-webkit-transform:rotate3d(var(--fa-flip-x,0),var(--fa-flip-y,1),var(--fa-flip-z,0),var(--fa-flip-angle,-180deg));transform:rotate3d(var(--fa-flip-x,0),var(--fa-flip-y,1),var(--fa-flip-z,0),var(--fa-flip-angle,-180deg))}}@keyframes fa-flip{50%{-webkit-transform:rotate3d(var(--fa-flip-x,0),var(--fa-flip-y,1),var(--fa-flip-z,0),var(--fa-flip-angle,-180deg));transform:rotate3d(var(--fa-flip-x,0),var(--fa-flip-y,1),var(--fa-flip-z,0),var(--fa-flip-angle,-180deg))}}@-webkit-keyframes fa-shake{0%{-webkit-transform:rotate(-15deg);transform:rotate(-15deg)}4%{-webkit-transform:rotate(15deg);transform:rotate(15deg)}24%,8%{-webkit-transform:rotate(-18deg);transform:rotate(-18deg)}12%,28%{-webkit-transform:rotate(18deg);transform:rotate(18deg)}16%{-webkit-transform:rotate(-22deg);transform:rotate(-22deg)}20%{-webkit-transform:rotate(22deg);transform:rotate(22deg)}32%{-webkit-transform:rotate(-12deg);transform:rotate(-12deg)}36%{-webkit-transform:rotate(12deg);transform:rotate(12deg)}40%,to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}@keyframes fa-shake{0%{-webkit-transform:rotate(-15deg);transform:rotate(-15deg)}4%{-webkit-transform:rotate(15deg);transform:rotate(15deg)}24%,8%{-webkit-transform:rotate(-18deg);transform:rotate(-18deg)}12%,28%{-webkit-transform:rotate(18deg);transform:rotate(18deg)}16%{-webkit-transform:rotate(-22deg);transform:rotate(-22deg)}20%{-webkit-transform:rotate(22deg);transform:rotate(22deg)}32%{-webkit-transform:rotate(-12deg);transform:rotate(-12deg)}36%{-webkit-transform:rotate(12deg);transform:rotate(12deg)}40%,to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.fa-rotate-90{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-webkit-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-webkit-transform:scaleX(-1);transform:scaleX(-1)}.fa-flip-vertical{-webkit-transform:scaleY(-1);transform:scaleY(-1)}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical{-webkit-transform:scale(-1);transform:scale(-1)}.fa-rotate-by{-webkit-transform:rotate(var(--fa-rotate-angle,none));transform:rotate(var(--fa-rotate-angle,none))}.fa-stack{display:inline-block;height:2em;position:relative;vertical-align:middle;width:2.5em}.fa-stack-1x,.fa-stack-2x{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;z-index:var(--fa-stack-z-index,auto)}.svg-inline--fa.fa-stack-1x{height:1em;width:1.25em}.svg-inline--fa.fa-stack-2x{height:2em;width:2.5em}.fa-inverse{color:var(--fa-inverse,#fff)}.fa-sr-only,.fa-sr-only-focusable:not(:focus),.sr-only,.sr-only-focusable:not(:focus){clip:rect(0,0,0,0);border-width:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.svg-inline--fa .fa-primary{fill:var(--fa-primary-color,currentColor);opacity:var(--fa-primary-opacity,1)}.svg-inline--fa .fa-secondary{fill:var(--fa-secondary-color,currentColor)}.svg-inline--fa .fa-secondary,.svg-inline--fa.fa-swap-opacity .fa-primary{opacity:var(--fa-secondary-opacity,.4)}.svg-inline--fa.fa-swap-opacity .fa-secondary{opacity:var(--fa-primary-opacity,1)}.svg-inline--fa mask .fa-primary,.svg-inline--fa mask .fa-secondary{fill:#000}.fa-duotone.fa-inverse,.fad.fa-inverse{color:var(--fa-inverse,#fff)}</style><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/favicon-32x32.png?v=fe1cfd1d0f30f87b6d8f1bf6bea4c1e4" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=fe1cfd1d0f30f87b6d8f1bf6bea4c1e4"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=fe1cfd1d0f30f87b6d8f1bf6bea4c1e4"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=fe1cfd1d0f30f87b6d8f1bf6bea4c1e4"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=fe1cfd1d0f30f87b6d8f1bf6bea4c1e4"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=fe1cfd1d0f30f87b6d8f1bf6bea4c1e4"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=fe1cfd1d0f30f87b6d8f1bf6bea4c1e4"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=fe1cfd1d0f30f87b6d8f1bf6bea4c1e4"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=fe1cfd1d0f30f87b6d8f1bf6bea4c1e4"/><link rel="canonical" href="https://yangdongs.web.app/db_hw1/" data-baseprotocol="https:" data-basehost="yangdongs.web.app"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true">Boston College SimpleDB 개선 과제 part 1</title><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="alternate" type="application/rss+xml" title="Yangdongs RSS Feed" href="/rss.xml"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css vbubbu">.css-vbubbu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:100vh;overflow-x:hidden;width:100%;}</style><main class="css-vbubbu e1strnqo0"><style data-emotion="css 1pe8cy1">.css-1pe8cy1{position:fixed;margin:10px 10px;z-index:5;}</style><div class="css-1pe8cy1 e1md2nih0"><style data-emotion="css 1qhl3ja">.css-1qhl3ja{display:grid;place-items:center;width:60px;height:60px;border-radius:20px;background-color:#4ccd97;color:#ffffff;font-size:40px;cursor:pointer;box-shadow:0 0 5px rgba(0, 0, 0, 0.2);-webkit-transition:background-color 0.6s,color 0.6s;transition:background-color 0.6s,color 0.6s;}.css-1qhl3ja:hover{background-color:#ffffff;color:#4ccd97;}@media (max-width: 768px){.css-1qhl3ja{width:45px;height:45px;font-size:30px;border-radius:15px;}}</style><div class="css-1qhl3ja e1md2nih1"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="compass" class="svg-inline--fa fa-compass " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M288 256C288 273.7 273.7 288 256 288C238.3 288 224 273.7 224 256C224 238.3 238.3 224 256 224C273.7 224 288 238.3 288 256zM0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM325.1 306.7L380.6 162.4C388.1 142.1 369 123.9 349.6 131.4L205.3 186.9C196.8 190.1 190.1 196.8 186.9 205.3L131.4 349.6C123.9 369 142.1 388.1 162.4 380.6L306.7 325.1C315.2 321.9 321.9 315.2 325.1 306.7V306.7z"></path></svg></div><style data-emotion="css 12ua5r7">.css-12ua5r7{margin:10px 10px;border-radius:20px;z-index:4;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:fixed;-webkit-transition:500ms;transition:500ms;left:-600px;box-shadow:0 0 5px rgba(0, 0, 0, 0.2);background-color:white;}</style><div class="css-12ua5r7 ee3oskm2"><style data-emotion="css x68nae">.css-x68nae{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;text-align:center;margin-top:5%;margin-bottom:10%;margin:10px;}</style><div class="css-x68nae ee3oskm1"><style data-emotion="css 58nrwj">.css-58nrwj{font-size:20px;margin:15px;}.css-58nrwj:hover{border-bottom:3px solid #4ccd97;}</style><a class="css-58nrwj ee3oskm0" href="/">Home</a><a class="css-58nrwj ee3oskm0" href="/post/">Post</a><a href="https://github.com/Yanghyeondong/tech_blog#readme" class="css-58nrwj ee3oskm0">About</a></div></div></div><style data-emotion="css-global gyifnl">@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');@import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap');*{padding:0;margin:0;box-sizing:border-box;font-family:'Noto Sans KR',sans-serif;}html,body,#___gatsby{height:100%;}a,a:hover{color:inherit;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;}</style><style data-emotion="css 16cz9yp">.css-16cz9yp{position:relative;width:100%;height:400px;}@media (max-width: 768px){.css-16cz9yp{height:300px;}}</style><div class="css-16cz9yp e1opi4mu1"><style data-emotion="css 1bjn9yo">.css-1bjn9yo{z-index:-1;width:100%;height:400px;object-fit:cover;-webkit-filter:brightness(0.25);filter:brightness(0.25);}@media (max-width: 768px){.css-1bjn9yo{height:300px;}}</style><div data-gatsby-image-wrapper="" style="position:absolute" class="gatsby-image-wrapper gatsby-image-wrapper-constrained css-1bjn9yo e1opi4mu0"><div style="max-width:4288px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;2848&#x27; width=&#x27;4288&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAUGBAn/xAAVAQEBAAAAAAAAAAAAAAAAAAAGA//aAAwDAQACEAMQAAAB5dK71kxCxZrFl//EABoQAAMAAwEAAAAAAAAAAAAAAAIDBAABEiL/2gAIAQEAAQUCYnT8UZBgUeTnAdlGmkTlX1//xAAfEQEAAQQBBQAAAAAAAAAAAAABIQACESIEEzFBUfD/2gAIAQMBAT8BOTaAItjiPS4HHnZnvCqyrR0EHaZ+mv/EACQRAAECBQIHAAAAAAAAAAAAAAECEQADBCExEkEiI0JhYnGB/9oACAECAQE/AZNJMWsEEBQsO+4c+OMYsMCJdHy0dXClzqWHLBywVb1t8j//xAAlEAABBAAEBgMAAAAAAAAAAAABAhESIQADMWEEEyIjQYEyUnH/2gAIAQEABj8CVwq1FObkMvhiXMSwcSQTzMrNuNSlH0/bWMtkuD0P7dthGT/K9Aau7dRN6k4SEuCnlmXlwhxq9AnTBK0iXQSoC1BaQWV9o+Hv8wrYtW2P/8QAGxABAQEAAwEBAAAAAAAAAAAAAREhADFBYVH/2gAIAQEAAT8hzeyRxMYOnaG5wEr4SDqFvwgn4zi8o2OwLSlVG53xYHCCVRsYRDmbbkJ4EBZH4S1XSKK76/QCYIVkMnP/2gAMAwEAAgADAAAAEP8A3//EABgRAQEBAQEAAAAAAAAAAAAAAAERITEA/9oACAEDAQE/ECjYmAsacA2L1LwKAMETlj3TM3ucMPf/xAAZEQEBAQEBAQAAAAAAAAAAAAABESExAEH/2gAIAQIBAT8Qj+hF+cbJRE5SMAeJViW62cJbWM4LF//EABgQAQEBAQEAAAAAAAAAAAAAAAERADEh/9oACAEBAAE/EEIExIAegWMzLWoimoFLOVIyggR0TAG4AAUG4YIQAAHMGSH1EVCDW20FqEW8d6vEjuRRCkFRgKzAAMAIG//Z" alt=""/><picture><source type="image/webp" data-srcset="/static/9b8be93c483a945adf8eeca2ec4bf692/62671/common2.webp 1072w,/static/9b8be93c483a945adf8eeca2ec4bf692/18aba/common2.webp 2144w,/static/9b8be93c483a945adf8eeca2ec4bf692/85710/common2.webp 4288w" sizes="(min-width: 4288px) 4288px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 4288px) 4288px, 100vw" decoding="async" loading="lazy" data-src="/static/9b8be93c483a945adf8eeca2ec4bf692/d6c9d/common2.jpg" data-srcset="/static/9b8be93c483a945adf8eeca2ec4bf692/911a9/common2.jpg 1072w,/static/9b8be93c483a945adf8eeca2ec4bf692/5b411/common2.jpg 2144w,/static/9b8be93c483a945adf8eeca2ec4bf692/d6c9d/common2.jpg 4288w" alt="thumbnail"/></picture><noscript><picture><source type="image/webp" srcSet="/static/9b8be93c483a945adf8eeca2ec4bf692/62671/common2.webp 1072w,/static/9b8be93c483a945adf8eeca2ec4bf692/18aba/common2.webp 2144w,/static/9b8be93c483a945adf8eeca2ec4bf692/85710/common2.webp 4288w" sizes="(min-width: 4288px) 4288px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 4288px) 4288px, 100vw" decoding="async" loading="lazy" src="/static/9b8be93c483a945adf8eeca2ec4bf692/d6c9d/common2.jpg" srcSet="/static/9b8be93c483a945adf8eeca2ec4bf692/911a9/common2.jpg 1072w,/static/9b8be93c483a945adf8eeca2ec4bf692/5b411/common2.jpg 2144w,/static/9b8be93c483a945adf8eeca2ec4bf692/d6c9d/common2.jpg 4288w" alt="thumbnail"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><style data-emotion="css lzjgtp">.css-lzjgtp{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:768px;height:400px;margin:0 auto;padding:60px 0;color:#ffffff;}@media (max-width: 768px){.css-lzjgtp{height:330px;width:100%;padding:40px 20px;}}</style><div class="css-lzjgtp e1st1jau7"><style data-emotion="css 10qqw1">.css-10qqw1{display:-webkit-box;overflow:hidden;overflow-wrap:break-word;margin:auto 0;text-overflow:ellipsis;white-space:normal;-webkit-line-clamp:2;-webkit-box-orient:vertical;font-size:42px;font-weight:800;}@media (max-width: 768px){.css-10qqw1{font-size:30px;}}</style><div class="css-10qqw1 e1st1jau5">Boston College SimpleDB 개선 과제 part 1</div><style data-emotion="css 3gcnt2">.css-3gcnt2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:10px;font-size:18px;font-weight:700;}@media (max-width: 768px){.css-3gcnt2{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;font-size:15px;font-weight:400;}}</style><div class="css-3gcnt2 e1st1jau4"><style data-emotion="css 5yjeco">.css-5yjeco{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:start;justify-content:start;}@media (max-width: 768px){.css-5yjeco{-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}</style><div class="css-5yjeco e1st1jau3"><style data-emotion="css 1b9df66">.css-1b9df66{margin:2px 5px;padding:1px 7px 4px 7px;border-radius:6px;background-color:#49ae8e;font-size:16px;font-weight:800;color:white;}@media (max-width: 768px){.css-1b9df66{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}</style><div class="css-1b9df66 e1st1jau2">DB</div><div class="css-1b9df66 e1st1jau2">Java</div></div><style data-emotion="css 14b4j72">.css-14b4j72{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}@media (max-width: 768px){.css-14b4j72{margin:7px 7px;}}</style><div class="css-14b4j72 e1st1jau1"><style data-emotion="css nkt64x">.css-nkt64x{margin-right:10px;}</style><div class="css-nkt64x e1st1jau0"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="calendar-days" class="svg-inline--fa fa-calendar-days " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M160 32V64H288V32C288 14.33 302.3 0 320 0C337.7 0 352 14.33 352 32V64H400C426.5 64 448 85.49 448 112V160H0V112C0 85.49 21.49 64 48 64H96V32C96 14.33 110.3 0 128 0C145.7 0 160 14.33 160 32zM0 192H448V464C448 490.5 426.5 512 400 512H48C21.49 512 0 490.5 0 464V192zM64 304C64 312.8 71.16 320 80 320H112C120.8 320 128 312.8 128 304V272C128 263.2 120.8 256 112 256H80C71.16 256 64 263.2 64 272V304zM192 304C192 312.8 199.2 320 208 320H240C248.8 320 256 312.8 256 304V272C256 263.2 248.8 256 240 256H208C199.2 256 192 263.2 192 272V304zM336 256C327.2 256 320 263.2 320 272V304C320 312.8 327.2 320 336 320H368C376.8 320 384 312.8 384 304V272C384 263.2 376.8 256 368 256H336zM64 432C64 440.8 71.16 448 80 448H112C120.8 448 128 440.8 128 432V400C128 391.2 120.8 384 112 384H80C71.16 384 64 391.2 64 400V432zM208 384C199.2 384 192 391.2 192 400V432C192 440.8 199.2 448 208 448H240C248.8 448 256 440.8 256 432V400C256 391.2 248.8 384 240 384H208zM320 432C320 440.8 327.2 448 336 448H368C376.8 448 384 440.8 384 432V400C384 391.2 376.8 384 368 384H336C327.2 384 320 391.2 320 400V432z"></path></svg></div>2024.04.20.</div></div></div></div><style data-emotion="css hn6e83">.css-hn6e83{margin:auto auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}@media (min-width: 1200px){.css-hn6e83{margin-left:calc( 50% - 384px );}}@media (max-width: 768px){.css-hn6e83{width:100%;}}</style><div class="css-hn6e83 e6b6ljm0"><style data-emotion="css aco8as">.css-aco8as{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:768px;margin:0 auto;padding:100px 0;word-break:break-all;line-height:2.5;font-size:18px;font-weight:400;}.css-aco8as p{padding:3px 0;}.css-aco8as strong{margin:0px 1px;font-size:18.3px;font-weight:800;}.css-aco8as h1,.css-aco8as h2{font-weight:800;margin-bottom:20px;}.css-aco8as h3{margin-bottom:0px;}.css-aco8as *+h1,.css-aco8as *+h2,.css-aco8as *+h3{margin-top:50px;}.css-aco8as *+h4{margin-top:25px;}.css-aco8as hr+h1,.css-aco8as hr+h2,.css-aco8as hr+h3{margin-top:0;}.css-aco8as hr+h4{margin-top:25px;}.css-aco8as h1{font-size:40px;}.css-aco8as h2{font-size:35px;}.css-aco8as h3{font-size:23px;color:#49ae8e;}.css-aco8as blockquote{margin:30px 10px;padding:5px 15px;border-left:2px solid #49ae8e;background-color:#f9f9f9;font-weight:400;}.css-aco8as blockquote li{font-size:18px;margin:0px 15px;padding:0px 10px 0px 5px;background-color:#f9f9f9;}.css-aco8as blockquote ol li::Marker{font-weight:800;color:#000;}.css-aco8as em{padding-right:8px;padding-left:3px;}.css-aco8as ol{margin-left:20px;padding:5px 0;}.css-aco8as ol li::Marker{font-weight:800;font-size:19px;color:#49ae8e;}.css-aco8as ul{margin:20px;margin-right:0px;}.css-aco8as ul li::Marker{content:"▶ ";font-weight:800;color:#49ae8e;}.css-aco8as li{font-size:17px;margin:10px 20px;padding-left:10px;padding-right:10px;background-color:#f9f9f9;border-radius:10px;}.css-aco8as li strong{font-size:17.5px;}.css-aco8as del{-webkit-text-decoration:line-through 3px solid rgba(0, 0, 0, .4);text-decoration:line-through 3px solid rgba(0, 0, 0, .4);}.css-aco8as hr{border:1px solid #000000;margin:100px 0;}.css-aco8as a{font-weight:800;color:#49ae8e;-webkit-text-decoration:underline 1px;text-decoration:underline 1px;text-underline-position:under;}.css-aco8as a:hover{color:#ffffff;background-color:#49ae8e;}.css-aco8as pre[class*='language-']{font-weight:300;padding:20px 30px;margin-bottom:15px;font-size:20px;border-radius:10px;border:1px solid #dddddd;}.css-aco8as pre[class*='language-']::-webkit-scrollbar-thumb{background:rgba(255, 255, 255, 0.5);}.css-aco8as pre[class*='language-'] *{font-family:'Roboto Mono',monospace;font-weight:400;}.css-aco8as code[class*='language-']{font-size:16px;margin-right:4px;}.css-aco8as :not(pre)>code[class*="language-"]{font-size:15px;margin-right:4px;margin-left:4px;color:#000000;background-color:#fafafa;border:1px solid #dddddd;padding:1px 4px 3px 4px;border-radius:5px;}.css-aco8as :not(pre)>code[class*="language-"]::selection{background-color:#dadada;}@media (max-width: 768px){.css-aco8as{width:100%;padding:80px 20px;line-height:2.0;font-size:16px;}.css-aco8as h1{font-size:26px;}.css-aco8as h2{font-size:23px;}.css-aco8as h3{font-size:20px;}.css-aco8as strong{margin:0px 3px;font-size:17px;font-weight:800;}.css-aco8as img{width:100%;}.css-aco8as hr{margin:50px 0;}.css-aco8as li{font-size:16px;}}</style><div class="css-aco8as e1ijh0y10"><p>과거 데이터베이스개론 수업을 들으며 진행했던 DB 개선 과제를 복습겸 정리했습니다.</p>
<h2 id="1-simpledb란-주의-aws-simpledb아님" style="position:relative;"><a href="#1-simpledb%EB%9E%80-%EC%A3%BC%EC%9D%98-aws-simpledb%EC%95%84%EB%8B%98" aria-label="1 simpledb란 주의 aws simpledb아님 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. SimpleDB란? (주의! AWS SimpleDB아님)</h2>
<p>Boston College의 Edward Sciore 교수님이 논문으로 발표한 Java 기반의 다중 사용자 DB입니다.<br>
주로 교육용으로 자주 사용됩니다! 관련 논문은 다음과 같습니다.<br>
<a href="https://dl.acm.org/doi/10.1145/1227504.1227498" target="_blank" rel="nofollow">SimpleDB: a simple java-based multiuser syst for teaching database internals</a></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 302px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/3f2e40f33f45999ea7c4f4d548074380/83034/001.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 180.20833333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAIAAAAGkY33AAAACXBIWXMAAAsTAAALEwEAmpwYAAADfUlEQVRIx31V69KiOBT0/Z/QKlQMuYfcJSj4qbOk2Yw7u7X9gzqEAOfS3TmUUqy1McYQgq8IFa4ihBArEGAPnpZSDiklpRRjzDl3u92GYRBC5Jz7vldK5ZwJIQiEEEop55xSylqbUjrknEMIwzDEGD+fz/v9/vwTr9fr34vP5zPGeAghXK9XIQRjbBgGVkErWvy9iNvr9RpC2P5sjBFCOOdSSoyxcRydc+M4cs6FEN57zrmU0jlnKzjnxpgt7ZSSc45SKoQIITDGlFLYja9orYdhoJRKKSmlWmvGWAhhexkFc86RM/IHpJSc8xZwzgkhSAfvb39GG1NK2GStRT8JId57pVTf99ZaxhiywCf2tFFVjFFrzTl3zqEEQggoME3Tz8/PPM/LskwVpZS926ICOWutpZRIVQhBKTXGlFJSSrfbLeeMN0GnQ4wRTULPUZKsQDn4RBsYmkcI2f6MUXHO53lGb0E1cPB+v2NCzrm5AiPYu42GnU4nIcRS8Xg8vq8IvrGuayll6zYYhpEgpf/BUEEp/c0wcF1rHWNUSkkprbUYgTFmHEfowVoLzRhjnHM55y1trXXf98MwgGHon5SSEMIY45yD/BiklPJ6vd5ut61h3nu8SQhBSt/J/7HYbvu+39MGE7z3psJaa4yRUmqtvfdIG4ttz97tnDO4XkpZlmWe5/v9Ps/zNE3zPK/r+ng8SsU8z4jvFXu3z+fz6XSSUuKr4xfayh/rnPONYSkldK89UBXjOOoK8ze01iAi4p0kIQStdduNhjvnwFAMTGsN2oIOcI6N21AiuD0MA/iM/3POz+czKAQnhPLHcdxGFWOEGWAHgqZ+6KQ9bW6xCwMkge6xA9pgjLVsY4zWWhgTtIBgr7k1yRiDYBxHxti6rp//wm69MUaYW9MwGoPKEXwDK7sNhRDa/el0gsKEEDCqbxmB7bBBSules/ceQwJP8PNSCo6Lhvf73YJlWX43DEV67621iHGypQoEMcacM+J9zqAndNN1HWPscrlQSruuI4Qcj0fU0nXd5XI5Ho993xNCuq7bfTuEgFMPZwqMdlmW5/MJu30+n8uyvF6vdjtN095tCBBDYoxBTwAE1KTWrnDIA6qH9NYKmN79C7htTojF1+u16zmEAHNCIjgNUQ7cC+cJqArrfTweB5z92ArroJSCD9ApynHOtYMO1v3Xy78AeAjEUDGghV0AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/3f2e40f33f45999ea7c4f4d548074380/a59e9/001.webp 192w,
/static/3f2e40f33f45999ea7c4f4d548074380/794ea/001.webp 302w"
              sizes="(max-width: 302px) 100vw, 302px"
              type="image/webp"
            />
          <source
            srcset="/static/3f2e40f33f45999ea7c4f4d548074380/3b721/001.png 192w,
/static/3f2e40f33f45999ea7c4f4d548074380/83034/001.png 302w"
            sizes="(max-width: 302px) 100vw, 302px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/3f2e40f33f45999ea7c4f4d548074380/83034/001.png"
            alt="."
            title="."
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span><br>
SimpleDB 컴포넌트 구조</p>
<h2 id="2-simpledb-실행-방법-embedded-mode" style="position:relative;"><a href="#2-simpledb-%EC%8B%A4%ED%96%89-%EB%B0%A9%EB%B2%95-embedded-mode" aria-label="2 simpledb 실행 방법 embedded mode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. SimpleDB 실행 방법 (Embedded mode)</h2>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token comment"># 데이터베이스 테이블/레코드 생성</span>
$ <span class="token builtin class-name">cd</span> <span class="token variable">$SDBHOME</span>/target 
$ <span class="token function">java</span> <span class="token parameter variable">-cp</span> ./simpledb-project-1.0.0.jar simpleclient.embedded.CreateStudentDB
<span class="token comment"># 데이터베이스 내 레코드 확인</span>
$ <span class="token function">java</span> <span class="token parameter variable">-cp</span> ./simpledb-project-1.0.0.jar	simpleclient.embedded.StudentMajor
<span class="token comment"># 데이터베이스 삭제</span>
$ <span class="token builtin class-name">cd</span> <span class="token variable">$SDBHOME</span>/target/studentdb 
$ <span class="token function">rm</span> –i *.tbl
<span class="token comment"># Interactive shell을 실행</span>
$ <span class="token builtin class-name">cd</span> <span class="token variable">$SDBHOME</span>/target 
$ <span class="token function">java</span> <span class="token parameter variable">-cp</span> ./simpledb-project-1.0.0.jar simpleclient.SimpleIJ</code></pre></div>
<h2 id="목표-improving-buffer-manager-lru-midpoint-insertion-policy" style="position:relative;"><a href="#%EB%AA%A9%ED%91%9C-improving-buffer-manager-lru-midpoint-insertion-policy" aria-label="목표 improving buffer manager lru midpoint insertion policy permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>목표: Improving Buffer Manager (LRU, midpoint-insertion policy)</h2>
<p>SimpleDB의 vanila buffer manager는 다음과 같은 한계점이 존재한다.</p>
<ol>
<li>buffer replace 정책에서 항상 맨 앞에오는 unpinned buffer만 사용한다.</li>
<li>이미 buffer에 있는 블록을 확인할때 단순히 선형 탐색만 한다.</li>
</ol>
<p>buffer manager를 수정하여 위의 2가지 정책을 조금더 효율적으로 바꿀수 있는 LRU policy, midpoint-insertion policy를 구현해보자. midpoint-insertion policy는 다음 포스트에서 다룬다.
향상된 성능은 hit ratio 성능로 확인.</p>
<h2 id="구현-및-테스트" style="position:relative;"><a href="#%EA%B5%AC%ED%98%84-%EB%B0%8F-%ED%85%8C%EC%8A%A4%ED%8A%B8" aria-label="구현 및 테스트 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>구현 및 테스트</h2>
<h3 id="1-buffer-클래스-필수-구현-항목" style="position:relative;"><a href="#1-buffer-%ED%81%B4%EB%9E%98%EC%8A%A4-%ED%95%84%EC%88%98-%EA%B5%AC%ED%98%84-%ED%95%AD%EB%AA%A9" aria-label="1 buffer 클래스 필수 구현 항목 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Buffer 클래스 필수 구현 항목</h3>
<p>각 버퍼 객체는 자신의 buffer ID를 알 수 있어야 한다. 생성자에서 buffer ID를 가리키는 3번째 매개변수가 있어야한다. getID() 메소드를 통해 buffer ID를 반환받을 수 있도록 한다.</p>
<p>Buffer.java</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Buffer</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span> <span class="token class-name">FileMgr</span> fm<span class="token punctuation">;</span>  <span class="token comment">/* File manager */</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>생략<span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token keyword">int</span> bid<span class="token punctuation">;</span>
<span class="token comment">// 버퍼 내에서 buffer ID를 가리키는 변수 bid를 추가한다.</span>

<span class="token keyword">public</span> <span class="token class-name">Buffer</span><span class="token punctuation">(</span><span class="token class-name">FileMgr</span> fm<span class="token punctuation">,</span> <span class="token class-name">LogMgr</span> lm<span class="token punctuation">,</span> <span class="token keyword">int</span> bid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>fm <span class="token operator">=</span> fm<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>lm <span class="token operator">=</span> lm<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>bid <span class="token operator">=</span> bid<span class="token punctuation">;</span>
      contents <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Page</span><span class="token punctuation">(</span>fm<span class="token punctuation">.</span><span class="token function">blockSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token comment">// 생성자에서 buffer ID를 가리키는 3번째 매개변수를 추가한다.</span>

<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> bid<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token comment">// 자신의 buffer ID를 반환하는 getID() 메소드를 구현한다.</span>

<span class="token keyword">public</span> <span class="token class-name">VanillaBufferMgr</span><span class="token punctuation">(</span><span class="token class-name">FileMgr</span> fm<span class="token punctuation">,</span> <span class="token class-name">LogMgr</span> lm<span class="token punctuation">,</span> <span class="token keyword">int</span> numbuffs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>생략<span class="token punctuation">)</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>numbuffs<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
         bufferpool<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">(</span>fm<span class="token punctuation">,</span> lm<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">LRUBufferMgr</span><span class="token punctuation">(</span><span class="token class-name">FileMgr</span> fm<span class="token punctuation">,</span> <span class="token class-name">LogMgr</span> lm<span class="token punctuation">,</span> <span class="token keyword">int</span> numbuffs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>생략<span class="token punctuation">)</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>buff_size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
         unpin_buffer<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">(</span>fm<span class="token punctuation">,</span> lm<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>위의 버퍼 클래스 생성자 변화에 따라, 버퍼 매니저에서도 새로운 n개 버퍼 생성시 BlockID를 0~n-1까지 할당한다.</p>
<h3 id="2-vanillabuffermgr-클래스-필수-구현-항목" style="position:relative;"><a href="#2-vanillabuffermgr-%ED%81%B4%EB%9E%98%EC%8A%A4-%ED%95%84%EC%88%98-%EA%B5%AC%ED%98%84-%ED%95%AD%EB%AA%A9" aria-label="2 vanillabuffermgr 클래스 필수 구현 항목 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. VanillaBufferMgr 클래스 필수 구현 항목</h3>
<p>printStatus() 메소드를 호출하면 자신의 현재 상태를 나타내야한다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">/* Write your code */</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Allocated Buffers:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Buffer</span> buff <span class="token operator">:</span> bufferpool<span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Buffer "</span> <span class="token operator">+</span> buff<span class="token punctuation">.</span><span class="token function">getID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token string">": "</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">String</span> is_pin <span class="token operator">=</span> <span class="token string">"unpinned"</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>buff<span class="token punctuation">.</span><span class="token function">block</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>buff<span class="token punctuation">.</span><span class="token function">block</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token keyword">if</span> <span class="token punctuation">(</span>buff<span class="token punctuation">.</span><span class="token function">isPinned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
            is_pin <span class="token operator">=</span> <span class="token string">"pinned"</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>is_pin<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>각 버퍼의 ID, block, pinnedStatus를 출력한다. buff.block()의 경우 BlockId의 toString() 메소드를 호출하여 [filename, blkID] string을 만들어 낸다. 아직 버퍼가 할당되지 않았을 경우, BlockId는 비어있으므로 해당 부분은 출력하지 않았다.</p>
<p>getHitRatio() 메소드 호출 시 현재 버퍼의 hit ratio를 나타낸다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VanillaBufferMgr</span> <span class="token keyword">implements</span> <span class="token class-name">BufferMgr</span> <span class="token punctuation">{</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>생략<span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token keyword">int</span> hit_cnt<span class="token punctuation">;</span>
   <span class="token keyword">private</span> <span class="token keyword">int</span> reference_cnt<span class="token punctuation">;</span>
<span class="token comment">// hit ratio 계산에 활용되는 두 변수를 할당해 준다.</span>

<span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token class-name">Buffer</span> <span class="token function">pin</span><span class="token punctuation">(</span><span class="token class-name">BlockId</span> blk<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
         <span class="token keyword">long</span> timestamp <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">Buffer</span> buff <span class="token operator">=</span> <span class="token function">tryToPin</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">while</span> <span class="token punctuation">(</span>buff <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">waitingTooLong</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">MAX_TIME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            buff <span class="token operator">=</span> <span class="token function">tryToPin</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>buff <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BufferAbortException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">else</span> <span class="token punctuation">{</span>reference_cnt<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
         <span class="token keyword">return</span> buff<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BufferAbortException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>reference cnt는 블럭을 pin하려는 경우, 해당 블럭 반환이 성공적일 때만 증가한다. 따라서 tryToPin(blk) 를 했을때 반환되는 buff가 널이 아닌경우, 즉 성공했을 경우에만(에러가 아닌 경우) reference_cnt++;를 해주었다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token class-name">Buffer</span> <span class="token function">tryToPin</span><span class="token punctuation">(</span><span class="token class-name">BlockId</span> blk<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">Buffer</span> buff <span class="token operator">=</span> <span class="token function">findExistingBuffer</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>buff <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// not find in buffer</span>
         buff <span class="token operator">=</span> <span class="token function">chooseUnpinnedBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>buff <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
         buff<span class="token punctuation">.</span><span class="token function">assignToBlock</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// find in buffer</span>
         hit_cnt<span class="token operator">++</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span> 
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>buff<span class="token punctuation">.</span><span class="token function">isPinned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         numAvailable<span class="token operator">--</span><span class="token punctuation">;</span> <span class="token comment">// new allocate becaues not in buffer</span>
      buff<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> buff<span class="token punctuation">;</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>hit cnt는 현재 버퍼풀에 pin하고자 하는 블럭이 있을 경우 증가하므로, findExistingBuffer(blk)의 결과값이 널이 아닐때, 즉 찾았을 때만 hit_cnt++로 증가시켜 주었다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">RoundingMode</span></span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>생략<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">float</span> <span class="token function">getHitRatio</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/*Write your code */</span>
   <span class="token comment">//  System.out.println(hit_cnt+" / "+reference_cnt); </span>
    <span class="token keyword">float</span> hit_ratio <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>hit_cnt <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>reference_cnt<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token class-name">BigDecimal</span> hit_ratio_bd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span>hit_ratio<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BigDecimal</span> hit_ratio_bd_r2 <span class="token operator">=</span> hit_ratio_bd<span class="token punctuation">.</span><span class="token function">setScale</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token class-name">RoundingMode</span><span class="token punctuation">.</span><span class="token constant">HALF_UP</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> hit_ratio_bd_r2<span class="token punctuation">.</span><span class="token function">floatValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Hit ratio: buffer hit cnt/reference cnt * 100 (%) 공식에 따라 계산한 값을 반환하는 메소드이다. Round to two decimal places를 충족하기위해 BigDecimal과 RoundingMode를 사용하였다. 기존의 float형태의 hit_ratio을 BigDecimal(hit_ratio)로 변환하고, setScale(2, RoundingMode.HALF_UP)을 통해 소숫점 2자리까지 반올림 해주었다. 반환할때는 다시 floatValue()로 변환하여 리턴한다.</p>
<h3 id="3-lrubuffermgr-필수-구현-항목" style="position:relative;"><a href="#3-lrubuffermgr-%ED%95%84%EC%88%98-%EA%B5%AC%ED%98%84-%ED%95%AD%EB%AA%A9" aria-label="3 lrubuffermgr 필수 구현 항목 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. LRUBufferMgr 필수 구현 항목</h3>
<p>※ LRUBufferMgr 구현에 있어 VanillaBufferMgr의 메소드 tryToPin(), findExistingBuffer(), chooseUnpinnedBuffer() 등을 재활용 하였다.</p>
<p>Unpinned buffer의 리스트를 따로 관리한다. Allocated buffer들에 대해 map을 유지한다</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LRUBufferMgr</span> <span class="token keyword">implements</span> <span class="token class-name">BufferMgr</span> <span class="token punctuation">{</span>

   <span class="token keyword">private</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Buffer</span><span class="token punctuation">></span></span> unpin_buffer<span class="token punctuation">;</span>
   <span class="token keyword">private</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BlockId</span><span class="token punctuation">,</span><span class="token class-name">Buffer</span><span class="token punctuation">></span></span> alloc_buffer<span class="token punctuation">;</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>생략<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">LRUBufferMgr</span><span class="token punctuation">(</span><span class="token class-name">FileMgr</span> fm<span class="token punctuation">,</span> <span class="token class-name">LogMgr</span> lm<span class="token punctuation">,</span> <span class="token keyword">int</span> numbuffs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>생략<span class="token punctuation">)</span>
      unpin_buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Buffer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      alloc_buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BlockId</span><span class="token punctuation">,</span><span class="token class-name">Buffer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>buff_size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
         unpin_buffer<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">(</span>fm<span class="token punctuation">,</span> lm<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>위와 같이 LinkedList<Buffer> 클래스를 사용하여 unpin_buffer를 만들고, HashMap&#x3C;BlockId,Buffer> 를 활용하여 alloc_buffer를 만들었다. alloc_buffer의 경우 과제 명세 설명 “Keep a map of allocated buffers, keyed on the block they contain.” 처럼 map의 일종인 hashmap을 활용했으며, BlockId를 key로 하여 Buffer를 value로 담도록 하였다.
2) Unpinned buffer 작동</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token class-name">Buffer</span> <span class="token function">chooseUnpinnedBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>unpin_buffer<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token class-name">Buffer</span> buff <span class="token operator">=</span> unpin_buffer<span class="token punctuation">.</span><span class="token function">getFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         unpin_buffer<span class="token punctuation">.</span><span class="token function">removeFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">return</span> buff<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>과제 명세 설명 “When a replacement buffer is needed, remove the buffer at the head of the list and use it.” 를 위와 같이 구현하였다. chooseUnpinnedBuffer()를 통해 replacement buffer가 요청되면, unpin_buffer에서 getFirst()를 통해 가장 앞에 있는 버퍼(head)를 반환한다. 단, 반환하기 전에 removeFirst()통해 버퍼에서 지운다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">unpin</span><span class="token punctuation">(</span><span class="token class-name">Buffer</span> buff<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      buff<span class="token punctuation">.</span><span class="token function">unpin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>buff<span class="token punctuation">.</span><span class="token function">isPinned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         unpin_buffer<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>과제 명세 설명 “When a buffer’s pin count becomes 0, add it to the end of the list.” 를 위와 같이 구현하였다. 버퍼의 pin count가 0이 되는 순간은 unpin을 할때 발생한다. 이때 buff.isPinned()가 false 라면, 즉, pin count가 0이라면 addLast(buff)를 통해 unpin_buffer의 마지막에 버퍼를 넣어준다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token class-name">Buffer</span> <span class="token function">tryToPin</span><span class="token punctuation">(</span><span class="token class-name">BlockId</span> blk<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">Buffer</span> buff <span class="token operator">=</span> <span class="token function">findExistingBuffer</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>buff <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// not find in buffer</span>
         buff <span class="token operator">=</span> <span class="token function">chooseUnpinnedBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>buff <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
         alloc_buffer<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>buff<span class="token punctuation">.</span><span class="token function">block</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         buff<span class="token punctuation">.</span><span class="token function">assignToBlock</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
         alloc_buffer<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>blk<span class="token punctuation">,</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// find in buffer</span>
         hit_cnt<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      unpin_buffer<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> buff<span class="token punctuation">;</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>과제 명세 설명 “Use LRU policy” 를 위와 같이 구현하였다. LRU 정책에 따라, unpin되어있는 버퍼가 touch 될 경우 리스트에서 뽑은 다음 맨 마지막으로 순서를 바꿔줘야 한다. 단, 여기서 touch는 pin을 의미하므로, 결국 해당 버퍼는 Unpinned buffer에서 빠지게 된다.</p>
<p>Allocated buffer 구현</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">LRUBufferMgr</span><span class="token punctuation">(</span><span class="token class-name">FileMgr</span> fm<span class="token punctuation">,</span> <span class="token class-name">LogMgr</span> lm<span class="token punctuation">,</span> <span class="token keyword">int</span> numbuffs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>생략<span class="token punctuation">)</span>
      unpin_buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Buffer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      alloc_buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BlockId</span><span class="token punctuation">,</span><span class="token class-name">Buffer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>buff_size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
         unpin_buffer<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">(</span>fm<span class="token punctuation">,</span> lm<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token class-name">Buffer</span> <span class="token function">tryToPin</span><span class="token punctuation">(</span><span class="token class-name">BlockId</span> blk<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">Buffer</span> buff <span class="token operator">=</span> <span class="token function">findExistingBuffer</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>buff <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// not find in buffer</span>
         buff <span class="token operator">=</span> <span class="token function">chooseUnpinnedBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>buff <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
         alloc_buffer<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>buff<span class="token punctuation">.</span><span class="token function">block</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         buff<span class="token punctuation">.</span><span class="token function">assignToBlock</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
         alloc_buffer<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>blk<span class="token punctuation">,</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// find in buffer</span>
         hit_cnt<span class="token operator">++</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"hit buff id: "</span><span class="token operator">+</span>buff<span class="token punctuation">.</span><span class="token function">getID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">" block: "</span><span class="token operator">+</span>buff<span class="token punctuation">.</span><span class="token function">block</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>
      unpin_buffer<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> buff<span class="token punctuation">;</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>과제 명세 설명  “A buffer starts out unallocated. It becomes allocated when it is first assigned to a block and stays allocated forever after. When a buffer is firty allocated, it must be added to map. When a buffer is replaced, the map must be changed. the mapping for the old block must be removed, and the mapping for the new block must be added.”을 위와 같이 구현하였다.</p>
<p>최초 Constructor에서는 모든 버퍼가 아직 할당 전이므로 unpin_buffer에만 등록되고 alloc_buffer는 비어있다. 이후 tryToPin()에서 현재 버퍼에 없을때 실제로 첫 할당이 이루어진다.<br>
여기서, remove()의 경우에는 해시 맵에 있을때만 해당 원소가 제거되므로, 최초 등록시에는 put()만 작동하여 무조건 alloc_buffer에 버퍼가 등록된다. 따라서 “It becomes allocated when it is first assigned to a block”가 충족된다.<br>
그리고 한번 등록되면 그 이후로는 remove()와 put()이 쌍으로 작동하므로 “mapping for the old block must be removed, and the mapping for the new block must be added”를 수행하며, “allocated forever after” 도 충족한다(지우고나서 항상 다시 등록하므로).</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token class-name">Buffer</span> <span class="token function">findExistingBuffer</span><span class="token punctuation">(</span><span class="token class-name">BlockId</span> blk<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>alloc_buffer<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token class-name">Buffer</span> buff <span class="token operator">=</span> alloc_buffer<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">return</span> buff<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>과제 명세 설명 “Use a map to determine if a block is currently in the buffer.” 을 위와 같이 구현하였다. findExistingBuffer()를 통해 현재 alloc_buffer에 버퍼가 있는지 확인하며, alloc_buffer.containsKey(blk) 가 참이라면 해당 blk에 해당하는 버퍼를 반환한다. 만약 없다면, null을 반환한다.</p>
<p>printStatus() 구현</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Allocated Buffers:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">BlockId</span> i <span class="token operator">:</span> alloc_buffer<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token class-name">Buffer</span> buff <span class="token operator">=</span> alloc_buffer<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">String</span> is_pin <span class="token operator">=</span> <span class="token string">"unpinned"</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>buff<span class="token punctuation">.</span><span class="token function">isPinned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> is_pin <span class="token operator">=</span> <span class="token string">"pinned"</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Buffer "</span> <span class="token operator">+</span> buff<span class="token punctuation">.</span><span class="token function">getID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">": "</span> <span class="token operator">+</span> buff<span class="token punctuation">.</span><span class="token function">block</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> is_pin<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Unpinned Buffers in LRU order: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Buffer</span> buff <span class="token operator">:</span> unpin_buffer<span class="token punctuation">)</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>buff<span class="token punctuation">.</span><span class="token function">getID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>과제 명세 설명 “Map 내의 각 버퍼의 ID, block, pinnedStatus, unpinned list의 buffer”에 따라 위와 같이 구현하였다. alloc_buffer Map에 존재하는 모든 key들에 대해 value, 즉 버퍼들을 불러와서 해당 버퍼들의 정보를 출력한다. buff.block().toString()을 활용하였다. unpinned buffer의 경우, 앞에서 부터 순차적으로 순회하며 값들을 출력하도록 하였다.</p>
<p>getHitRatio() 구현</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token class-name">Buffer</span> <span class="token function">pin</span><span class="token punctuation">(</span><span class="token class-name">BlockId</span> blk<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
         <span class="token keyword">long</span> timestamp <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">Buffer</span> buff <span class="token operator">=</span> <span class="token function">tryToPin</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">while</span> <span class="token punctuation">(</span>buff <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">waitingTooLong</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">MAX_TIME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            buff <span class="token operator">=</span> <span class="token function">tryToPin</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>buff <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BufferAbortException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">else</span> <span class="token punctuation">{</span>reference_cnt<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
         <span class="token keyword">return</span> buff<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BufferAbortException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token class-name">Buffer</span> <span class="token function">tryToPin</span><span class="token punctuation">(</span><span class="token class-name">BlockId</span> blk<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">Buffer</span> buff <span class="token operator">=</span> <span class="token function">findExistingBuffer</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>buff <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// not find in buffer</span>
         buff <span class="token operator">=</span> <span class="token function">chooseUnpinnedBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>buff <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
         alloc_buffer<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>buff<span class="token punctuation">.</span><span class="token function">block</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         buff<span class="token punctuation">.</span><span class="token function">assignToBlock</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
         alloc_buffer<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>blk<span class="token punctuation">,</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// find in buffer</span>
         hit_cnt<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      unpin_buffer<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>buff<span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> buff<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">float</span> <span class="token function">getHitRatio</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">float</span> hit_ratio <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>hit_cnt <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>reference_cnt<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">;</span>
      <span class="token class-name">BigDecimal</span> hit_ratio_bd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span>hit_ratio<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">BigDecimal</span> hit_ratio_bd_r2 <span class="token operator">=</span> hit_ratio_bd<span class="token punctuation">.</span><span class="token function">setScale</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token class-name">RoundingMode</span><span class="token punctuation">.</span><span class="token constant">HALF_UP</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> hit_ratio_bd_r2<span class="token punctuation">.</span><span class="token function">floatValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>getHitRatio()의 경우, VanillaBufferMgr와 동일하게 적용했다. tryToPin(blk) 를 했을때 반환되는 buff가 널이 아닌경우, 즉 성공했을 경우에만(에러가 아닌 경우) reference_cnt++;가 되고, findExistingBuffer(blk) 의 결과값이 널이 아닐때, 즉 원하는 블럭을 찾았을 때만 hit_cnt++가 된다. 최종적으로는 cnt/reference cnt * 100 (%) 공식과 BigDecimal과 RoundingMode를 사용해 소숫점 2자리까지 반올림하여 리턴한다.</p>
<p>기타 구현
위에 소개되지 않았으나, LRU 구현에 사용한 부분들을 정리하였다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">int</span> <span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> unpin_buffer<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>VanillaBufferMgr 에서는 버퍼 중에서 pinned 되어 있지 않은 버퍼들에 대해 numAvailable 변수를 따로 관리한다. 해당 값은 pin을 할때 새로운 버퍼가 할당되면 감소하고, 기존의 버퍼가 unpin 되면 감소한다. LRUBufferMgr에서는 이러한 변수가 따로 필요없다. Unpinned buffer 자체가 해당 역할을 하며, 해당 리스트의 길이가 결국 가능한 버퍼의 수를 뜻하기 때문이다. 따라서 available() 에서는 size()를 반환했다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java">   <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">flushAll</span><span class="token punctuation">(</span><span class="token keyword">int</span> txnum<span class="token punctuation">)</span><span class="token punctuation">{</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">BlockId</span> i <span class="token operator">:</span> alloc_buffer<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token class-name">Buffer</span> buff <span class="token operator">=</span> alloc_buffer<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>buff<span class="token punctuation">.</span><span class="token function">modifyingTx</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> txnum<span class="token punctuation">)</span>
         buff<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Buffer</span> buff <span class="token operator">:</span> unpin_buffer<span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>buff<span class="token punctuation">.</span><span class="token function">modifyingTx</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> txnum<span class="token punctuation">)</span>
         buff<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>VanillaBufferMgr 에서는 flushAll()을 진행하면 버퍼풀에 있는 모든 버퍼에 대해 buff.modifyingTx() == txnum를 만족하면 buff.flush();를 진행한다. LRUBufferMgr 에서는  Unpinned buffer, Allocated buffer 속 모든 버퍼에 대해서 flush()를 하도록 하였다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token constant">MAX_TIME</span> <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">waitingTooLong</span><span class="token punctuation">(</span><span class="token keyword">long</span> starttime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> starttime <span class="token operator">></span> <span class="token constant">MAX_TIME</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token class-name">Buffer</span> <span class="token function">pin</span><span class="token punctuation">(</span><span class="token class-name">BlockId</span> blk<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
         <span class="token keyword">long</span> timestamp <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">Buffer</span> buff <span class="token operator">=</span> <span class="token function">tryToPin</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">while</span> <span class="token punctuation">(</span>buff <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">waitingTooLong</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">MAX_TIME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            buff <span class="token operator">=</span> <span class="token function">tryToPin</span><span class="token punctuation">(</span>blk<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>buff <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BufferAbortException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">else</span> <span class="token punctuation">{</span>reference_cnt<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
         <span class="token keyword">return</span> buff<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BufferAbortException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span></code></pre></div>
<p>기존 VanillaBufferMgr와 동일하게, LRUBufferMgr에서도 MAX_TIME을 정해서 일정 시간 이상 tryToPin()에 실패할 경우 에러를 발생시키도록 하였다.</p>
<h3 id="4-테스트" style="position:relative;"><a href="#4-%ED%85%8C%EC%8A%A4%ED%8A%B8" aria-label="4 테스트 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 테스트</h3>
<p>Buffer
getID() 테스트</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BufferMgrTest</span> <span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
      <span class="token class-name">SimpleDB</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDB</span><span class="token punctuation">(</span><span class="token string">"buffermgrtest"</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"vanilla"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">BufferMgr</span> bm <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">bufferMgr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token class-name">Buffer</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
      buff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"testfile"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"testfile"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"testfile"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"testfile"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Buffer</span> buf <span class="token operator">:</span> buff<span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>buf <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"bid: "</span> <span class="token operator">+</span> buf<span class="token punctuation">.</span><span class="token function">getID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
결과
bid<span class="token operator">:</span> <span class="token number">0</span>
bid<span class="token operator">:</span> <span class="token number">1</span>
bid<span class="token operator">:</span> <span class="token number">2</span>
bid<span class="token operator">:</span> <span class="token number">3</span></code></pre></div>
<p>ID가 잘 출력되는 것을 확인할 수 있다.</p>
<p>VanillaBufferMgr
printStatus() 테스트</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BufferMgrTest</span> <span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
      <span class="token class-name">SimpleDB</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDB</span><span class="token punctuation">(</span><span class="token string">"buffermgrtest"</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"vanilla"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">BufferMgr</span> bm <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">bufferMgr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token class-name">Buffer</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
      buff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      bm<span class="token punctuation">.</span><span class="token function">unpin</span><span class="token punctuation">(</span>buff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      buff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      bm<span class="token punctuation">.</span><span class="token function">unpin</span><span class="token punctuation">(</span>buff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      buff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

      bm<span class="token punctuation">.</span><span class="token function">printStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
결과
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>file test<span class="token punctuation">,</span> block <span class="token number">0</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>file test<span class="token punctuation">,</span> block <span class="token number">1</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>file test<span class="token punctuation">,</span> block <span class="token number">2</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>file test<span class="token punctuation">,</span> block <span class="token number">3</span><span class="token punctuation">]</span> pinned</code></pre></div>
<p>과제 명세과 동일하게 잘 출력된다.</p>
<p>getHitRatio() 및 예제 코드 테스트</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BufferMgrTest</span> <span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
      <span class="token class-name">SimpleDB</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDB</span><span class="token punctuation">(</span><span class="token string">"buffermgrtest"</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"vanilla"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// only 3 buffers</span>
      <span class="token class-name">BufferMgr</span> bm <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">bufferMgr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token class-name">Buffer</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
      buff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"testfile"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>생략<span class="token punctuation">)</span>

      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"hit ratio: "</span> <span class="token operator">+</span> bm<span class="token punctuation">.</span><span class="token function">getHitRatio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
결과
<span class="token class-name">Available</span> buffers<span class="token operator">:</span> <span class="token number">0</span>
<span class="token class-name">Attempting</span> <span class="token keyword">to</span> <span class="token namespace">pin</span> block <span class="token number">3.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token class-name">Exception</span><span class="token operator">:</span> <span class="token class-name">No</span> available buffers

<span class="token class-name">Final</span> <span class="token class-name">Buffer</span> <span class="token class-name">Allocation</span><span class="token operator">:</span>
buff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> pinned <span class="token keyword">to</span> <span class="token namespace">block</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">0</span><span class="token punctuation">]</span>
buff<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> pinned <span class="token keyword">to</span> <span class="token namespace">block</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">0</span><span class="token punctuation">]</span>
buff<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> pinned <span class="token keyword">to</span> <span class="token namespace">block</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">1</span><span class="token punctuation">]</span>
buff<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> pinned <span class="token keyword">to</span> <span class="token namespace">block</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">3</span><span class="token punctuation">]</span>
hit ratio<span class="token operator">:</span> <span class="token number">33.33</span></code></pre></div>
<p>중간에 try가 실패한 buff[5] = bm.pin(new BlockId(“testfile”, 3))를 제외하면 총 6번의 pin에 대한 성공적인 반환이 존재한다. 따라서 reference cnt = 6. 그리고 bm.pin(new BlockId(“testfile”, 0)) 과 bm.pin(new BlockId(“testfile”, 1)) 에서 현재 버퍼풀에 존재하는 블럭을 요청하였으므로 2번의 hit이 발생한다. 따라서  hit ratio = 2 / 6 = 33.3333 이되고, 두자리 반올림에 따라 33.33이 성공적으로 반환이 된다.</p>
<h3 id="lrubuffermgr" style="position:relative;"><a href="#lrubuffermgr" aria-label="lrubuffermgr permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>LRUBufferMgr</h3>
<p>printStatus() 테스트</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BufferMgrTest</span> <span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
      <span class="token class-name">SimpleDB</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDB</span><span class="token punctuation">(</span><span class="token string">"buffermgrtest"</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"lru"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">BufferMgr</span> bm <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">bufferMgr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token class-name">Buffer</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
      buff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      bm<span class="token punctuation">.</span><span class="token function">unpin</span><span class="token punctuation">(</span>buff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      buff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      bm<span class="token punctuation">.</span><span class="token function">unpin</span><span class="token punctuation">(</span>buff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      buff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

      bm<span class="token punctuation">.</span><span class="token function">printStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
결과
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>file test<span class="token punctuation">,</span> block <span class="token number">1</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>file test<span class="token punctuation">,</span> block <span class="token number">0</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>file test<span class="token punctuation">,</span> block <span class="token number">3</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>file test<span class="token punctuation">,</span> block <span class="token number">2</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Unpinned</span> <span class="token class-name">Buffers</span> in <span class="token constant">LRU</span> order<span class="token operator">:</span> <span class="token number">2</span> <span class="token number">0</span></code></pre></div>
<p>과제 명세과 동일하게 잘 출력된다.</p>
<p>getHitRatio() 및 예제 코드 테스트</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BufferMgrTest</span> <span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
      <span class="token class-name">SimpleDB</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDB</span><span class="token punctuation">(</span><span class="token string">"buffermgrtest"</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"lru"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// only 3 buffers</span>
      <span class="token class-name">BufferMgr</span> bm <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">bufferMgr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token class-name">Buffer</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
      buff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"testfile"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>생략<span class="token punctuation">)</span>

      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"hit ratio: "</span> <span class="token operator">+</span> bm<span class="token punctuation">.</span><span class="token function">getHitRatio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
결과
<span class="token class-name">Available</span> buffers<span class="token operator">:</span> <span class="token number">0</span>
<span class="token class-name">Attempting</span> <span class="token keyword">to</span> <span class="token namespace">pin</span> block <span class="token number">3.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token class-name">Exception</span><span class="token operator">:</span> <span class="token class-name">No</span> available buffers

<span class="token class-name">Final</span> <span class="token class-name">Buffer</span> <span class="token class-name">Allocation</span><span class="token operator">:</span>
buff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> pinned <span class="token keyword">to</span> <span class="token namespace">block</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">0</span><span class="token punctuation">]</span>
buff<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> pinned <span class="token keyword">to</span> <span class="token namespace">block</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">0</span><span class="token punctuation">]</span>
buff<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> pinned <span class="token keyword">to</span> <span class="token namespace">block</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">1</span><span class="token punctuation">]</span>
buff<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> pinned <span class="token keyword">to</span> <span class="token namespace">block</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">3</span><span class="token punctuation">]</span>
hit ratio<span class="token operator">:</span> <span class="token number">33.33</span></code></pre></div>
<p>잘 출력된다.</p>
<p>hit ratio 차이 확인</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BufferMgrTest</span> <span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
      <span class="token class-name">SimpleDB</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDB</span><span class="token punctuation">(</span><span class="token string">"buffermgrtest"</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"vanilla"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// only 3 buffers</span>
      <span class="token class-name">BufferMgr</span> bm <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">bufferMgr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token class-name">Buffer</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
      bm<span class="token punctuation">.</span><span class="token function">printStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"testfile"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"testfile"</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"testfile"</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"testfile"</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"testfile"</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      bm<span class="token punctuation">.</span><span class="token function">printStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      bm<span class="token punctuation">.</span><span class="token function">unpin</span><span class="token punctuation">(</span>buff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      bm<span class="token punctuation">.</span><span class="token function">unpin</span><span class="token punctuation">(</span>buff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      bm<span class="token punctuation">.</span><span class="token function">unpin</span><span class="token punctuation">(</span>buff<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      bm<span class="token punctuation">.</span><span class="token function">printStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"testfile"</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// repin</span>
      bm<span class="token punctuation">.</span><span class="token function">printStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      bm<span class="token punctuation">.</span><span class="token function">unpin</span><span class="token punctuation">(</span>buff<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      bm<span class="token punctuation">.</span><span class="token function">printStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"testfile"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      bm<span class="token punctuation">.</span><span class="token function">printStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buff<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> bm<span class="token punctuation">.</span><span class="token function">pin</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockId</span><span class="token punctuation">(</span><span class="token string">"testfile"</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// repin</span>
      bm<span class="token punctuation">.</span><span class="token function">printStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"hit ratio: "</span> <span class="token operator">+</span> bm<span class="token punctuation">.</span><span class="token function">getHitRatio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token constant">LRU</span> 결과
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Unpinned</span> <span class="token class-name">Buffers</span> in <span class="token constant">LRU</span> order<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> 
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">10</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">14</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">13</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">12</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">11</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Unpinned</span> <span class="token class-name">Buffers</span> in <span class="token constant">LRU</span> order<span class="token operator">:</span> 
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">10</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">14</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">13</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">12</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">11</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Unpinned</span> <span class="token class-name">Buffers</span> in <span class="token constant">LRU</span> order<span class="token operator">:</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> 
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">10</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">14</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">13</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">12</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">11</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Unpinned</span> <span class="token class-name">Buffers</span> in <span class="token constant">LRU</span> order<span class="token operator">:</span> <span class="token number">2</span> <span class="token number">3</span> 
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">10</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">14</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">13</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">12</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">11</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Unpinned</span> <span class="token class-name">Buffers</span> in <span class="token constant">LRU</span> order<span class="token operator">:</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">1</span> 
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">10</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">20</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">14</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">13</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">11</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Unpinned</span> <span class="token class-name">Buffers</span> in <span class="token constant">LRU</span> order<span class="token operator">:</span> <span class="token number">3</span> <span class="token number">1</span> 
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">10</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">20</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">14</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">13</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">11</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Unpinned</span> <span class="token class-name">Buffers</span> in <span class="token constant">LRU</span> order<span class="token operator">:</span> <span class="token number">3</span> 
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
hit ratio<span class="token operator">:</span> <span class="token number">25.0</span></code></pre></div>
<p>우선 최초의 pin 이전에는 모두 Unpinned Buffers에 있으며 Allocated Buffers에는 없는 것을 확인할 수있다. 최초pin이모두 끝나면 Allocated Buffers 에 전부 할당되며, Unpinned Buffers는 비어 있음을 확인 할 수 있다. 이후 unpin 된 순서대로 버퍼가 리스트에 쌓이며, 만약 그중에서 하나를 새로 pin하면 해당 버퍼는 리스트에 빠진다. 테스트에서는 block 11이 pin으로 리스트에서 빠졌다가 unpin으로 다시 맨 뒤에 추가된 모습이 보인다. 이때 새로운 block 20을 할당하면 가장 오래된 2번 버퍼가 교체되게 된다.2번 버퍼는 리스트에서 빠지고 새롭게 20을 할당 받는다. 따라서 최종적인 레퍼런스는 8번, hit은 block 11에 대해서 2번이므로 hit ratio: 25.0 이다.
Vanilla 결과</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">4</span><span class="token operator">:</span> unpinned
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">10</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">11</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">12</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">13</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">14</span><span class="token punctuation">]</span> pinned
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">10</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">11</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">12</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">13</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">14</span><span class="token punctuation">]</span> pinned
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">10</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">11</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">12</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">13</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">14</span><span class="token punctuation">]</span> pinned
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">10</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">11</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">12</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">13</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">14</span><span class="token punctuation">]</span> pinned
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">10</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">20</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">12</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">13</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">14</span><span class="token punctuation">]</span> pinned
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token class-name">Allocated</span> <span class="token class-name">Buffers</span><span class="token operator">:</span>
<span class="token class-name">Buffer</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">10</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">20</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">11</span><span class="token punctuation">]</span> pinned
<span class="token class-name">Buffer</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">13</span><span class="token punctuation">]</span> unpinned
<span class="token class-name">Buffer</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token punctuation">[</span>file testfile<span class="token punctuation">,</span> block <span class="token number">14</span><span class="token punctuation">]</span> pinned
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
hit ratio<span class="token operator">:</span> <span class="token number">12.5</span></code></pre></div>
<p>바닐라의 경우, 위와 동일하지만 교체되는 버퍼가 Buffer 2가 아니라 Buffer 1이 된다. 언제 사용되었는지와 상관없이 1이 제일 앞에 있기 때문이다. 결국 LRU와 다르게 마지막 pin에서 block11 은 hit에 실패하고 Buffer 2를 교체하며. 새로 불러오게 된다. 따라서 따라서 최종적인 레퍼런스는 8번, hit은 block 11에 대해서 1번이므로 hit ratio: 12.5 이다. LRU와  Vanilla에서 차이를 확인가능하다.</p>
<h2 id="source" style="position:relative;"><a href="#source" aria-label="source permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Source</h2>
<ul>
<li>『SimpleDB: a simple java-based multiuser syst for teaching database internals』<br>
<em>Edward Sciore - 지음</em><br>
<a href="https://dl.acm.org/doi/10.1145/1227504.1227498" target="_blank" rel="nofollow">https://dl.acm.org/doi/10.1145/1227504.1227498</a></li>
</ul></div><style data-emotion="css pit38s">.css-pit38s{height:auto;}</style><div class="css-pit38s etse75s1"><style data-emotion="css v7bn0g">.css-v7bn0g{position:-webkit-sticky;position:sticky;top:50px;display:inline-block;margin:120px 40px;margin-right:0px;height:auto;width:200px;font-size:14.5px;border-left:3px solid #4ccd97;}@media (max-width: 1200px){.css-v7bn0g{display:none;}}.css-v7bn0g li{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding:5px;color:gray;}.css-v7bn0g ul{margin-left:10px;padding:7px 5px;list-style:none;}.css-v7bn0g a:hover{-webkit-transition:0.3s;transition:0.3s;font-size:15px;font-weight:700;color:#433E49;}</style><div class="css-v7bn0g etse75s0"><ul>
<li>
<p><a href="#1-simpledb%EB%9E%80-%EC%A3%BC%EC%9D%98-aws-simpledb%EC%95%84%EB%8B%98">1. SimpleDB란? (주의! AWS SimpleDB아님)</a></p>
</li>
<li>
<p><a href="#2-simpledb-%EC%8B%A4%ED%96%89-%EB%B0%A9%EB%B2%95-embedded-mode">2. SimpleDB 실행 방법 (Embedded mode)</a></p>
</li>
<li>
<p><a href="#%EB%AA%A9%ED%91%9C-improving-buffer-manager-lru-midpoint-insertion-policy">목표: Improving Buffer Manager (LRU, midpoint-insertion policy)</a></p>
</li>
<li>
<p><a href="#%EA%B5%AC%ED%98%84-%EB%B0%8F-%ED%85%8C%EC%8A%A4%ED%8A%B8">구현 및 테스트</a></p>
<ul>
<li><a href="#1-buffer-%ED%81%B4%EB%9E%98%EC%8A%A4-%ED%95%84%EC%88%98-%EA%B5%AC%ED%98%84-%ED%95%AD%EB%AA%A9">1. Buffer 클래스 필수 구현 항목</a></li>
<li><a href="#2-vanillabuffermgr-%ED%81%B4%EB%9E%98%EC%8A%A4-%ED%95%84%EC%88%98-%EA%B5%AC%ED%98%84-%ED%95%AD%EB%AA%A9">2. VanillaBufferMgr 클래스 필수 구현 항목</a></li>
<li><a href="#3-lrubuffermgr-%ED%95%84%EC%88%98-%EA%B5%AC%ED%98%84-%ED%95%AD%EB%AA%A9">3. LRUBufferMgr 필수 구현 항목</a></li>
<li><a href="#4-%ED%85%8C%EC%8A%A4%ED%8A%B8">4. 테스트</a></li>
<li><a href="#lrubuffermgr">LRUBufferMgr</a></li>
</ul>
</li>
<li>
<p><a href="#source">Source</a></p>
</li>
</ul></div></div></div><style data-emotion="css qi68kj">.css-qi68kj{width:768px;margin:auto auto;padding:0 10px;}@media (max-width: 768px){.css-qi68kj{width:100%;padding:0 20px;}}</style><div class="css-qi68kj elyfc7a0"><div id="disqus_thread"></div></div><style data-emotion="css 9w9jmx">.css-9w9jmx{display:grid;place-items:center;margin-top:auto;padding:50px 0;font-size:15px;text-align:center;line-height:1.5;}@media (max-width: 768px){.css-9w9jmx{font-size:13px;}}</style><footer class="css-9w9jmx e1oae0v81"><style data-emotion="css chvw2h">.css-chvw2h{width:80px;height:80px;background-image:url('bartender.png');-webkit-background-size:contain;background-size:contain;margin:20px auto 0px auto;}</style><div class="css-chvw2h e1oae0v80"></div>Just an developer with drinks<br/>2022 HyeonDong, Powered By Gatsby.</footer></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/db_hw1/";window.___webpackCompilationHash="bfb743b8b9fb1efb5fa1";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-c9fa82aa5b1f9c65f078.js"],"app":["/app-e9f3f84a858e449c6845.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-c686bcb9fd021576da4f.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-a996845aa9f72e17dba7.js"],"component---src-pages-post-tsx":["/component---src-pages-post-tsx-66acd32db55f17007543.js"],"component---src-templates-post-template-tsx":["/component---src-templates-post-template-tsx-676c0d609cc6ccc353e7.js"]};/*]]>*/</script><script src="/polyfill-c9fa82aa5b1f9c65f078.js" nomodule=""></script><script src="/app-e9f3f84a858e449c6845.js" async=""></script><script src="/framework-c57a9454c0e3bef16c3b.js" async=""></script><script src="/webpack-runtime-301cd6e2ec1b80fcee8f.js" async=""></script></body></html>