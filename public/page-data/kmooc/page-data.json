{"componentChunkName":"component---src-templates-post-template-tsx","path":"/kmooc/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p><em>주의!</em><br>\n<em>본 코드는 KMOOC 강좌를 수강하는 성실한 학생들의 편의성을 높이고자 개발되었습니다.</em><br>\n<em>다른 용도로 사용하였을때 책임은 본인에게 있습니다.</em></p>\n<h2 id=\"kmooc를-듣게된-계기-문제-인식\" style=\"position:relative;\"><a href=\"#kmooc%EB%A5%BC-%EB%93%A3%EA%B2%8C%EB%90%9C-%EA%B3%84%EA%B8%B0-%EB%AC%B8%EC%A0%9C-%EC%9D%B8%EC%8B%9D\" aria-label=\"kmooc를 듣게된 계기 문제 인식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>KMOOC를 듣게된 계기, 문제 인식</h2>\n<p>4학년 2학기 수업중 하나로, KMOOC를 선택했습니다. 실제 성균관대학교 교수님의 수업을 들으면 학점으로 인정해주는 매우 좋은 제도입니다. 😎 하지만 KMOOC 시스템에는 한가지 단점이 있는데요, 바로 강좌가 굉장히 짧은 단위로 여러개 분리되어 있다는 점입니다.<br>\n<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f7e09e82cc0fc1d3929c76b8cb896cce/4219d/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.645833333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABNklEQVQoz31Ti46CQAzc///NUw+Iigj7pO1cWh6Cym3SbIeGYaYt7nypERKj7QraZ8FzGDEEAhMhhAARgJktZxGIyIyj3TI/C3HCrm075MKIiRASIWUNtmJKeSVIOe8ItcY8Y5GpzgJ3qe6m0Agj2Z3KQpigZ8llR/jCGnHG7re6wkeCDyN6P9qtSokIMcaVIJol2eC0Wn7VGa5qHogbhWo5zwpLKesLS77EEXbny6Rw8KOFKlRy++ps48jy2lO1PCt2t1uLwRO6vqBXu5Ggo6V1yvKa8sayN8xvdbVc1ej6EY9nxr3LtjrEE6H/IORD7L2fCJumsb3rhmIq1a4e+raHu6Hsh7TspWvqGjGz9U+XOsQRZeRJoQ8bBeGN4MDyz+mK6ppwqqIpVGLtI/OnQvnnT1nW5g9EEF8Fw5m8kwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f7e09e82cc0fc1d3929c76b8cb896cce/a59e9/1.webp 192w,\n/static/f7e09e82cc0fc1d3929c76b8cb896cce/0ca9f/1.webp 384w,\n/static/f7e09e82cc0fc1d3929c76b8cb896cce/dc9b9/1.webp 768w,\n/static/f7e09e82cc0fc1d3929c76b8cb896cce/addc7/1.webp 866w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f7e09e82cc0fc1d3929c76b8cb896cce/3b721/1.png 192w,\n/static/f7e09e82cc0fc1d3929c76b8cb896cce/66595/1.png 384w,\n/static/f7e09e82cc0fc1d3929c76b8cb896cce/fe486/1.png 768w,\n/static/f7e09e82cc0fc1d3929c76b8cb896cce/4219d/1.png 866w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f7e09e82cc0fc1d3929c76b8cb896cce/fe486/1.png\"\n            alt=\"1\"\n            title=\"1\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\r\n<br>\n평소 학교 I-campus에 있는 강의들은 1시간~1시간 30분씩 집중해서 들을 수 있는 반면에, KMOOC는 5분마다 강의를 껐다 켰다 너무 번거로웠습니다.\r\n그래서, 자동으로 시간이 되면 다음 강의를 시청할 수 있도록 하는 프로그램을 떠올렸습니다.</p>\n<h2 id=\"python-코드-작성\" style=\"position:relative;\"><a href=\"#python-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1\" aria-label=\"python 코드 작성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Python 코드 작성</h2>\n<p>과거 웹 크롤링 수업을 들었던 경험을 바탕으로, 셀레니움을 사용해서 다음과 같은 코드를 작성했습니다. kmooc 홈페이지가 뜨는 순간, 30초 이내로 로그인을 하시고 강좌 화면으로 이동하시면 됩니다. 그러면 이후에 자동으로 강좌가 순서대로 재생됩니다. 2024.10.18일 기준으로 정상작동을 확인하였습니다.<br>\n많은 학생분들에게 도움이 되었으면 합니다. 😆</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\r\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>by <span class=\"token keyword\">import</span> By\r\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>action_chains <span class=\"token keyword\">import</span> ActionChains\r\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>keys <span class=\"token keyword\">import</span> Keys\r\n<span class=\"token keyword\">import</span> time\r\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>exceptions <span class=\"token keyword\">import</span> UnexpectedAlertPresentException<span class=\"token punctuation\">,</span> NoAlertPresentException\r\n\r\n<span class=\"token comment\"># 드라이버 설정 (크롬)</span>\r\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\"># 로그인 페이지로 이동</span>\r\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"https://www.kmooc.kr/\"</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\"># 사용자가 로그인할 시간을 줌</span>\r\n<span class=\"token comment\"># 수강하고자 하는 강좌 화면까지 들어갈 것</span>\r\ntime<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\r\n\r\nactivity_list <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_elements<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>CSS_SELECTOR<span class=\"token punctuation\">,</span> <span class=\"token string\">\"li.activity.vod.modtype_vod\"</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">for</span> activity <span class=\"token keyword\">in</span> activity_list<span class=\"token punctuation\">:</span>\r\n    <span class=\"token comment\"># 수업 영상 중 '완료함'이나 '완료하지 못함'이 있는지 확인</span>\r\n    completion_status <span class=\"token operator\">=</span> activity<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>CSS_SELECTOR<span class=\"token punctuation\">,</span> <span class=\"token string\">\"span.autocompletion img\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>get_attribute<span class=\"token punctuation\">(</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">)</span>\r\n\r\n    <span class=\"token comment\"># '완료함'이면 패스하고 다음으로</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token string\">'완료함'</span> <span class=\"token keyword\">in</span> completion_status<span class=\"token punctuation\">:</span>\r\n        <span class=\"token keyword\">continue</span>\r\n\r\n    <span class=\"token comment\"># '완료하지 못함'이면 실행</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token string\">'완료하지 못함'</span> <span class=\"token keyword\">in</span> completion_status<span class=\"token punctuation\">:</span>\r\n        <span class=\"token comment\"># 'a' 태그 요소 클릭 (동영상 화면 열기)</span>\r\n        activity<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>CSS_SELECTOR<span class=\"token punctuation\">,</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\n        <span class=\"token comment\"># 팝업창으로 핸들 전환</span>\r\n        driver<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>window<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">.</span>window_handles<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n\r\n        <span class=\"token comment\"># 팝업창의 정 중앙 클릭 (시작버튼)</span>\r\n        popup_body <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>TAG_NAME<span class=\"token punctuation\">,</span> <span class=\"token string\">'body'</span><span class=\"token punctuation\">)</span>\r\n        ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>move_to_element<span class=\"token punctuation\">(</span>popup_body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\n        <span class=\"token comment\"># 이어서보기 알림창이 있는지 확인하고 처리</span>\r\n        <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\r\n            alert <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>alert\r\n            alert<span class=\"token punctuation\">.</span>accept<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 알림창의 확인 버튼 클릭</span>\r\n        <span class=\"token keyword\">except</span> NoAlertPresentException<span class=\"token punctuation\">:</span>\r\n            <span class=\"token keyword\">pass</span>  <span class=\"token comment\"># 알림창이 없으면 무시</span>\r\n\r\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n\r\n        duration_element <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>CSS_SELECTOR<span class=\"token punctuation\">,</span> <span class=\"token string\">\"span.vjs-duration-display\"</span><span class=\"token punctuation\">)</span>\r\n        duration_text <span class=\"token operator\">=</span> duration_element<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\n        <span class=\"token comment\"># \"8:23\" 같은 시간 텍스트를 분과 초로 분리</span>\r\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>duration_text<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">':'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n        minutes<span class=\"token punctuation\">,</span> seconds <span class=\"token operator\">=</span> <span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> duration_text<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">':'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\r\n        <span class=\"token comment\"># 총 시간을 초로 변환</span>\r\n        total_seconds <span class=\"token operator\">=</span> minutes <span class=\"token operator\">*</span> <span class=\"token number\">60</span> <span class=\"token operator\">+</span> seconds <span class=\"token operator\">+</span> <span class=\"token number\">60</span>\r\n\r\n        <span class=\"token comment\"># 해당 시간만큼 대기</span>\r\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span>total_seconds<span class=\"token punctuation\">)</span>\r\n\r\n        <span class=\"token comment\"># 팝업창 닫기</span>\r\n        driver<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\n        <span class=\"token comment\"># 원래 창으로 돌아가기</span>\r\n        driver<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>window<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">.</span>window_handles<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\"># 모든 작업 완료 후 브라우저 종료</span>\r\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>","id":"507950b4-7bf2-5482-91a4-bed1b2da9e46","tableOfContents":"<ul>\n<li><a href=\"#kmooc%EB%A5%BC-%EB%93%A3%EA%B2%8C%EB%90%9C-%EA%B3%84%EA%B8%B0-%EB%AC%B8%EC%A0%9C-%EC%9D%B8%EC%8B%9D\">KMOOC를 듣게된 계기, 문제 인식</a></li>\n<li><a href=\"#python-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1\">Python 코드 작성</a></li>\n</ul>","frontmatter":{"title":"셀레니움 기반 KMOOC 수강 도우미 코드 개발","summary":"KMOOC 강좌 수강을 도와주는 파이썬 코드를 소개합니다","date":"2024.10.18.","categories":["Python","Tip"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAQFBwn/xAAaAQABBQEAAAAAAAAAAAAAAAAAAgMEBQcI/9oADAMBAAIQAxAAAAHrAzONwjreqqVUz7oNqAP/xAAbEAABBAMAAAAAAAAAAAAAAAAEAQYQFAIDBf/aAAgBAQABBQKeg3L+/FsKgYAlEKf/xAAiEQACAQMCBwAAAAAAAAAAAAABAhEDEiEEQQAFEBMUIjH/2gAIAQMBAT8Bq6nXo8UuXd5LiL/Lo0/W4i61hORBj7mNuFJKqWFrFQWWZtJGRO8HE9f/xAAgEQACAgICAgMAAAAAAAAAAAACAwESERMEIQUiABAV/9oACAECAQE/AU8Hw5rWTvOwhhVuv8zlt15QBlFwLBUeRozHU69sepRHxgrFjBWzasTMQbQg2BBTAsoXsFxwVS7HOJ7j7//EACUQAAAGAQIGAwAAAAAAAAAAAAECAwQSExEFFAAVISMkcRAgQf/aAAgBAQAGPwL51BbnGrtA1BBqhBm4BLabZVqrayNgaVltrFY8TSA49MFidJpzrV+0iVAHV/ljFKoFxW6+VjAXiUe3IkMnFThszst26RUrIVzj+12Kx9WH9/T/xAAgEAEAAQQBBQEAAAAAAAAAAAABEQAhQZFRIDFhcfCB/9oACAEBAAE/Id6+4dPFfjr7NvdQlkRyJCexpZqIImeGGgTTSkV2MIm8gs9wMlEcZGc55jOxOej/2gAMAwEAAgADAAAAEPfAAP/EABgRAQEBAQEAAAAAAAAAAAAAAAERIQAQ/9oACAEDAQE/ECDUbkAFpTE4bOnsusQhGLKmGMpj7//EABgRAQEBAQEAAAAAAAAAAAAAAAERIRBB/9oACAECAQE/ECbK9zbAXGMdRnulEjRTApOzp3//xAAcEAEBAQEBAAMBAAAAAAAAAAABESExABBRYaH/2gAIAQEAAT8Qjma41HtjIyjOCPUjpw7rNm5n8MdzyhAGII+gCP4g+a1P8FXqgojepMFrwWPgZeI+8dljzJlMskoW4ing+f/Z"},"images":{"fallback":{"src":"/static/b3b130c1898521246ac868a337d30278/242a6/logo.jpg","srcSet":"/static/b3b130c1898521246ac868a337d30278/e353f/logo.jpg 225w,\n/static/b3b130c1898521246ac868a337d30278/79280/logo.jpg 450w,\n/static/b3b130c1898521246ac868a337d30278/242a6/logo.jpg 900w","sizes":"(min-width: 900px) 900px, 100vw"},"sources":[{"srcSet":"/static/b3b130c1898521246ac868a337d30278/1cf63/logo.webp 225w,\n/static/b3b130c1898521246ac868a337d30278/a8a76/logo.webp 450w,\n/static/b3b130c1898521246ac868a337d30278/8363b/logo.webp 900w","type":"image/webp","sizes":"(min-width: 900px) 900px, 100vw"}]},"width":900,"height":900}},"publicURL":"/static/b3b130c1898521246ac868a337d30278/logo.jpg"}}}}]}},"pageContext":{"slug":"/kmooc/"}},"staticQueryHashes":[]}