{"componentChunkName":"component---src-templates-post-template-tsx","path":"/k8s_prac_4_2/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p><em>해당 포스트는 교재 『쿠버네티스 교과서』를 활용하며,</em><br>\n<em>환경은 Kubernetes v1.28. Docker Desktop으로 진행합니다.</em></p>\n<h2 id=\"개념-요약\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EB%85%90-%EC%9A%94%EC%95%BD\" aria-label=\"개념 요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개념 요약</h2>\n<h3 id=\"k8s-비밀값\" style=\"position:relative;\"><a href=\"#k8s-%EB%B9%84%EB%B0%80%EA%B0%92\" aria-label=\"k8s 비밀값 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>k8s 비밀값</h3>\n<p>컨피그맵과 비슷하지만, 클러스터 내부에서 별도로 관리되며, 노출이 최소화되는 리소스이다.<br>\n해당 값을 사용하는 노드에만 전달되며, 디스크가 아닌 메모리에 저장된다. 전달 과정과 저장에 모두 암호화가 적용된다.</p>\n<h3 id=\"비밀값-주의점\" style=\"position:relative;\"><a href=\"#%EB%B9%84%EB%B0%80%EA%B0%92-%EC%A3%BC%EC%9D%98%EC%A0%90\" aria-label=\"비밀값 주의점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>비밀값 주의점</h3>\n<p>비밀값의 파드 컨테이너에 전달된 순간부터는 평문이 담긴 텍스트파일이 된다. 이를 환경변수로 줄 경우, 애플리케이션에 따라 다른곳에 노출될 위험이 있다. 실제 서비스 운영에서는 민감한 데이터를 YAML에 포함시켜서는 안된다. 애플리케이션을 배치할 때 추가적인 처리를 거쳐야한다. ex.) 깃허브 시크릿 기능 활용</p>\n<h3 id=\"k8s에서의-애플리케이션-설정관리\" style=\"position:relative;\"><a href=\"#k8s%EC%97%90%EC%84%9C%EC%9D%98-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EC%84%A4%EC%A0%95%EA%B4%80%EB%A6%AC\" aria-label=\"k8s에서의 애플리케이션 설정관리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>k8s에서의 애플리케이션 설정관리</h3>\n<p>애플리케이션의 핵심적인 요구사항 = 외부 환경에서 설정값을 주입받는 것.<br>\n우선순위에 따라 파일과 환경변수를 필요로 하는것이 이상적이다.</p>\n<p>핵심 사항</p>\n<ol>\n<li>애플리케이션의 중단 없이 설정 변경에 대응이 필요한가?</li>\n<li>민감 정보를 어떻게 관리할 것인가?</li>\n</ol>\n<p>무중단 업데이트가 중요하다면, 환경 변수사용은 힘들며, 볼륨 마운트를 이용하여 설정 파일을 수정하는 방식이 필요하다.<br>\n민감 정보의 경우, YAML 탬플릿 파일로 컨피그 맵과 비밀값 정의가 생성되는 자동화 배치를 활용. ex.) Azure KeyVault 등.</p>\n<h3 id=\"\" style=\"position:relative;\"><a href=\"#\" aria-label=\" permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h2 id=\"실습\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EC%8A%B5\" aria-label=\"실습 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실습</h2>\n<h3 id=\"주요-요점들\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9A%94-%EC%9A%94%EC%A0%90%EB%93%A4\" aria-label=\"주요 요점들 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>주요 요점들</h3>\n<ul>\n<li>비밀값은 decribe를 써도 키와 데이터 길이만 나온다.</li>\n<li>비밀값을 바로 읽으려고 하면 base64로 난독화되어 있다.</li>\n</ul>\n<h3 id=\"매니페스트-파일\" style=\"position:relative;\"><a href=\"#%EB%A7%A4%EB%8B%88%ED%8E%98%EC%8A%A4%ED%8A%B8-%ED%8C%8C%EC%9D%BC\" aria-label=\"매니페스트 파일 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>매니페스트 파일</h3>\n<p>sleep-with-secret.yaml</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\r\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\r\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> sleep\r\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> sleep\r\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\r\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> sleep\r\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\r\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> sleep\r\n          <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> kiamol/ch03<span class=\"token punctuation\">-</span>sleep\r\n          <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> KIAMOL_SECRET\r\n            <span class=\"token key atrule\">valueFrom</span><span class=\"token punctuation\">:</span>\r\n              <span class=\"token key atrule\">secretKeyRef</span><span class=\"token punctuation\">:</span>              \r\n                <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> sleep<span class=\"token punctuation\">-</span>secret<span class=\"token punctuation\">-</span>literal\r\n                <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> secret</code></pre></div>\n<p>todo-db-test.yaml</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\r\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\r\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> todo<span class=\"token punctuation\">-</span>db\r\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5432</span>\r\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5432</span>\r\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> todo<span class=\"token punctuation\">-</span>db\r\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> ClusterIP\r\n<span class=\"token punctuation\">---</span>\r\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\r\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\r\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> todo<span class=\"token punctuation\">-</span>db\r\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> todo<span class=\"token punctuation\">-</span>db\r\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\r\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> todo<span class=\"token punctuation\">-</span>db\r\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\r\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> db\r\n          <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> postgres<span class=\"token punctuation\">:</span>11.6<span class=\"token punctuation\">-</span>alpine\r\n          <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> POSTGRES_PASSWORD_FILE\r\n            <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> /secrets/postgres_password\r\n          <span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span>\r\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> secret\r\n              <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/secrets\"</span>\r\n      <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\r\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> secret\r\n          <span class=\"token key atrule\">secret</span><span class=\"token punctuation\">:</span>\r\n            <span class=\"token key atrule\">secretName</span><span class=\"token punctuation\">:</span> todo<span class=\"token punctuation\">-</span>db<span class=\"token punctuation\">-</span>secret<span class=\"token punctuation\">-</span>test\r\n            <span class=\"token key atrule\">defaultMode</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0400</span>\r\n            <span class=\"token key atrule\">items</span><span class=\"token punctuation\">:</span>\r\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> POSTGRES_PASSWORD\r\n              <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> postgres_password</code></pre></div>\n<h3 id=\"-1\" style=\"position:relative;\"><a href=\"#-1\" aria-label=\" 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 평문 리터럴로 비밀값 생성</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl create secret generic <span class=\"token function\">sleep</span><span class=\"token operator\">-</span>secret-literal <span class=\"token operator\">--</span><span class=\"token keyword\">from</span><span class=\"token operator\">-</span>literal=secret=shh<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\r\nsecret/<span class=\"token function\">sleep</span><span class=\"token operator\">-</span>secret-literal created\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 비밀값의 상세 정보 확인</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl describe secret <span class=\"token function\">sleep</span><span class=\"token operator\">-</span>secret-literal\r\nName:         <span class=\"token function\">sleep</span><span class=\"token operator\">-</span>secret-literal\r\nNamespace:    default\r\nLabels:       &lt;none>\r\nAnnotations:  &lt;none>\r\n\r\n<span class=\"token function\">Type</span>:  Opaque\r\n\r\n<span class=\"token keyword\">Data</span>\r\n====\r\nsecret:  6 bytes\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 비밀값의 평문 확인(base64 인코딩됨)</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl get secret <span class=\"token function\">sleep</span><span class=\"token operator\">-</span>secret-literal <span class=\"token operator\">-</span>o jsonpath=<span class=\"token string\">'{.data.secret}'</span>\r\nc2hoLi4u\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 비밀값의 평문 확인</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl get secret <span class=\"token function\">sleep</span><span class=\"token operator\">-</span>secret-literal <span class=\"token operator\">-</span>o jsonpath=<span class=\"token string\">'{.data.secret}'</span> <span class=\"token punctuation\">|</span> base64 <span class=\"token operator\">-</span>d\r\nshh<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 비밀값 생성</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl apply <span class=\"token operator\">-</span>f todo-list/secrets/todo-db-secret-test<span class=\"token punctuation\">.</span>yaml\r\nsecret/todo-db-secret-test created\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> \r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 데이터 값이 인코딩되었는지 확인</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl get secret todo-db-secret-test <span class=\"token operator\">-</span>o jsonpath=<span class=\"token string\">'{.data.POSTGRES_PASSWORD}'</span>\r\na2lhbW9sLTIqMio=\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 비밀값 객체의 애너테이션에 저장된 내용 확인</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl get secret todo-db-secret-test <span class=\"token operator\">-</span>o jsonpath=<span class=\"token string\">'{.metadata.annotations}'</span>\r\n<span class=\"token punctuation\">{</span><span class=\"token string\">\"kubectl.kubernetes.io/last-applied-configuration\"</span>:<span class=\"token string\">\"{\\\"</span>apiVersion\\<span class=\"token string\">\":\\\"</span>v1\\<span class=\"token string\">\",\\\"</span>kind\\<span class=\"token string\">\":\\\"</span>Secret\\<span class=\"token string\">\",\\\"</span>metadata\\<span class=\"token string\">\":{\\\"</span>annotations\\<span class=\"token string\">\":{},\\\"</span>name\\<span class=\"token string\">\":\\\"</span>todo-db-secret-test\\<span class=\"token string\">\",\\\"</span>namespace\\<span class=\"token string\">\":\\\"</span>default\\<span class=\"token string\">\"},\\\"</span>stringData\\<span class=\"token string\">\":{\\\"</span>POSTGRES_PASSWORD\\<span class=\"token string\">\":\\\"</span>kiamol-2*2*\\<span class=\"token string\">\"},\\\"</span><span class=\"token function\">type</span>\\<span class=\"token string\">\":\\\"</span>Opaque\\<span class=\"token string\">\"}\\n\"</span><span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice> cd ch04\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 예제 4-13의 정의 배치        </span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl apply <span class=\"token operator\">-</span>f todo-list/todo-db-test<span class=\"token punctuation\">.</span>yaml\r\nservice/todo-db created\r\ndeployment<span class=\"token punctuation\">.</span>apps/todo-db created\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> \r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 데이터베이스 파드의 로그 확인(조금 기다려야 한다)</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl logs <span class=\"token operator\">-</span>l app=todo-db <span class=\"token operator\">--</span>tail 1\r\n2024-01-17 12:30:06<span class=\"token punctuation\">.</span>231 UTC <span class=\"token punctuation\">[</span>1<span class=\"token punctuation\">]</span> LOG:  database system is ready to accept connections\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 패스워드 설정 파일의 권한 확인</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl exec deploy/todo-db <span class=\"token operator\">--</span> sh <span class=\"token operator\">-</span>c <span class=\"token string\">'ls -l $(readlink -f /secrets/postgres_password)'</span>\r\n<span class=\"token operator\">-</span>r-<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>    1 root     root            11 Jan 17 12:29 <span class=\"token operator\">/</span>secrets/<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>2024_01_17_12_29_57<span class=\"token punctuation\">.</span>20743244/postgres_password</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice> cd ch04\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 예제 4-13의 정의 배치</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl apply <span class=\"token operator\">-</span>f todo-list/todo-db-test<span class=\"token punctuation\">.</span>yaml\r\nservice/todo-db created\r\ndeployment<span class=\"token punctuation\">.</span>apps/todo-db created\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 데이터베이스 파드의 로그 확인(조금 기다려야 한다)</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl logs <span class=\"token operator\">-</span>l app=todo-db <span class=\"token operator\">--</span>tail 1\r\n2024-01-17 12:30:06<span class=\"token punctuation\">.</span>231 UTC <span class=\"token punctuation\">[</span>1<span class=\"token punctuation\">]</span> LOG:  database system is ready to accept connections\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 패스워드 설정 파일의 권한 확인</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl exec deploy/todo-db <span class=\"token operator\">--</span> sh <span class=\"token operator\">-</span>c <span class=\"token string\">'ls -l $(readlink -f /secrets/postgres_password)'</span>\r\n<span class=\"token operator\">-</span>r-<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>    1 root     root            11 Jan 17 12:29 <span class=\"token operator\">/</span>secrets/<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>2024_01_17_12_29_57<span class=\"token punctuation\">.</span>20743244/postgres_password\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># PostgreSQL 데이터베이스를 사용하도록 설정된 컨피그맵을 배치한다</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl apply <span class=\"token operator\">-</span>f todo-list/configMaps/todo-web-config-test<span class=\"token punctuation\">.</span>yaml\r\nconfigmap/todo-web-config-test created\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># PostgreSQL 데이터베이스에 접속할 인증 정보가 들어 있는 비밀값을 배치한다</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl apply <span class=\"token operator\">-</span>f todo-list/secrets/todo-web-secret-test<span class=\"token punctuation\">.</span>yaml\r\nsecret/todo-web-secret-test created\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 디플로이먼트 속 파드는 위의 컨피그맵과 비밀값을 사용하도록 설정됐다</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl apply <span class=\"token operator\">-</span>f todo-list/todo-web-test<span class=\"token punctuation\">.</span>yaml\r\nservice/todo-web-test created\r\ndeployment<span class=\"token punctuation\">.</span>apps/todo-web-test created\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> <span class=\"token comment\"># 애플리케이션 컨테이너 속 데이터베이스 인증 정보 파일을 확인한다</span>\r\n<span class=\"token function\">PS</span> C:\\Users\\hdyang\\Desktop\\Project\\k8s-practice\\ch04> kubectl exec deploy/todo-web-test <span class=\"token operator\">--</span> <span class=\"token function\">cat</span> <span class=\"token operator\">/</span>app/secrets/secrets<span class=\"token punctuation\">.</span>json\r\n<span class=\"token punctuation\">{</span>\r\n  <span class=\"token string\">\"ConnectionStrings\"</span>: <span class=\"token punctuation\">{</span>\r\n    <span class=\"token string\">\"ToDoDb\"</span>: <span class=\"token string\">\"Server=todo-db;Database=todo;User Id=postgres;Password=kiamol-2*2*;\"</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"source\" style=\"position:relative;\"><a href=\"#source\" aria-label=\"source permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Source</h2>\n<ul>\n<li>『쿠버네티스 교과서』- 엘튼 스톤맨, 길벗<br>\n<a href=\"https://github.com/gilbutITbook/kiamol\" target=\"_blank\" rel=\"nofollow\">https://github.com/gilbutITbook/kiamol</a></li>\n</ul>","id":"0afbe51b-20c2-537a-851c-730b7dff3128","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EA%B0%9C%EB%85%90-%EC%9A%94%EC%95%BD\">개념 요약</a></p>\n<ul>\n<li><a href=\"#k8s-%EB%B9%84%EB%B0%80%EA%B0%92\">k8s 비밀값</a></li>\n<li><a href=\"#%EB%B9%84%EB%B0%80%EA%B0%92-%EC%A3%BC%EC%9D%98%EC%A0%90\">비밀값 주의점</a></li>\n<li><a href=\"#k8s%EC%97%90%EC%84%9C%EC%9D%98-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EC%84%A4%EC%A0%95%EA%B4%80%EB%A6%AC\">k8s에서의 애플리케이션 설정관리</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%8B%A4%EC%8A%B5\">실습</a></p>\n<ul>\n<li><a href=\"#%EC%A3%BC%EC%9A%94-%EC%9A%94%EC%A0%90%EB%93%A4\">주요 요점들</a></li>\n<li><a href=\"#%EB%A7%A4%EB%8B%88%ED%8E%98%EC%8A%A4%ED%8A%B8-%ED%8C%8C%EC%9D%BC\">매니페스트 파일</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#source\">Source</a></p>\n</li>\n</ul>","frontmatter":{"title":"『쿠버네티스 교과서』실습 4장 part 2","summary":"엘튼 스톤맨의 『쿠버네티스 교과서』를 바탕으로 k8s 실습을 진행합니다.","date":"2024.01.22.","categories":["K8s","Docker","DevOps"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAcCBQj/xAAWAQEBAQAAAAAAAAAAAAAAAAAJAgX/2gAMAwEAAhADEAAAAUQ68/wQe68DIU3/xAAbEAABBAMAAAAAAAAAAAAAAAACAAMEBQEGEP/aAAgBAQABBQKG209L3Oloq2GsozMuf//EACERAAICAQIHAAAAAAAAAAAAAAECAwQSABEFBxM0QXOy/9oACAEDAQE/AeQ9V7DcFaOxNWNW1FO/SZgLEWKg1pV3CNG3nIMQC2OzYstDsqvoi+Rr/8QAHhEAAQMFAQEAAAAAAAAAAAAAAwECEgAEESFhBTL/2gAIAQIBAT8B9S3IS4AZpyDYGUxNxA0sfes64qdkmqWv/8QAIxAAAgEDBAEFAAAAAAAAAAAAAQIRAxIiBBAhMQAFEzJBUf/aAAgBAQAGPwLT067W0nqAOTcOPzHLkwMcj0uUeaOr6ZUT3nsVlV5vWADwoCFvkzNIbDhFU75OzRMXMWie+ye/vb//xAAaEAEBAAMBAQAAAAAAAAAAAAABEQAhMUFx/9oACAEBAAE/ITqO+CxlF14nd15QbYYQsJzV+IXNc9YyfLHAxqUGnYXhjn//2gAMAwEAAgADAAAAEFv/AP/EABYRAQEBAAAAAAAAAAAAAAAAAAEQIf/aAAgBAwEBPxBFpaYiyxm1CBz+v//EABoRAQEAAgMAAAAAAAAAAAAAAAERADFBcbH/2gAIAQIBAT8Qs1GoBEKWhnNcjZ7fc//EABoQAQACAwEAAAAAAAAAAAAAAAEAESExwXH/2gAIAQEAAT8QuLX5IofsSCd43ADOLxb1Xx453POs5cjI3Qk8gWXBUWtsG551n//Z"},"images":{"fallback":{"src":"/static/582542484766a1b4ac3c5f037914dd69/bc134/k8s.jpg","srcSet":"/static/582542484766a1b4ac3c5f037914dd69/2278c/k8s.jpg 320w,\n/static/582542484766a1b4ac3c5f037914dd69/0f1c0/k8s.jpg 640w,\n/static/582542484766a1b4ac3c5f037914dd69/bc134/k8s.jpg 1280w","sizes":"(min-width: 1280px) 1280px, 100vw"},"sources":[{"srcSet":"/static/582542484766a1b4ac3c5f037914dd69/378b7/k8s.webp 320w,\n/static/582542484766a1b4ac3c5f037914dd69/3c3fb/k8s.webp 640w,\n/static/582542484766a1b4ac3c5f037914dd69/c2dd8/k8s.webp 1280w","type":"image/webp","sizes":"(min-width: 1280px) 1280px, 100vw"}]},"width":1280,"height":720}},"publicURL":"/static/582542484766a1b4ac3c5f037914dd69/k8s.jpg"}}}}]}},"pageContext":{"slug":"/k8s_prac_4_2/"}},"staticQueryHashes":[]}