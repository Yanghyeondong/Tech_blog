{"componentChunkName":"component---src-templates-post-template-tsx","path":"/gatsby-with-disqus/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2>0. 왜 이런 글을 썼나요?</h2>\n<p>Gatsby 블로그를 만들면서 겪게 된 어려움 중 하나를 공유하기 위해서입니다.<br>\n다른 블로그에도 Gatsby + Disqus 소개 글이 있긴 하지만,\r\n조금 더 구체적인 코드와 사용법을 담아내기 위해 노력했습니다. 주의할 점은 Gatsby 와 graphql 에 맞추어서 작성된 코드이기 때문에 다른 환경에서는 작동하지 않을 수도 있습니다.</p>\n<h2>1. 왜 Disqus 인가요?</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7f1b3a0e56659a81291d50ee4f6a2655/64756/disqus.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGklEQVQY0x2QS0sCcRTF53v0xqwWoQtpEWm1KImioEXto3V9AncFQRFUtHF8VKPmDFoabhIyJRJjNFtIUyQUTg+JEql2bX7xD+7icM+553CuZA3gjotp9eIIY1ewKcyn6N+nXWYuxVCUNhmXijWIM4rFz1SCsRhdPqRhjWoTvc5Kgc0SO2UyJoU3ppNsXXPxwlmNxTRZE6dK+omNIrVvobT4kdxxQYzHxH34ju2yIPQ6njyVD5GQfyVkkDMZ1Si9s5wl90yiiu0AyaXy0BRbz6Vw3b1hTefxi/Uiq1cYDX5+Wcqg3lP5JGywcMq5yW2DgQhSd0BYjmi0eEVhuyJKTh7T6aNDZuKIwUN6g/TtMXtCzz+YSeIIiY/8AVMv2ZuROZ39AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7f1b3a0e56659a81291d50ee4f6a2655/a59e9/disqus.webp 192w,\n/static/7f1b3a0e56659a81291d50ee4f6a2655/0ca9f/disqus.webp 384w,\n/static/7f1b3a0e56659a81291d50ee4f6a2655/dc9b9/disqus.webp 768w,\n/static/7f1b3a0e56659a81291d50ee4f6a2655/e2c2f/disqus.webp 1152w,\n/static/7f1b3a0e56659a81291d50ee4f6a2655/cbd37/disqus.webp 1200w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7f1b3a0e56659a81291d50ee4f6a2655/3b721/disqus.png 192w,\n/static/7f1b3a0e56659a81291d50ee4f6a2655/66595/disqus.png 384w,\n/static/7f1b3a0e56659a81291d50ee4f6a2655/fe486/disqus.png 768w,\n/static/7f1b3a0e56659a81291d50ee4f6a2655/d2d74/disqus.png 1152w,\n/static/7f1b3a0e56659a81291d50ee4f6a2655/64756/disqus.png 1200w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7f1b3a0e56659a81291d50ee4f6a2655/fe486/disqus.png\"\n            alt=\"1\"\n            title=\"1\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\r\n<br>\n이미 Gatsby로 블로그를 만든 여러분은 잘 알고 계실 것입니다.\r\nGatsby는 정적 사이트 생성 프레임워크기 때문에 백엔드가 구현되어 있지 않습니다.\r\n따라서 댓글과 같은 기능은 직접 구현하기 힘든데, 이 문제를 해결해 주는 것이 바로\r\n<strong>Disqus, LiveRe, Utterances</strong> 등의 위젯 라이브러리입니다.\r\n이중 필자가 Disqus를 고른 이유는 다음과 같습니다.</p>\n<h3>1) 대중성과 접근성</h3>\n<p>LiveRe의 경우 국내 사이트 사용자, Utterances의 경우 깃허브 사용자에게 치중되어 있습니다.\r\nDisqus는 세계적으로 이 둘보다 훨씬 많은 사용자 수를 가지고 있어 대중성이 좋다고 판단했습니다. 또한, 구글 트위터 페이스북등 다양한 계정의 접근성도 좋아 보입니다.</p>\n<h3>2) 트래픽이 낮을때는 광고가 붙지 않는다</h3>\n<p>사실 광고가 붙는 것은 Utterances에 비해 Disqus가 가진 단점이라 할 수 있습니다.\r\n다만, 이는 트래픽이 높을 때만 생기기 때문에 일반적인 테크 블로그에서는 적정하다고 판단했습니다.\r\n물론 나중에 유명해져서 광고가 너무 많이 달린다면 기쁜 마음으로 다른 라이브러리로 넘어가겠죠?</p>\n<h2>2. 어떻게 적용하나요?</h2>\n<h3>1) Disqus 가입</h3>\n<p>해당 부분은 일반적인 사이트 가입과 동일하기 때문에 따로 안내하지는 않겠습니다.</p>\n<h3>2) 새 페이지 생성</h3>\n<p>로그인 후 홈페이지에서 Get Started! 를 누르면 새 페이지 제작이 가능합니다.<br>\n본인이 작성한 website name은 기억해 주시기 바랍니다.</p>\n<p><img src=\"/01f9b8bcfcc0431dd5c2f0f0be9f6477/c1.jpg\" alt=\"2\"></p>\n<h3>3) 플러그인 설치</h3>\n<p>터미널에 본인이 사용하는 npm이나 yarn에 따라 다음 명령어를 쳐주세요.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">npm install gatsby<span class=\"token operator\">-</span>plugin<span class=\"token operator\">-</span>disqus\r\n\r\nyarn add gatsby<span class=\"token operator\">-</span>plugin<span class=\"token operator\">-</span>disqus</code></pre></div>\n<h3>4) Gatsby react 코드 작성</h3>\n<p>우선 gatsby-config.js 부터 수정해보겠습니다.<br>\ntech-blog-test 대신 본인의 website name을 적어주면 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n\r\n        ⋮\r\n\r\n    <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">resolve</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-plugin-disqus</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">options</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">shortname</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">tech-blog-test</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n\r\n        ⋮\r\n\r\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><br>\n다음은 Disqus가 들어갈 컴포넌트입니다. 밑의 코드는 “React 기반 Gatsby로 기술 블로그 개발하기” 인프런 강좌를 기반으로한 저의 블로그 코드이므로 개인마다 상이합니다.\r\n<br>\n<br>\n<strong>post_template.tsx</strong><br>\n해당 코드에서 눈여겨볼 점은 <strong>DisqusCommentBox</strong> 컴포넌트에 주게되는 <strong>href, id, title</strong> 인자들입니다.\r\ngraphql 쿼리에서 어떤 요소들에 대응되는지 확인하면 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> DisqusCommentBox <span class=\"token keyword\">from</span><span class=\"token string\">'components/Post/DisqusCommentBox'</span>\r\n\r\n⋮\r\n\r\ntype PostTemplateProps <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">allMarkdownRemark</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">edges</span><span class=\"token operator\">:</span> PostPageItemType<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token literal-property property\">location</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">href</span><span class=\"token operator\">:</span> string\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token literal-property property\">PostTemplate</span><span class=\"token operator\">:</span> FunctionComponent<span class=\"token operator\">&lt;</span>PostTemplateProps<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n\r\n  ⋮\r\n\r\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token operator\">&lt;</span>Template title<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>title<span class=\"token punctuation\">}</span> description<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>summary<span class=\"token punctuation\">}</span> url<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>href<span class=\"token punctuation\">}</span> image<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>publicURL<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span>PostHead\r\n          title<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>title<span class=\"token punctuation\">}</span>\r\n          date<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>date<span class=\"token punctuation\">}</span>\r\n          categories<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>categories<span class=\"token punctuation\">}</span>\r\n          thumbnail<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>gatsbyImageData<span class=\"token punctuation\">}</span>\r\n        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span>PostContent html<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>html<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span>DisqusCommentBox url<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>href<span class=\"token punctuation\">}</span> identifier<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>id<span class=\"token punctuation\">}</span> title<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>title<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Template<span class=\"token operator\">></span>\r\n  <span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> PostTemplate\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> queryMarkdownDataBySlug <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\r\n  query queryMarkdownDataBySlug($slug: String) {\r\n    allMarkdownRemark(filter: { fields: { slug: { eq: $slug } } }) {\r\n      edges {\r\n        node {\r\n          html\r\n          id\r\n          frontmatter {\r\n            title\r\n            summary\r\n            date(formatString: \"YYYY.MM.DD.\")\r\n            categories\r\n            thumbnail {\r\n              childImageSharp {\r\n                gatsbyImageData\r\n              }\r\n              publicURL\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p><br>\n<strong>DisqusCommentBox.tsx</strong><br>\n실제로 Disqus를 띄우게 되는 컴포넌트입니다. 위의 코드와 연계해서 설명하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> FunctionComponent <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Disqus <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'gatsby-plugin-disqus'</span>\r\n<span class=\"token keyword\">import</span> styled <span class=\"token keyword\">from</span> <span class=\"token string\">'@emotion/styled'</span>\r\n\r\ntype DisqusCommentBoxProps <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> string\r\n    <span class=\"token literal-property property\">identifier</span><span class=\"token operator\">:</span> string\r\n    <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> string\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">const</span> Wrapper <span class=\"token operator\">=</span> styled<span class=\"token punctuation\">.</span>div<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\r\n\r\n  ⋮\r\n\r\n</span><span class=\"token template-punctuation string\">`</span></span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token literal-property property\">DisqusCommentBox</span><span class=\"token operator\">:</span> FunctionComponent<span class=\"token operator\">&lt;</span>DisqusCommentBoxProps<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>\r\n    url<span class=\"token punctuation\">,</span>\r\n    identifier<span class=\"token punctuation\">,</span>\r\n    title\r\n<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\r\n<span class=\"token keyword\">const</span> config <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> url<span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">identifier</span><span class=\"token operator\">:</span> identifier<span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> title<span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token operator\">&lt;</span>Wrapper<span class=\"token operator\">></span>\r\n            <span class=\"token operator\">&lt;</span>Disqus config<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>config<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Wrapper<span class=\"token operator\">></span>\r\n    <span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> DisqusCommentBox</code></pre></div>\n<p><br>\n우선 PostTemplateProps에서 <code class=\"language-text\">location: { href }</code> 데이터로 받게 된 <strong>href</strong>의 경우 각 포스트 글의 실제주소를 나타내 주게 됩니다. ex.) <a href=\"http://localhost:8000/post_1\" target=\"_blank\" rel=\"nofollow\">http://localhost:8000/post_1</a>.\r\n이는 Disqus 태그 인수로 필요한 요소 <strong>url</strong>에 해당합니다.<br>\n<br>\n다음으로 쿼리문 중 <code class=\"language-text\">edges: { node: { id } }</code> 의 <strong>id</strong>는 Disqus 태그 인수 <strong>identifier</strong>에 해당하며, Disqus에서 각 페이지마다 독립적인 댓글 기능을 제공하는데 중요한 역할을 합니다. 때에 따라서는 <strong>slug</strong>를 사용해도 무방합니다. 중요한 것은 중복되지 않는 것입니다.<br>\n<br>\n마지막으로 쿼리문 중 <code class=\"language-text\">edges: { node: { frontmatter: { title } } }</code>의 <strong>title</strong>는 Disqus 태그 인수 <strong>title</strong>에 해당하며, 각 포스트의 제목만 넘겨주면 됩니다.<br>\n<br>\n위의 적용이 모두 끝났으면, 실제로 페이지를 바꾸어 가며 댓글이 서로 중복되지 않게 잘 달리는지 확인하면 됩니다. 댓글에 대한 추가적인 설정은 Disqus 홈페이지의 settings 메뉴에서 변경 가능합니다.</p>\n<h2>3. 요약정리</h2>\n<p>Disqus 가입 및 플러그인 설치, gatsby-config.js 수정하기.<br>\nDisqus 태그 인수는 다음과 같이 쿼리에서 받아와서 적용해 주면 사용이 가능하다.</p>\n<ul>\n<li><strong>url</strong> => <code class=\"language-text\">location: { href }</code></li>\n<li><strong>id</strong> => <code class=\"language-text\">edges: { node: { id } }</code></li>\n<li><strong>title</strong> => <code class=\"language-text\">edges: { node: { frontmatter: { title } } }</code></li>\n</ul>\n<h2>Source</h2>\n<ul>\n<li>\n<p>React 기반 Gatsby로 기술 블로그 개발하기</p>\n<p><a href=\"https://www.inflearn.com/course/gatsby-%EA%B8%B0%EC%88%A0%EB%B8%94%EB%A1%9C%EA%B7%B8\" target=\"_blank\" rel=\"nofollow\">https://www.inflearn.com/course/gatsby-%EA%B8%B0%EC%88%A0%EB%B8%94%EB%A1%9C%EA%B7%B8</a></p>\n</li>\n</ul>","id":"0edd3dc4-815e-5ab3-9b80-d816ffd310c5","frontmatter":{"title":"Gatsby 블로그에 Disqus 를 적용해 보자","summary":"Gatsby Disqus 설치, 설정 및 url, identifier, title 인수에 대해서 알아본다","date":"2022.08.14.","categories":["web","react"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhElEQVQoz2NIM55JNmKAs9JNIOQs0jSnm8xMNpieqDMtxXBGos40kATYoFS4OjA3zQhDc7rJzBSD6Xm28+bV7lvedaQlem2S3vRUwxkphjPSTWelGM6AmmswI814Jog0mglFEM3J+tOXdx99cvvt+5dfntx+Wx+6Ks145sKmA5Pzt6cZz8yzndcUsSbddNaUgh01gSuS9Kalm8zMMJ2VZjSTIdVwRo713L0rLp/Zc/fb5x93Lr6YmLutMXz1mgnHl7YfPrTu2ta5505svbVr0YV9K64cWH11w9RTi1sPwZ09K1F32rzafTsWnD+3796B1VdL3Renm8xaUL9/YdOBGWW7FjQc6EnbNK1456Lmg9NLdq2bfHJy/vY4jcnpprNAAZZqOCPdZNbU4h1L2g5V+y8H+dloRrL+9ETdaQnaU1MMQOwUAxA3WW96TcCKDPNZqUYzEFGVajQjTnNKrPrkJL1p0LCFxt+sdBNELKabzErSm5ZqhBnPprMyzGalmxCIW+SEAAAYLBOTLd9TGQAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/523966a55687de90fff1a38556452d10/f1c8e/gatsby.png","srcSet":"/static/523966a55687de90fff1a38556452d10/14dc0/gatsby.png 175w,\n/static/523966a55687de90fff1a38556452d10/2a0b0/gatsby.png 350w,\n/static/523966a55687de90fff1a38556452d10/f1c8e/gatsby.png 700w","sizes":"(min-width: 700px) 700px, 100vw"},"sources":[{"srcSet":"/static/523966a55687de90fff1a38556452d10/486e0/gatsby.webp 175w,\n/static/523966a55687de90fff1a38556452d10/6b67d/gatsby.webp 350w,\n/static/523966a55687de90fff1a38556452d10/e8085/gatsby.webp 700w","type":"image/webp","sizes":"(min-width: 700px) 700px, 100vw"}]},"width":700,"height":367}},"publicURL":"/static/523966a55687de90fff1a38556452d10/gatsby.png"}}}}]}},"pageContext":{"slug":"/gatsby-with-disqus/"}},"staticQueryHashes":[]}