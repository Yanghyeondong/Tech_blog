{"componentChunkName":"component---src-templates-post-template-tsx","path":"/os_hw_5/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p><em>í•´ë‹¹ í¬ìŠ¤íŠ¸ëŠ” í•„ìê°€ ì§ì ‘ í’€ì´í•œ ê²ƒìœ¼ë¡œ ì˜¤ë‹µì´ë‚˜ ì˜ëª»ëœ í•´ì„ì´ ìˆì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</em><br>\n<em>í˜¹ì‹œë‚˜ ì§€ì í•  ë¶€ë¶„ì´ ìˆë‹¤ë©´ í•­ìƒ í™˜ì˜ì…ë‹ˆë‹¤!</em> ğŸ˜</p>\n<h2 id=\"ë¬¸ì œ-ë°-í’€ì´\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C-%EB%B0%8F-%ED%92%80%EC%9D%B4\" aria-label=\"ë¬¸ì œ ë° í’€ì´ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë¬¸ì œ ë° í’€ì´</h2>\n<h4 id=\"1-first-build-main-racec-examine-the-code-so-you-can-see-the-hopefully-obvious-data-race-in-the-code-now-run-helgrind-by-typing-valgrind---toolhelgrind-main-race-to-see-how-it-reports-the-race-does-it-point-to-the-right-lines-of-code-what-other-information-does-it-give-to-you\" style=\"position:relative;\"><a href=\"#1-first-build-main-racec-examine-the-code-so-you-can-see-the-hopefully-obvious-data-race-in-the-code-now-run-helgrind-by-typing-valgrind---toolhelgrind-main-race-to-see-how-it-reports-the-race-does-it-point-to-the-right-lines-of-code-what-other-information-does-it-give-to-you\" aria-label=\"1 first build main racec examine the code so you can see the hopefully obvious data race in the code now run helgrind by typing valgrind   toolhelgrind main race to see how it reports the race does it point to the right lines of code what other information does it give to you permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. First build main-race.c. Examine the code so you can see the (hopefully obvious) data race in the code. Now run helgrind (by typing valgrind â€“tool=helgrind main-race) to see how it reports the race. Does it point to the right lines of code? What other information does it give to you?</h4>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"mythreads.h\"</span></span>\r\n\r\n<span class=\"token keyword\">int</span> done <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">void</span><span class=\"token operator\">*</span> <span class=\"token function\">worker</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token operator\">*</span> arg<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"this should print first\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    done <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token class-name\">pthread_t</span> p<span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">Pthread_create</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>p<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> worker<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>done <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n\t<span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"this should print last\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">hdyang@DESKTOP<span class=\"token operator\">-</span>EU17S6T<span class=\"token operator\">:</span><span class=\"token operator\">~</span><span class=\"token operator\">/</span>os_hw<span class=\"token operator\">/</span><span class=\"token number\">5</span>$ valgrind <span class=\"token operator\">--</span>tool<span class=\"token operator\">=</span>helgrind <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>main<span class=\"token operator\">-</span>race\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> Helgrind<span class=\"token punctuation\">,</span> a thread error detector\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> <span class=\"token function\">Copyright</span> <span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">)</span> <span class=\"token number\">2007</span><span class=\"token operator\">-</span><span class=\"token number\">2017</span><span class=\"token punctuation\">,</span> and GNU GPL'd<span class=\"token punctuation\">,</span> by OpenWorks LLP et al<span class=\"token punctuation\">.</span>   \r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> Using Valgrind<span class=\"token operator\">-</span><span class=\"token number\">3.18</span><span class=\"token number\">.1</span> and LibVEX<span class=\"token punctuation\">;</span> rerun with <span class=\"token operator\">-</span>h <span class=\"token keyword\">for</span> copyright info<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> Command<span class=\"token operator\">:</span> <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>main<span class=\"token operator\">-</span>race\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">-</span>Thread<span class=\"token operator\">-</span>Announcement<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> Thread #<span class=\"token number\">1</span> is the program's root thread\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">-</span>Thread<span class=\"token operator\">-</span>Announcement<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>  \r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> Thread #<span class=\"token number\">2</span> was created\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4990BA3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">76</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4991A9E</span><span class=\"token operator\">:</span> <span class=\"token function\">__clone_internal</span> <span class=\"token punctuation\">(</span>clone<span class=\"token operator\">-</span>internal<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">83</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FF758</span><span class=\"token operator\">:</span> <span class=\"token function\">create_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">295</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x490027F</span><span class=\"token operator\">:</span> pthread_create@@GLIBC_2<span class=\"token punctuation\">.</span><span class=\"token number\">34</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">828</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4853767</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109564</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_create</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">51</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109654</span><span class=\"token operator\">:</span> <span class=\"token function\">main</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>race<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">17</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>  \r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> Possible data race during read of size <span class=\"token number\">4</span> at <span class=\"token number\">0x10C040</span> by thread #<span class=\"token number\">1</span> \r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> Locks held<span class=\"token operator\">:</span> none\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x109655</span><span class=\"token operator\">:</span> <span class=\"token function\">main</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>race<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">18</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> This conflicts with a previous write of size <span class=\"token number\">4</span> by thread #<span class=\"token number\">2</span>       \r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> Locks held<span class=\"token operator\">:</span> none\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x109609</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>race<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>  Address <span class=\"token number\">0x10c040</span> is <span class=\"token number\">0</span> bytes inside data symbol <span class=\"token string\">\"balance\"</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> Possible data race during write of size <span class=\"token number\">4</span> at <span class=\"token number\">0x10C040</span> by thread #<span class=\"token number\">1</span><span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> Locks held<span class=\"token operator\">:</span> none\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x10965E</span><span class=\"token operator\">:</span> <span class=\"token function\">main</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>race<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">18</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> This conflicts with a previous write of size <span class=\"token number\">4</span> by thread #<span class=\"token number\">2</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> Locks held<span class=\"token operator\">:</span> none\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x109609</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>race<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>  Address <span class=\"token number\">0x10c040</span> is <span class=\"token number\">0</span> bytes inside data symbol <span class=\"token string\">\"balance\"</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> Use <span class=\"token operator\">--</span>history<span class=\"token operator\">-</span>level<span class=\"token operator\">=</span>approx or <span class=\"token operator\">=</span>none to gain increased speed<span class=\"token punctuation\">,</span> at\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> the cost of reduced accuracy of conflicting<span class=\"token operator\">-</span>access information\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> For lists of detected and suppressed errors<span class=\"token punctuation\">,</span> rerun with<span class=\"token operator\">:</span> <span class=\"token operator\">-</span>s\r\n<span class=\"token operator\">==</span><span class=\"token number\">127</span><span class=\"token operator\">==</span> ERROR SUMMARY<span class=\"token operator\">:</span> <span class=\"token number\">2</span> errors from <span class=\"token number\">2</span> <span class=\"token function\">contexts</span> <span class=\"token punctuation\">(</span>suppressed<span class=\"token operator\">:</span> <span class=\"token number\">0</span> from <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>helgrindë¥¼ ë³´ë©´ mainì˜ 15ë²ˆì§¸ ì¤„(í˜¹ì€ address)ì— í•´ë‹¹í•˜ëŠ” â€œbalance++;â€œì—ì„œ raceê°€ ë‚˜íƒ€ë‚œë‹¤ëŠ” ê²ƒì„ ì˜ ì•Œë ¤ì£¼ê³  ìˆë‹¤. ë˜í•œ, Thread #1ê³¼ Thread #2ê°€ ì„œë¡œ ì¶©ëŒì„ ì¼ìœ¼í‚¬ìˆ˜ ìˆë‹¤ëŠ” ì‚¬ì‹¤ê³¼ ì‚¬ì´ì¦ˆëŠ” 4, ì¶©ëŒì´ ê°€ëŠ¥í•œ ë³€ìˆ˜ê°€ â€œbalanceâ€ë¼ëŠ” ì ë„ ì•Œë ¤ì¤€ë‹¤.</p>\n<h4 id=\"2-what-happens-when-you-remove-one-of-the-offending-lines-of-code-now-add-a-lock-around-one-of-the-updates-to-the-shared-variable-and-then-around-both-what-does-helgrind-report-in-each-of-these-cases\" style=\"position:relative;\"><a href=\"#2-what-happens-when-you-remove-one-of-the-offending-lines-of-code-now-add-a-lock-around-one-of-the-updates-to-the-shared-variable-and-then-around-both-what-does-helgrind-report-in-each-of-these-cases\" aria-label=\"2 what happens when you remove one of the offending lines of code now add a lock around one of the updates to the shared variable and then around both what does helgrind report in each of these cases permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. What happens when you remove one of the offending lines of code? Now add a lock around one of the updates to the shared variable, and then around both. What does helgrind report in each of these cases?</h4>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token operator\">==</span><span class=\"token number\">139</span><span class=\"token operator\">==</span> Helgrind<span class=\"token punctuation\">,</span> a thread error detector\r\n<span class=\"token operator\">==</span><span class=\"token number\">139</span><span class=\"token operator\">==</span> <span class=\"token function\">Copyright</span> <span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">)</span> <span class=\"token number\">2007</span><span class=\"token operator\">-</span><span class=\"token number\">2017</span><span class=\"token punctuation\">,</span> and GNU GPL'd<span class=\"token punctuation\">,</span> by OpenWorks LLP et al<span class=\"token punctuation\">.</span>   \r\n<span class=\"token operator\">==</span><span class=\"token number\">139</span><span class=\"token operator\">==</span> Using Valgrind<span class=\"token operator\">-</span><span class=\"token number\">3.18</span><span class=\"token number\">.1</span> and LibVEX<span class=\"token punctuation\">;</span> rerun with <span class=\"token operator\">-</span>h <span class=\"token keyword\">for</span> copyright info\r\n<span class=\"token operator\">==</span><span class=\"token number\">139</span><span class=\"token operator\">==</span> Command<span class=\"token operator\">:</span> <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>main<span class=\"token operator\">-</span>race\r\n<span class=\"token operator\">==</span><span class=\"token number\">139</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">139</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">139</span><span class=\"token operator\">==</span> Use <span class=\"token operator\">--</span>history<span class=\"token operator\">-</span>level<span class=\"token operator\">=</span>approx or <span class=\"token operator\">=</span>none to gain increased speed<span class=\"token punctuation\">,</span> at\r\n<span class=\"token operator\">==</span><span class=\"token number\">139</span><span class=\"token operator\">==</span> the cost of reduced accuracy of conflicting<span class=\"token operator\">-</span>access information \r\n<span class=\"token operator\">==</span><span class=\"token number\">139</span><span class=\"token operator\">==</span> For lists of detected and suppressed errors<span class=\"token punctuation\">,</span> rerun with<span class=\"token operator\">:</span> <span class=\"token operator\">-</span>s    \r\n<span class=\"token operator\">==</span><span class=\"token number\">139</span><span class=\"token operator\">==</span> ERROR SUMMARY<span class=\"token operator\">:</span> <span class=\"token number\">0</span> errors from <span class=\"token number\">0</span> <span class=\"token function\">contexts</span> <span class=\"token punctuation\">(</span>suppressed<span class=\"token operator\">:</span> <span class=\"token number\">0</span> from <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>15ë²ˆì§¸ ì¤„ â€œbalance++;â€œì„ ì œê±°í•˜ë‹ˆ ì—ëŸ¬ê°€ ì‚¬ë¼ì§„ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"mythreads.h\"</span></span>\r\n\r\n<span class=\"token keyword\">int</span> balance <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token class-name\">pthread_mutex_t</span> lock<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token function\">worker</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>arg<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">Pthread_mutex_lock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    balance<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// unprotected access</span>\r\n    <span class=\"token function\">Pthread_mutex_unlock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token class-name\">pthread_t</span> p<span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">Pthread_create</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>p<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> worker<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">Pthread_mutex_lock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    balance<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// unprotected access</span>\r\n    <span class=\"token function\">Pthread_mutex_unlock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">Pthread_join</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token operator\">==</span><span class=\"token number\">151</span><span class=\"token operator\">==</span> Helgrind<span class=\"token punctuation\">,</span> a thread error detector\r\n<span class=\"token operator\">==</span><span class=\"token number\">151</span><span class=\"token operator\">==</span> <span class=\"token function\">Copyright</span> <span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">)</span> <span class=\"token number\">2007</span><span class=\"token operator\">-</span><span class=\"token number\">2017</span><span class=\"token punctuation\">,</span> and GNU GPL'd<span class=\"token punctuation\">,</span> by OpenWorks LLP et al<span class=\"token punctuation\">.</span>   \r\n<span class=\"token operator\">==</span><span class=\"token number\">151</span><span class=\"token operator\">==</span> Using Valgrind<span class=\"token operator\">-</span><span class=\"token number\">3.18</span><span class=\"token number\">.1</span> and LibVEX<span class=\"token punctuation\">;</span> rerun with <span class=\"token operator\">-</span>h <span class=\"token keyword\">for</span> copyright info\r\n<span class=\"token operator\">==</span><span class=\"token number\">151</span><span class=\"token operator\">==</span> Command<span class=\"token operator\">:</span> <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>main<span class=\"token operator\">-</span>race\r\n<span class=\"token operator\">==</span><span class=\"token number\">151</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">151</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">151</span><span class=\"token operator\">==</span> Use <span class=\"token operator\">--</span>history<span class=\"token operator\">-</span>level<span class=\"token operator\">=</span>approx or <span class=\"token operator\">=</span>none to gain increased speed<span class=\"token punctuation\">,</span> at\r\n<span class=\"token operator\">==</span><span class=\"token number\">151</span><span class=\"token operator\">==</span> the cost of reduced accuracy of conflicting<span class=\"token operator\">-</span>access information \r\n<span class=\"token operator\">==</span><span class=\"token number\">151</span><span class=\"token operator\">==</span> For lists of detected and suppressed errors<span class=\"token punctuation\">,</span> rerun with<span class=\"token operator\">:</span> <span class=\"token operator\">-</span>s    \r\n<span class=\"token operator\">==</span><span class=\"token number\">151</span><span class=\"token operator\">==</span> ERROR SUMMARY<span class=\"token operator\">:</span> <span class=\"token number\">0</span> errors from <span class=\"token number\">0</span> <span class=\"token function\">contexts</span> <span class=\"token punctuation\">(</span>suppressed<span class=\"token operator\">:</span> <span class=\"token number\">7</span> from <span class=\"token number\">7</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Pthread_mutex_lock(&#x26;lock)ì„ ê±¸ì–´ì£¼ë‹ˆ ì—ëŸ¬ê°€ ì‚¬ë¼ì§„ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>\n<h4 id=\"3-now-lets-look-at-main-deadlockc-examine-the-code-this-code-has-a-problem-known-as-deadlock-which-we-discuss-in-much-more-depth-in-a-forthcoming-chapter-can-you-see-what-problem-it-might-have\" style=\"position:relative;\"><a href=\"#3-now-lets-look-at-main-deadlockc-examine-the-code-this-code-has-a-problem-known-as-deadlock-which-we-discuss-in-much-more-depth-in-a-forthcoming-chapter-can-you-see-what-problem-it-might-have\" aria-label=\"3 now lets look at main deadlockc examine the code this code has a problem known as deadlock which we discuss in much more depth in a forthcoming chapter can you see what problem it might have permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Now letâ€™s look at main-deadlock.c. Examine the code. This code has a problem known as deadlock (which we discuss in much more depth in a forthcoming chapter). Can you see what problem it might have?</h4>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"mythreads.h\"</span></span>\r\n\r\n<span class=\"token class-name\">pthread_mutex_t</span> m1 <span class=\"token operator\">=</span> PTHREAD_MUTEX_INITIALIZER<span class=\"token punctuation\">;</span>\r\n<span class=\"token class-name\">pthread_mutex_t</span> m2 <span class=\"token operator\">=</span> PTHREAD_MUTEX_INITIALIZER<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">void</span><span class=\"token operator\">*</span> <span class=\"token function\">worker</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token operator\">*</span> arg<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span> arg <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\t<span class=\"token function\">Pthread_mutex_lock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>m1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">Pthread_mutex_lock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>m2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n\t<span class=\"token function\">Pthread_mutex_lock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>m2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">Pthread_mutex_lock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>m1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token function\">Pthread_mutex_unlock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>m1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">Pthread_mutex_unlock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>m2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token class-name\">pthread_t</span> p1<span class=\"token punctuation\">,</span> p2<span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">Pthread_create</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>p1<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> worker<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">Pthread_create</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>p2<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> worker<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">Pthread_join</span><span class=\"token punctuation\">(</span>p1<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">Pthread_join</span><span class=\"token punctuation\">(</span>p2<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ë‘ê°œì˜ thread p1, p2ê°€ ê°ê° m1ê³¼ m2ì— ëŒ€í•´ lockì„ í•œ ìƒíƒœì—ì„œ, ì„œë¡œ ë‹¤ì‹œ ìƒëŒ€ë°©ì˜ m2ì™€ m1ì„ êµì°¨í•´ì„œ lockì„ í•˜ê²Œ ë  ê°€ëŠ¥ì„±ì´ ìˆë‹¤. ì¦‰, p1ì€ m1ì„ lock í•œ ìƒíƒœì—ì„œ m2ê°€ lock ì´ í’€ë¦´ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê³  p2ëŠ” m2ë¥¼ lockí•œ ìƒíƒœì—ì„œ m1ì˜ lockì´ í’€ë¦´ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ë¯€ë¡œ ì„œë¡œ dead lock ìƒíƒœì— ë¹ ì ¸ì„œ ì˜ì›íˆ ì‹¤í–‰ë˜ì§€ ëª»í•˜ëŠ” ìƒí™©ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.</p>\n<h4 id=\"4-now-run-helgrind-on-this-code-what-does-helgrind-report\" style=\"position:relative;\"><a href=\"#4-now-run-helgrind-on-this-code-what-does-helgrind-report\" aria-label=\"4 now run helgrind on this code what does helgrind report permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Now run helgrind on this code. What does helgrind report?</h4>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\r\nhdyang@DESKTOP<span class=\"token operator\">-</span>EU17S6T<span class=\"token operator\">:</span><span class=\"token operator\">~</span><span class=\"token operator\">/</span>os_hw<span class=\"token operator\">/</span><span class=\"token number\">5</span>$ valgrind <span class=\"token operator\">--</span>tool<span class=\"token operator\">=</span>helgrind <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>main<span class=\"token operator\">-</span>deadlock\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> Helgrind<span class=\"token punctuation\">,</span> a thread error detector\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> <span class=\"token function\">Copyright</span> <span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">)</span> <span class=\"token number\">2007</span><span class=\"token operator\">-</span><span class=\"token number\">2017</span><span class=\"token punctuation\">,</span> and GNU GPL'd<span class=\"token punctuation\">,</span> by OpenWorks LLP et al<span class=\"token punctuation\">.</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> Using Valgrind<span class=\"token operator\">-</span><span class=\"token number\">3.18</span><span class=\"token number\">.1</span> and LibVEX<span class=\"token punctuation\">;</span> rerun with <span class=\"token operator\">-</span>h <span class=\"token keyword\">for</span> copyright info\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> Command<span class=\"token operator\">:</span> <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>main<span class=\"token operator\">-</span>deadlock\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">-</span>Thread<span class=\"token operator\">-</span>Announcement<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> Thread #<span class=\"token number\">3</span> was created\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4990BA3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">76</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4991A9E</span><span class=\"token operator\">:</span> <span class=\"token function\">__clone_internal</span> <span class=\"token punctuation\">(</span>clone<span class=\"token operator\">-</span>internal<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">83</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FF758</span><span class=\"token operator\">:</span> <span class=\"token function\">create_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">295</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x490027F</span><span class=\"token operator\">:</span> pthread_create@@GLIBC_2<span class=\"token punctuation\">.</span><span class=\"token number\">34</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">828</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4853767</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109564</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_create</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">51</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1096C9</span><span class=\"token operator\">:</span> <span class=\"token function\">main</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> Thread #<span class=\"token number\">3</span><span class=\"token operator\">:</span> lock order <span class=\"token string\">\"0x10C040 before 0x10C080\"</span> violated\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> <span class=\"token function\">Observed</span> <span class=\"token punctuation\">(</span>incorrect<span class=\"token punctuation\">)</span> order is<span class=\"token operator\">:</span> acquisition of lock at <span class=\"token number\">0x10C080</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109639</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>  followed by a later acquisition of lock at <span class=\"token number\">0x10C040</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109648</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> Required order was established by acquisition of lock at <span class=\"token number\">0x10C040</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109619</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>  followed by a later acquisition of lock at <span class=\"token number\">0x10C080</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109628</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>  Lock at <span class=\"token number\">0x10C040</span> was first observed\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109619</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>  Address <span class=\"token number\">0x10c040</span> is <span class=\"token number\">0</span> bytes inside data symbol <span class=\"token string\">\"m1\"</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>  Lock at <span class=\"token number\">0x10C080</span> was first observed\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109628</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>  Address <span class=\"token number\">0x10c080</span> is <span class=\"token number\">0</span> bytes inside data symbol <span class=\"token string\">\"m2\"</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> Use <span class=\"token operator\">--</span>history<span class=\"token operator\">-</span>level<span class=\"token operator\">=</span>approx or <span class=\"token operator\">=</span>none to gain increased speed<span class=\"token punctuation\">,</span> at\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> the cost of reduced accuracy of conflicting<span class=\"token operator\">-</span>access information\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> For lists of detected and suppressed errors<span class=\"token punctuation\">,</span> rerun with<span class=\"token operator\">:</span> <span class=\"token operator\">-</span>s\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> ERROR SUMMARY<span class=\"token operator\">:</span> <span class=\"token number\">1</span> errors from <span class=\"token number\">1</span> <span class=\"token function\">contexts</span> <span class=\"token punctuation\">(</span>suppressed<span class=\"token operator\">:</span> <span class=\"token number\">7</span> from <span class=\"token number\">7</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>lock orderê°€ violated ë¨ì„ ì•Œë ¤ì¤€ë‹¤. m1ê³¼ m2ì˜ addressë¥¼ ì•Œë ¤ì£¼ë©° ì„œë¡œ ìš”êµ¬í•˜ëŠ” lockì´ ê³ ì°© ìƒíƒœì— ë¹ ì§„ë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œë ¤ì¤€ë‹¤.</p>\n<h4 id=\"5-now-run-helgrind-on-main-deadlock-globalc-examine-the-code-does-it-have-the-same-problem-that-main-deadlockc-has-should-helgrind-be-reporting-the-same-error-what-does-this-tell-you-about-tools-like-helgrind\" style=\"position:relative;\"><a href=\"#5-now-run-helgrind-on-main-deadlock-globalc-examine-the-code-does-it-have-the-same-problem-that-main-deadlockc-has-should-helgrind-be-reporting-the-same-error-what-does-this-tell-you-about-tools-like-helgrind\" aria-label=\"5 now run helgrind on main deadlock globalc examine the code does it have the same problem that main deadlockc has should helgrind be reporting the same error what does this tell you about tools like helgrind permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. Now run helgrind on main-deadlock-global.c. Examine the code; does it have the same problem that main-deadlock.c has? Should helgrind be reporting the same error? What does this tell you about tools like helgrind?</h4>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> Helgrind<span class=\"token punctuation\">,</span> a thread error detector\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> <span class=\"token function\">Copyright</span> <span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">)</span> <span class=\"token number\">2007</span><span class=\"token operator\">-</span><span class=\"token number\">2017</span><span class=\"token punctuation\">,</span> and GNU GPL'd<span class=\"token punctuation\">,</span> by OpenWorks LLP et al<span class=\"token punctuation\">.</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> Using Valgrind<span class=\"token operator\">-</span><span class=\"token number\">3.18</span><span class=\"token number\">.1</span> and LibVEX<span class=\"token punctuation\">;</span> rerun with <span class=\"token operator\">-</span>h <span class=\"token keyword\">for</span> copyright info\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> Command<span class=\"token operator\">:</span> <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>main<span class=\"token operator\">-</span>deadlock\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">-</span>Thread<span class=\"token operator\">-</span>Announcement<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> Thread #<span class=\"token number\">3</span> was created\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4990BA3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">76</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4991A9E</span><span class=\"token operator\">:</span> <span class=\"token function\">__clone_internal</span> <span class=\"token punctuation\">(</span>clone<span class=\"token operator\">-</span>internal<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">83</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FF758</span><span class=\"token operator\">:</span> <span class=\"token function\">create_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">295</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x490027F</span><span class=\"token operator\">:</span> pthread_create@@GLIBC_2<span class=\"token punctuation\">.</span><span class=\"token number\">34</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">828</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4853767</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109564</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_create</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">51</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1096C9</span><span class=\"token operator\">:</span> <span class=\"token function\">main</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> Thread #<span class=\"token number\">3</span><span class=\"token operator\">:</span> lock order <span class=\"token string\">\"0x10C040 before 0x10C080\"</span> violated\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> <span class=\"token function\">Observed</span> <span class=\"token punctuation\">(</span>incorrect<span class=\"token punctuation\">)</span> order is<span class=\"token operator\">:</span> acquisition of lock at <span class=\"token number\">0x10C080</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109639</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>  followed by a later acquisition of lock at <span class=\"token number\">0x10C040</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109648</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> Required order was established by acquisition of lock at <span class=\"token number\">0x10C040</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109619</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>  followed by a later acquisition of lock at <span class=\"token number\">0x10C080</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109628</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>  Lock at <span class=\"token number\">0x10C040</span> was first observed\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109619</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>  Address <span class=\"token number\">0x10c040</span> is <span class=\"token number\">0</span> bytes inside data symbol <span class=\"token string\">\"m1\"</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>  Lock at <span class=\"token number\">0x10C080</span> was first observed\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109628</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>  Address <span class=\"token number\">0x10c080</span> is <span class=\"token number\">0</span> bytes inside data symbol <span class=\"token string\">\"m2\"</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> Use <span class=\"token operator\">--</span>history<span class=\"token operator\">-</span>level<span class=\"token operator\">=</span>approx or <span class=\"token operator\">=</span>none to gain increased speed<span class=\"token punctuation\">,</span> at\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> the cost of reduced accuracy of conflicting<span class=\"token operator\">-</span>access information\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> For lists of detected and suppressed errors<span class=\"token punctuation\">,</span> rerun with<span class=\"token operator\">:</span> <span class=\"token operator\">-</span>s\r\n<span class=\"token operator\">==</span><span class=\"token number\">159</span><span class=\"token operator\">==</span> ERROR SUMMARY<span class=\"token operator\">:</span> <span class=\"token number\">1</span> errors from <span class=\"token number\">1</span> <span class=\"token function\">contexts</span> <span class=\"token punctuation\">(</span>suppressed<span class=\"token operator\">:</span> <span class=\"token number\">7</span> from <span class=\"token number\">7</span><span class=\"token punctuation\">)</span>\r\nhdyang@DESKTOP<span class=\"token operator\">-</span>EU17S6T<span class=\"token operator\">:</span><span class=\"token operator\">~</span><span class=\"token operator\">/</span>os_hw<span class=\"token operator\">/</span><span class=\"token number\">5</span>$ valgrind <span class=\"token operator\">--</span>tool<span class=\"token operator\">=</span>helgrind <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token operator\">-</span>global \r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span> Helgrind<span class=\"token punctuation\">,</span> a thread error detector\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span> <span class=\"token function\">Copyright</span> <span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">)</span> <span class=\"token number\">2007</span><span class=\"token operator\">-</span><span class=\"token number\">2017</span><span class=\"token punctuation\">,</span> and GNU GPL'd<span class=\"token punctuation\">,</span> by OpenWorks LLP et al<span class=\"token punctuation\">.</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span> Using Valgrind<span class=\"token operator\">-</span><span class=\"token number\">3.18</span><span class=\"token number\">.1</span> and LibVEX<span class=\"token punctuation\">;</span> rerun with <span class=\"token operator\">-</span>h <span class=\"token keyword\">for</span> copyright info\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span> Command<span class=\"token operator\">:</span> <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token operator\">-</span>global\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">-</span>Thread<span class=\"token operator\">-</span>Announcement<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span> Thread #<span class=\"token number\">3</span> was created\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4990BA3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">76</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4991A9E</span><span class=\"token operator\">:</span> <span class=\"token function\">__clone_internal</span> <span class=\"token punctuation\">(</span>clone<span class=\"token operator\">-</span>internal<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">83</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FF758</span><span class=\"token operator\">:</span> <span class=\"token function\">create_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">295</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x490027F</span><span class=\"token operator\">:</span> pthread_create@@GLIBC_2<span class=\"token punctuation\">.</span><span class=\"token number\">34</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">828</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4853767</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109564</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_create</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">51</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1096E7</span><span class=\"token operator\">:</span> <span class=\"token function\">main</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token operator\">-</span>global<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">27</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span> Thread #<span class=\"token number\">3</span><span class=\"token operator\">:</span> lock order <span class=\"token string\">\"0x10C080 before 0x10C0C0\"</span> violated\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span> <span class=\"token function\">Observed</span> <span class=\"token punctuation\">(</span>incorrect<span class=\"token punctuation\">)</span> order is<span class=\"token operator\">:</span> acquisition of lock at <span class=\"token number\">0x10C0C0</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109648</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token operator\">-</span>global<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>  followed by a later acquisition of lock at <span class=\"token number\">0x10C080</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109657</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token operator\">-</span>global<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span> Required order was established by acquisition of lock at <span class=\"token number\">0x10C080</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109628</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token operator\">-</span>global<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>  followed by a later acquisition of lock at <span class=\"token number\">0x10C0C0</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109637</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token operator\">-</span>global<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>  Lock at <span class=\"token number\">0x10C080</span> was first observed\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109628</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token operator\">-</span>global<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>  Address <span class=\"token number\">0x10c080</span> is <span class=\"token number\">0</span> bytes inside data symbol <span class=\"token string\">\"m1\"</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>  Lock at <span class=\"token number\">0x10C0C0</span> was first observed\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4850CCF</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x1093A6</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_mutex_lock</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109637</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>deadlock<span class=\"token operator\">-</span>global<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>  Address <span class=\"token number\">0x10c0c0</span> is <span class=\"token number\">0</span> bytes inside data symbol <span class=\"token string\">\"m2\"</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span> Use <span class=\"token operator\">--</span>history<span class=\"token operator\">-</span>level<span class=\"token operator\">=</span>approx or <span class=\"token operator\">=</span>none to gain increased speed<span class=\"token punctuation\">,</span> at\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span> the cost of reduced accuracy of conflicting<span class=\"token operator\">-</span>access information\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span> For lists of detected and suppressed errors<span class=\"token punctuation\">,</span> rerun with<span class=\"token operator\">:</span> <span class=\"token operator\">-</span>s\r\n<span class=\"token operator\">==</span><span class=\"token number\">163</span><span class=\"token operator\">==</span> ERROR SUMMARY<span class=\"token operator\">:</span> <span class=\"token number\">1</span> errors from <span class=\"token number\">1</span> <span class=\"token function\">contexts</span> <span class=\"token punctuation\">(</span>suppressed<span class=\"token operator\">:</span> <span class=\"token number\">7</span> from <span class=\"token number\">7</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>main-deadlock-global.cì˜ ê²½ìš°, ê¸€ë¡œë²Œ lockì„ í†µí•´ ì´ì „ì˜ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤. ë‹¤ë§Œ, helgrind ìƒì—ì„œëŠ” ì¡°ê¸ˆ ì°¨ì´ê°€ ìˆê¸´ í•˜ì§€ë§Œ ì—¬ì „íˆ ì—ëŸ¬ë¬¸êµ¬ê°€ ë°œìƒí•œë‹¤. ì´ëŸ¬í•œ ì ì€ helgrindë„ í•´ë‹¹ ì½”ë“œì˜ ì—ëŸ¬ë¥¼ ì˜ëª» íŒë‹¨í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ì•Œë ¤ì¤€ë‹¤.</p>\n<h4 id=\"6-lets-next-look-at-main-signalc-this-code-uses-a-variable-done-to-signal-that-the-child-is-done-and-that-the-parent-can-now-continue-why-is-this-code-inefficient-what-does-the-parent-end-up-spending-its-time-doing-particularly-if-the-child-thread-takes-a-long-time-to-complete\" style=\"position:relative;\"><a href=\"#6-lets-next-look-at-main-signalc-this-code-uses-a-variable-done-to-signal-that-the-child-is-done-and-that-the-parent-can-now-continue-why-is-this-code-inefficient-what-does-the-parent-end-up-spending-its-time-doing-particularly-if-the-child-thread-takes-a-long-time-to-complete\" aria-label=\"6 lets next look at main signalc this code uses a variable done to signal that the child is done and that the parent can now continue why is this code inefficient what does the parent end up spending its time doing particularly if the child thread takes a long time to complete permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. Letâ€™s next look at main-signal.c. This code uses a variable (done) to signal that the child is done and that the parent can now continue. Why is this code inefficient? (what does the parent end up spending its time doing, particularly if the child thread takes a long time to complete?)</h4>\n<p>í•´ë‹¹ ì½”ë“œì˜ ê²½ìš° child threadê°€ ì˜¤ë«ë™ì•ˆ ì‹¤í–‰ëœë‹¤ë©´, doneì´ 1ì´ ë˜ê¸° ì „ê¹Œì§€ parentëŠ” ì•„ë¬´ ì˜ë¯¸ ì—†ëŠ” ë°˜ë³µë¬¸ë§Œ ê³„ì† ëŒë©°(spin) ìì›ì„ ë‚­ë¹„í•˜ê²Œ ëœë‹¤.</p>\n<h4 id=\"7-now-run-helgrind-on-this-program-what-does-it-report-is-the-code-correct\" style=\"position:relative;\"><a href=\"#7-now-run-helgrind-on-this-program-what-does-it-report-is-the-code-correct\" aria-label=\"7 now run helgrind on this program what does it report is the code correct permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>7. Now run helgrind on this program. What does it report? Is the code correct?</h4>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">hdyang@DESKTOP<span class=\"token operator\">-</span>EU17S6T<span class=\"token operator\">:</span><span class=\"token operator\">~</span><span class=\"token operator\">/</span>os_hw<span class=\"token operator\">/</span><span class=\"token number\">5</span>$ valgrind <span class=\"token operator\">--</span>tool<span class=\"token operator\">=</span>helgrind <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>main<span class=\"token operator\">-</span>signal\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> Helgrind<span class=\"token punctuation\">,</span> a thread error detector\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> <span class=\"token function\">Copyright</span> <span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">)</span> <span class=\"token number\">2007</span><span class=\"token operator\">-</span><span class=\"token number\">2017</span><span class=\"token punctuation\">,</span> and GNU GPL'd<span class=\"token punctuation\">,</span> by OpenWorks LLP et al<span class=\"token punctuation\">.</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> Using Valgrind<span class=\"token operator\">-</span><span class=\"token number\">3.18</span><span class=\"token number\">.1</span> and LibVEX<span class=\"token punctuation\">;</span> rerun with <span class=\"token operator\">-</span>h <span class=\"token keyword\">for</span> copyright info\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> Command<span class=\"token operator\">:</span> <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>main<span class=\"token operator\">-</span>signal\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>\r\nthis should print first\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">-</span>Thread<span class=\"token operator\">-</span>Announcement<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> Thread #<span class=\"token number\">2</span> was created\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4990BA3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">76</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4991A9E</span><span class=\"token operator\">:</span> <span class=\"token function\">__clone_internal</span> <span class=\"token punctuation\">(</span>clone<span class=\"token operator\">-</span>internal<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">83</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FF758</span><span class=\"token operator\">:</span> <span class=\"token function\">create_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">295</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x490027F</span><span class=\"token operator\">:</span> pthread_create@@GLIBC_2<span class=\"token punctuation\">.</span><span class=\"token number\">34</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">828</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4853767</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109584</span><span class=\"token operator\">:</span> <span class=\"token function\">Pthread_create</span> <span class=\"token punctuation\">(</span>mythreads<span class=\"token punctuation\">.</span>h<span class=\"token operator\">:</span><span class=\"token number\">51</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109682</span><span class=\"token operator\">:</span> <span class=\"token function\">main</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>signal<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">-</span>Thread<span class=\"token operator\">-</span>Announcement<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> Thread #<span class=\"token number\">1</span> is the program's root thread\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> Possible data race during write of size <span class=\"token number\">4</span> at <span class=\"token number\">0x10C014</span> by thread #<span class=\"token number\">2</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> Locks held<span class=\"token operator\">:</span> none\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x109633</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>signal<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> This conflicts with a previous read of size <span class=\"token number\">4</span> by thread #<span class=\"token number\">1</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> Locks held<span class=\"token operator\">:</span> none\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x109684</span><span class=\"token operator\">:</span> <span class=\"token function\">main</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>signal<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>  Address <span class=\"token number\">0x10c014</span> is <span class=\"token number\">0</span> bytes inside data symbol <span class=\"token string\">\"done\"</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> Possible data race during read of size <span class=\"token number\">4</span> at <span class=\"token number\">0x10C014</span> by thread #<span class=\"token number\">1</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> Locks held<span class=\"token operator\">:</span> none\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x109684</span><span class=\"token operator\">:</span> <span class=\"token function\">main</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>signal<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> This conflicts with a previous write of size <span class=\"token number\">4</span> by thread #<span class=\"token number\">2</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> Locks held<span class=\"token operator\">:</span> none\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x109633</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>signal<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>  Address <span class=\"token number\">0x10c014</span> is <span class=\"token number\">0</span> bytes inside data symbol <span class=\"token string\">\"done\"</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> Possible data race during write of size <span class=\"token number\">1</span> at <span class=\"token number\">0x52971A5</span> by thread #<span class=\"token number\">1</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> Locks held<span class=\"token operator\">:</span> none\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x4859796</span><span class=\"token operator\">:</span> <span class=\"token function\">mempcpy</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48F66E4</span><span class=\"token operator\">:</span> <span class=\"token function\">_IO_new_file_xsputn</span> <span class=\"token punctuation\">(</span>fileops<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">1235</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48F66E4</span><span class=\"token operator\">:</span> _IO_file_xsputn@@GLIBC_2<span class=\"token punctuation\">.</span><span class=\"token number\">2.5</span> <span class=\"token punctuation\">(</span>fileops<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">1196</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48EBF9B</span><span class=\"token operator\">:</span> <span class=\"token function\">puts</span> <span class=\"token punctuation\">(</span>ioputs<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x10969C</span><span class=\"token operator\">:</span> <span class=\"token function\">main</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>signal<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">18</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>  Address <span class=\"token number\">0x52971a5</span> is <span class=\"token number\">21</span> bytes inside a block of size <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">024</span> alloc'd\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    at <span class=\"token number\">0x484A919</span><span class=\"token operator\">:</span> <span class=\"token function\">malloc</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48E9C23</span><span class=\"token operator\">:</span> <span class=\"token function\">_IO_file_doallocate</span> <span class=\"token punctuation\">(</span>filedoalloc<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">101</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48F8D5F</span><span class=\"token operator\">:</span> <span class=\"token function\">_IO_doallocbuf</span> <span class=\"token punctuation\">(</span>genops<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">347</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48F7FDF</span><span class=\"token operator\">:</span> _IO_file_overflow@@GLIBC_2<span class=\"token punctuation\">.</span><span class=\"token number\">2.5</span> <span class=\"token punctuation\">(</span>fileops<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">744</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48F6754</span><span class=\"token operator\">:</span> <span class=\"token function\">_IO_new_file_xsputn</span> <span class=\"token punctuation\">(</span>fileops<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">1243</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48F6754</span><span class=\"token operator\">:</span> _IO_file_xsputn@@GLIBC_2<span class=\"token punctuation\">.</span><span class=\"token number\">2.5</span> <span class=\"token punctuation\">(</span>fileops<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">1196</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48EBF9B</span><span class=\"token operator\">:</span> <span class=\"token function\">puts</span> <span class=\"token punctuation\">(</span>ioputs<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x109632</span><span class=\"token operator\">:</span> <span class=\"token function\">worker</span> <span class=\"token punctuation\">(</span>main<span class=\"token operator\">-</span>signal<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x485396A</span><span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>in <span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>libexec<span class=\"token operator\">/</span>valgrind<span class=\"token operator\">/</span>vgpreload_helgrind<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span>linux<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x48FFB42</span><span class=\"token operator\">:</span> <span class=\"token function\">start_thread</span> <span class=\"token punctuation\">(</span>pthread_create<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">442</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>    by <span class=\"token number\">0x4990BB3</span><span class=\"token operator\">:</span> <span class=\"token function\">clone</span> <span class=\"token punctuation\">(</span>clone<span class=\"token punctuation\">.</span>S<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>  Block was alloc'd by thread #<span class=\"token number\">2</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>\r\nthis should print last\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> Use <span class=\"token operator\">--</span>history<span class=\"token operator\">-</span>level<span class=\"token operator\">=</span>approx or <span class=\"token operator\">=</span>none to gain increased speed<span class=\"token punctuation\">,</span> at\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> the cost of reduced accuracy of conflicting<span class=\"token operator\">-</span>access information\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> For lists of detected and suppressed errors<span class=\"token punctuation\">,</span> rerun with<span class=\"token operator\">:</span> <span class=\"token operator\">-</span>s\r\n<span class=\"token operator\">==</span><span class=\"token number\">167</span><span class=\"token operator\">==</span> ERROR SUMMARY<span class=\"token operator\">:</span> <span class=\"token number\">24</span> errors from <span class=\"token number\">3</span> <span class=\"token function\">contexts</span> <span class=\"token punctuation\">(</span>suppressed<span class=\"token operator\">:</span> <span class=\"token number\">40</span> from <span class=\"token number\">34</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>helgrindì—ì„œëŠ” doneì´ë¼ëŠ” ë³€ìˆ˜ì— ëŒ€í•´ 16ë²ˆì§¸ ì¤„ â€œwhile (done == 0)â€œê³¼ 9ë²ˆì§¸ ì¤„ â€œdone = 1;â€ ì—ì„œ race ìƒíƒœê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤ëŠ” ì˜¤ë¥˜ë¥¼ ë³´ì—¬ì¤€ë‹¤. ë˜í•œ, printf()ì— ëŒ€í•´ì„œë„ ìˆœì„œ ë¬¸ì œê°€ ë°œìƒí•¨ì„ ì•Œë ¤ì¤€ë‹¤. ë‹¤ë§Œ, ì‹¤ì œë¡œëŠ” spin ë“±ì— ì˜í•´ ì´ëŸ¬í•œ ë¶€ë¶„ì´ ë°œìƒí•˜ì§€ ì•Šê²Œ ëœë‹¤. ì¦‰, ì‹¤ì œ ì½”ë“œì—ì„œëŠ” ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•Šê²Œ ëœë‹¤.</p>\n<h4 id=\"8-now-look-at-a-slightly-modified-version-of-the-code-which-is-found-in-main-signal-cvc-this-version-uses-a-condition-variable-to-do-the-signaling-and-associated-lock-why-is-this-code-preferred-to-the-previous-version-is-it-correctness-or-performance-or-both\" style=\"position:relative;\"><a href=\"#8-now-look-at-a-slightly-modified-version-of-the-code-which-is-found-in-main-signal-cvc-this-version-uses-a-condition-variable-to-do-the-signaling-and-associated-lock-why-is-this-code-preferred-to-the-previous-version-is-it-correctness-or-performance-or-both\" aria-label=\"8 now look at a slightly modified version of the code which is found in main signal cvc this version uses a condition variable to do the signaling and associated lock why is this code preferred to the previous version is it correctness or performance or both permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>8. Now look at a slightly modified version of the code, which is found in main-signal-cv.c. This version uses a condition variable to do the signaling (and associated lock). Why is this code preferred to the previous version? Is it correctness, or performance, or both?</h4>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">__synchronizer_t</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token class-name\">pthread_mutex_t</span> lock<span class=\"token punctuation\">;</span>\r\n    <span class=\"token class-name\">pthread_cond_t</span> cond<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">int</span> done<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span> <span class=\"token class-name\">synchronizer_t</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token class-name\">synchronizer_t</span> s<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">signal_init</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">synchronizer_t</span> <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">Pthread_mutex_init</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>s<span class=\"token operator\">-></span>lock<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">Pthread_cond_init</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>s<span class=\"token operator\">-></span>cond<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    s<span class=\"token operator\">-></span>done <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">signal_done</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">synchronizer_t</span> <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">Pthread_mutex_lock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>s<span class=\"token operator\">-></span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    s<span class=\"token operator\">-></span>done <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">Pthread_cond_signal</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>s<span class=\"token operator\">-></span>cond<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">Pthread_mutex_unlock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>s<span class=\"token operator\">-></span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">signal_wait</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">synchronizer_t</span> <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">Pthread_mutex_lock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>s<span class=\"token operator\">-></span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>s<span class=\"token operator\">-></span>done <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n\t<span class=\"token function\">Pthread_cond_wait</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>s<span class=\"token operator\">-></span>cond<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>s<span class=\"token operator\">-></span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">Pthread_mutex_unlock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>s<span class=\"token operator\">-></span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span><span class=\"token operator\">*</span> <span class=\"token function\">worker</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token operator\">*</span> arg<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"this should print first\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">signal_done</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token class-name\">pthread_t</span> p<span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">signal_init</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">Pthread_create</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>p<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> worker<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">signal_wait</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"this should print last\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span> </code></pre></div>\n<p>ìš°ì„ , correctness ì¸¡ë©´ì—ì„œ í•´ë‹¹ ì½”ë“œëŠ” ì´ì „ë³´ë‹¤ ì¢‹ì•„ì¡Œë‹¤. signaling ê´€ë ¨ ê¸°ëŠ¥ì„ ì¶”ê°€í•¨ìœ¼ë¡œì¨ threadì˜ lockê³¼ ê´€ë ¨ëœ ì •ë³´ë“¤ì´ ì„œë¡œ ì „ë‹¬ë˜ê³ , ì´ë¥¼ í†µí•´ concurrency ê´€ë ¨ ë¬¸ì œë“¤ì„ ë¯¸ë¦¬ ì˜ˆë°©í•œë‹¤.</p>\n<p>ê·¸ë¦¬ê³ , performance ì¸¡ë©´ì—ì„œë„ í•´ë‹¹ ì½”ë“œëŠ” ì´ì „ë³´ë‹¤ ì¢‹ì•„ì¡Œë‹¤. ì˜ë¯¸ ì—†ëŠ” spinì„ ë°˜ë³µí•´ì„œ ìì›ì„ ë‚­ë¹„í•˜ì§€ ì•Šê³  pthread_cond_wait() ë“±ì„ í†µí•´ì„œ ìŠ¤ì¼€ì¤„ë§ì„ ë°”ê¿ˆìœ¼ë¡œì¨ (ex. blocked) ë”ìš± íš¨ìœ¨ì´ ì¢‹ê¸° ë•Œë¬¸ì´ë‹¤.</p>\n<h4 id=\"9-once-again-run-helgrind-on-main-signal-cv-does-it-report-any-errors\" style=\"position:relative;\"><a href=\"#9-once-again-run-helgrind-on-main-signal-cv-does-it-report-any-errors\" aria-label=\"9 once again run helgrind on main signal cv does it report any errors permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>9. Once again run helgrind on main-signal-cv. Does it report any errors?</h4>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">hdyang@DESKTOP<span class=\"token operator\">-</span>EU17S6T<span class=\"token operator\">:</span><span class=\"token operator\">~</span><span class=\"token operator\">/</span>os_hw<span class=\"token operator\">/</span><span class=\"token number\">5</span>$ valgrind <span class=\"token operator\">--</span>tool<span class=\"token operator\">=</span>helgrind <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>main<span class=\"token operator\">-</span>signal<span class=\"token operator\">-</span>cv \r\n<span class=\"token operator\">==</span><span class=\"token number\">180</span><span class=\"token operator\">==</span> Helgrind<span class=\"token punctuation\">,</span> a thread error detector\r\n<span class=\"token operator\">==</span><span class=\"token number\">180</span><span class=\"token operator\">==</span> <span class=\"token function\">Copyright</span> <span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">)</span> <span class=\"token number\">2007</span><span class=\"token operator\">-</span><span class=\"token number\">2017</span><span class=\"token punctuation\">,</span> and GNU GPL'd<span class=\"token punctuation\">,</span> by OpenWorks LLP et al<span class=\"token punctuation\">.</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">180</span><span class=\"token operator\">==</span> Using Valgrind<span class=\"token operator\">-</span><span class=\"token number\">3.18</span><span class=\"token number\">.1</span> and LibVEX<span class=\"token punctuation\">;</span> rerun with <span class=\"token operator\">-</span>h <span class=\"token keyword\">for</span> copyright info\r\n<span class=\"token operator\">==</span><span class=\"token number\">180</span><span class=\"token operator\">==</span> Command<span class=\"token operator\">:</span> <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>main<span class=\"token operator\">-</span>signal<span class=\"token operator\">-</span>cv\r\n<span class=\"token operator\">==</span><span class=\"token number\">180</span><span class=\"token operator\">==</span>\r\nthis should print first\r\nthis should print last\r\n<span class=\"token operator\">==</span><span class=\"token number\">180</span><span class=\"token operator\">==</span>\r\n<span class=\"token operator\">==</span><span class=\"token number\">180</span><span class=\"token operator\">==</span> Use <span class=\"token operator\">--</span>history<span class=\"token operator\">-</span>level<span class=\"token operator\">=</span>approx or <span class=\"token operator\">=</span>none to gain increased speed<span class=\"token punctuation\">,</span> at\r\n<span class=\"token operator\">==</span><span class=\"token number\">180</span><span class=\"token operator\">==</span> the cost of reduced accuracy of conflicting<span class=\"token operator\">-</span>access information\r\n<span class=\"token operator\">==</span><span class=\"token number\">180</span><span class=\"token operator\">==</span> For lists of detected and suppressed errors<span class=\"token punctuation\">,</span> rerun with<span class=\"token operator\">:</span> <span class=\"token operator\">-</span>s\r\n<span class=\"token operator\">==</span><span class=\"token number\">180</span><span class=\"token operator\">==</span> ERROR SUMMARY<span class=\"token operator\">:</span> <span class=\"token number\">0</span> errors from <span class=\"token number\">0</span> <span class=\"token function\">contexts</span> <span class=\"token punctuation\">(</span>suppressed<span class=\"token operator\">:</span> <span class=\"token number\">12</span> from <span class=\"token number\">12</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.</p>\n<h2 id=\"source\" style=\"position:relative;\"><a href=\"#source\" aria-label=\"source permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Source</h2>\n<ul>\n<li>ã€Operating Systems: Three Easy Piecesã€ <em>-Remzi H. Arpaci-Dusseau ì§€ìŒ</em><br>\n<a href=\"https://pages.cs.wisc.edu/~remzi/OSTEP/\" target=\"_blank\" rel=\"nofollow\">https://pages.cs.wisc.edu/~remzi/OSTEP/</a></li>\n</ul>","id":"73e8ca6a-99ca-52f3-b9c2-d10e437f662d","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EB%AC%B8%EC%A0%9C-%EB%B0%8F-%ED%92%80%EC%9D%B4\">ë¬¸ì œ ë° í’€ì´</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#1-first-build-main-racec-examine-the-code-so-you-can-see-the-hopefully-obvious-data-race-in-the-code-now-run-helgrind-by-typing-valgrind---toolhelgrind-main-race-to-see-how-it-reports-the-race-does-it-point-to-the-right-lines-of-code-what-other-information-does-it-give-to-you\">1. First build main-race.c. Examine the code so you can see the (hopefully obvious) data race in the code. Now run helgrind (by typing valgrind â€“tool=helgrind main-race) to see how it reports the race. Does it point to the right lines of code? What other information does it give to you?</a></li>\n<li><a href=\"#2-what-happens-when-you-remove-one-of-the-offending-lines-of-code-now-add-a-lock-around-one-of-the-updates-to-the-shared-variable-and-then-around-both-what-does-helgrind-report-in-each-of-these-cases\">2. What happens when you remove one of the offending lines of code? Now add a lock around one of the updates to the shared variable, and then around both. What does helgrind report in each of these cases?</a></li>\n<li><a href=\"#3-now-lets-look-at-main-deadlockc-examine-the-code-this-code-has-a-problem-known-as-deadlock-which-we-discuss-in-much-more-depth-in-a-forthcoming-chapter-can-you-see-what-problem-it-might-have\">3. Now letâ€™s look at main-deadlock.c. Examine the code. This code has a problem known as deadlock (which we discuss in much more depth in a forthcoming chapter). Can you see what problem it might have?</a></li>\n<li><a href=\"#4-now-run-helgrind-on-this-code-what-does-helgrind-report\">4. Now run helgrind on this code. What does helgrind report?</a></li>\n<li><a href=\"#5-now-run-helgrind-on-main-deadlock-globalc-examine-the-code-does-it-have-the-same-problem-that-main-deadlockc-has-should-helgrind-be-reporting-the-same-error-what-does-this-tell-you-about-tools-like-helgrind\">5. Now run helgrind on main-deadlock-global.c. Examine the code; does it have the same problem that main-deadlock.c has? Should helgrind be reporting the same error? What does this tell you about tools like helgrind?</a></li>\n<li><a href=\"#6-lets-next-look-at-main-signalc-this-code-uses-a-variable-done-to-signal-that-the-child-is-done-and-that-the-parent-can-now-continue-why-is-this-code-inefficient-what-does-the-parent-end-up-spending-its-time-doing-particularly-if-the-child-thread-takes-a-long-time-to-complete\">6. Letâ€™s next look at main-signal.c. This code uses a variable (done) to signal that the child is done and that the parent can now continue. Why is this code inefficient? (what does the parent end up spending its time doing, particularly if the child thread takes a long time to complete?)</a></li>\n<li><a href=\"#7-now-run-helgrind-on-this-program-what-does-it-report-is-the-code-correct\">7. Now run helgrind on this program. What does it report? Is the code correct?</a></li>\n<li><a href=\"#8-now-look-at-a-slightly-modified-version-of-the-code-which-is-found-in-main-signal-cvc-this-version-uses-a-condition-variable-to-do-the-signaling-and-associated-lock-why-is-this-code-preferred-to-the-previous-version-is-it-correctness-or-performance-or-both\">8. Now look at a slightly modified version of the code, which is found in main-signal-cv.c. This version uses a condition variable to do the signaling (and associated lock). Why is this code preferred to the previous version? Is it correctness, or performance, or both?</a></li>\n<li><a href=\"#9-once-again-run-helgrind-on-main-signal-cv-does-it-report-any-errors\">9. Once again run helgrind on main-signal-cv. Does it report any errors?</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#source\">Source</a></p>\n</li>\n</ul>","frontmatter":{"title":"OS: Three Easy Pieces [Remzi] <27.Debugging Race> í’€ì´","summary":"êµì¬ Operating Systems: Three Easy Pieces [Remzi] ì† Homework ë¬¸ì œ í’€ì´","date":"2023.08.30.","categories":["OS"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABESAAAREgEAwpvaAAABrklEQVQozzWSPa/qMAyG08RN4iRNvxADGwL1qiBoqaAduiAhMfADGEAV450Y2BD8+atTn/sMUeTYsvO+ZlEUOeeUUgCgtZZSGmMQ0VqrlPLex3EMAFEUAQAiAoBSii5MSqlG4ji21mZZhohJkiBilmXWWmNMFEVCCMr03mutAUBKyYQQnPMgCIQQv6ERzrmUEgAoQY4EQcAYU0pxzn87c86ttcfjcbvdFkWxXq/7vu+6bj6fV1V1Op2apun7vqqqpmkWiwVNEYYhc85xzrMsu9/v7/d7GIbb7fZ6vYZh+H6/5/P58/n8HXk+n4/H43q9MsZghGmtnXPee6VUnueHw6Esy9Vqtd/v+74vy7Jt2z8jk8lECEFyIqIQgiEi1ZPaZVnWdb3ZbOq67rpuvV4XRbHb7dq2nc1mxhgSIk1T5xwjqYMgoAt9hoQVQmithRD0pLXO89w5J6X8LQYAspROmsI5lyQJ+a+1NsZQkAy31iKiMebHKkQk6eM4FiNku9Y6DEP/H5rZWhtFUZqmy+XypzNV0pIBQBiGAOC9R0SayHtP24KI0+m0LMumaS6Xyz8ykDVBPPlfZQAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/5e3e112afb9c9c7bd4c291006dba33a4/3739d/book2.png","srcSet":"/static/5e3e112afb9c9c7bd4c291006dba33a4/da853/book2.png 141w,\n/static/5e3e112afb9c9c7bd4c291006dba33a4/9f0de/book2.png 283w,\n/static/5e3e112afb9c9c7bd4c291006dba33a4/3739d/book2.png 565w","sizes":"(min-width: 565px) 565px, 100vw"},"sources":[{"srcSet":"/static/5e3e112afb9c9c7bd4c291006dba33a4/cdf2b/book2.webp 141w,\n/static/5e3e112afb9c9c7bd4c291006dba33a4/d9fe4/book2.webp 283w,\n/static/5e3e112afb9c9c7bd4c291006dba33a4/8b8b9/book2.webp 565w","type":"image/webp","sizes":"(min-width: 565px) 565px, 100vw"}]},"width":565,"height":306}},"publicURL":"/static/5e3e112afb9c9c7bd4c291006dba33a4/book2.png"}}}}]}},"pageContext":{"slug":"/os_hw_5/"}},"staticQueryHashes":[]}