{"componentChunkName":"component---src-templates-post-template-tsx","path":"/os_hw_8/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p><em>해당 포스트는 필자가 직접 풀이한 것으로 오답이나 잘못된 해석이 있을 수도 있습니다.</em><br>\n<em>혹시나 지적할 부분이 있다면 항상 환영입니다!</em> 😏</p>\n<h2 id=\"문제-및-풀이\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C-%EB%B0%8F-%ED%92%80%EC%9D%B4\" aria-label=\"문제 및 풀이 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>문제 및 풀이</h2>\n<h4 id=\"1-stat-write-your-own-version-of-the-command-line-program-stat-which-simply-calls-the-stat-system-call-on-a-given-file-or-directory-print-out-file-size-number-of-blocks-allocated-reference-link-count-and-so-forth-what-is-the-link-count-of-a-directory-as-the-number-of-entries-in-the-directory-changes-useful-interfaces-stat-naturally\" style=\"position:relative;\"><a href=\"#1-stat-write-your-own-version-of-the-command-line-program-stat-which-simply-calls-the-stat-system-call-on-a-given-file-or-directory-print-out-file-size-number-of-blocks-allocated-reference-link-count-and-so-forth-what-is-the-link-count-of-a-directory-as-the-number-of-entries-in-the-directory-changes-useful-interfaces-stat-naturally\" aria-label=\"1 stat write your own version of the command line program stat which simply calls the stat system call on a given file or directory print out file size number of blocks allocated reference link count and so forth what is the link count of a directory as the number of entries in the directory changes useful interfaces stat naturally permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Stat: Write your own version of the command line program stat, which simply calls the stat() system call on a given file or directory. Print out file size, number of blocks allocated, reference (link) count, and so forth. What is the link count of a directory, as the number of entries in the directory changes? Useful interfaces: stat(), naturally.</h4>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span>     <span class=\"token comment\">// fprintf, perror</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/types.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/stat.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;unistd.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">struct</span> <span class=\"token class-name\">stat</span> sb<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token function\">stat</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>sb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"파일 종류:                     \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">int</span> info <span class=\"token operator\">=</span> sb<span class=\"token punctuation\">.</span>st_mode <span class=\"token operator\">&amp;</span> S_IFMT<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>info <span class=\"token operator\">==</span> S_IFDIR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"directory\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>info <span class=\"token operator\">==</span> S_IFREG<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"regular file\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>info <span class=\"token operator\">==</span> S_IFBLK<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"BLK\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>info <span class=\"token operator\">==</span> S_IFCHR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"character device\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>info <span class=\"token operator\">==</span> S_IFIFO<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FIFO\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>info <span class=\"token operator\">==</span> S_IFLNK<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"symbolic link\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"unknown\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    \r\n\r\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"File size:                     %lld bytes\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span> sb<span class=\"token punctuation\">.</span>st_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Number of blocks allocated:    %lld\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span> sb<span class=\"token punctuation\">.</span>st_blocks<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Reference (link) count:        %ld\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span> sb<span class=\"token punctuation\">.</span>st_nlink<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token number\">2019312219</span>@swji<span class=\"token operator\">:</span><span class=\"token operator\">~</span><span class=\"token operator\">/</span>hw<span class=\"token operator\">/</span><span class=\"token number\">8</span>$ <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>stat <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>\r\n파일 종류<span class=\"token operator\">:</span>                     directory\r\nFile size<span class=\"token operator\">:</span>                     <span class=\"token number\">4096</span> bytes\r\nNumber of blocks allocated<span class=\"token operator\">:</span>    <span class=\"token number\">8</span>\r\n<span class=\"token function\">Reference</span> <span class=\"token punctuation\">(</span>link<span class=\"token punctuation\">)</span> count<span class=\"token operator\">:</span>        <span class=\"token number\">2</span>\r\n<span class=\"token number\">2019312219</span>@swji<span class=\"token operator\">:</span><span class=\"token operator\">~</span><span class=\"token operator\">/</span>hw<span class=\"token operator\">/</span><span class=\"token number\">8</span>$ mkdir test\r\n<span class=\"token number\">2019312219</span>@swji<span class=\"token operator\">:</span><span class=\"token operator\">~</span><span class=\"token operator\">/</span>hw<span class=\"token operator\">/</span><span class=\"token number\">8</span>$ <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>stat <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>\r\n파일 종류<span class=\"token operator\">:</span>                     directory\r\nFile size<span class=\"token operator\">:</span>                     <span class=\"token number\">4096</span> bytes\r\nNumber of blocks allocated<span class=\"token operator\">:</span>    <span class=\"token number\">8</span>\r\n<span class=\"token function\">Reference</span> <span class=\"token punctuation\">(</span>link<span class=\"token punctuation\">)</span> count<span class=\"token operator\">:</span>        <span class=\"token number\">3</span></code></pre></div>\n<p>디렉토리내 새로운 폴더를 추가하면 다음과 같다. 잘 작동한다.</p>\n<h4 id=\"2-list-files-write-a-program-that-lists-files-in-the-given-directory-when-called-without-any-arguments-the-program-should-just-print-the-file-names-when-invoked-with-the--l-flag-the-program-should-print-out-information-about-each-file-such-as-the-owner-group-permissions-and-other-information-obtained-from-the-stat-system-call-the-program-should-take-one-additional-argument-which-is-the-directory-to-read-eg-myls--l-directory-if-no-directory-is-given-the-program-should-just-use-the-current-working-directory-useful-interfaces-stat-opendir-readdir-getcwd\" style=\"position:relative;\"><a href=\"#2-list-files-write-a-program-that-lists-files-in-the-given-directory-when-called-without-any-arguments-the-program-should-just-print-the-file-names-when-invoked-with-the--l-flag-the-program-should-print-out-information-about-each-file-such-as-the-owner-group-permissions-and-other-information-obtained-from-the-stat-system-call-the-program-should-take-one-additional-argument-which-is-the-directory-to-read-eg-myls--l-directory-if-no-directory-is-given-the-program-should-just-use-the-current-working-directory-useful-interfaces-stat-opendir-readdir-getcwd\" aria-label=\"2 list files write a program that lists files in the given directory when called without any arguments the program should just print the file names when invoked with the  l flag the program should print out information about each file such as the owner group permissions and other information obtained from the stat system call the program should take one additional argument which is the directory to read eg myls  l directory if no directory is given the program should just use the current working directory useful interfaces stat opendir readdir getcwd permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. List Files: Write a program that lists files in the given directory. When called without any arguments, the program should just print the file names. When invoked with the -l flag, the program should print out information about each file, such as the owner, group, permissions, and other information obtained from the stat() system call. The program should take one additional argument, which is the directory to read, e.g., myls -l directory. If no directory is given, the program should just use the current working directory. Useful interfaces: stat(), opendir(), readdir(), getcwd().</h4>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span>     <span class=\"token comment\">// fprintf, perror</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/types.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/stat.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;unistd.h></span>    <span class=\"token comment\">// getopt</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span>    <span class=\"token comment\">// exit, EXIT_FAILURE, EXIT_SUCCESS</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;dirent.h></span>    <span class=\"token comment\">// opendir, readdir, closedir</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdbool.h></span></span>\r\n\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> path <span class=\"token operator\">=</span> <span class=\"token string\">\".\"</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">struct</span> <span class=\"token class-name\">stat</span> sb<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">int</span> flag<span class=\"token punctuation\">;</span>\r\n    bool flag_l <span class=\"token operator\">=</span> false<span class=\"token punctuation\">;</span>\r\n    DIR <span class=\"token operator\">*</span>dp<span class=\"token punctuation\">;</span>\r\n    opterr <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n\r\n\r\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>flag <span class=\"token operator\">=</span> <span class=\"token function\">getopt</span><span class=\"token punctuation\">(</span>argc<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">,</span> <span class=\"token string\">\"l:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>flag <span class=\"token operator\">==</span> <span class=\"token char\">'l'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n            path <span class=\"token operator\">=</span> optarg<span class=\"token punctuation\">;</span>\r\n            flag_l <span class=\"token operator\">=</span> true<span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>optopt <span class=\"token operator\">==</span> <span class=\"token char\">'l'</span><span class=\"token punctuation\">)</span>\r\n                flag_l <span class=\"token operator\">=</span> true<span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">stat</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>sb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">S_ISDIR</span><span class=\"token punctuation\">(</span>sb<span class=\"token punctuation\">.</span>st_mode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        dp <span class=\"token operator\">=</span> <span class=\"token function\">opendir</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">struct</span> <span class=\"token class-name\">dirent</span> <span class=\"token operator\">*</span>d<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>flag_l<span class=\"token punctuation\">)</span> <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;size>\\t\\t&lt;owner>\\t\\t&lt;mode>\\t\\t&lt;link count>\\t&lt;name>\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">else</span> <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;name>\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>d <span class=\"token operator\">=</span> <span class=\"token function\">readdir</span><span class=\"token punctuation\">(</span>dp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>flag_l<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token keyword\">char</span> finalpath<span class=\"token punctuation\">[</span><span class=\"token number\">256</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">strncpy</span><span class=\"token punctuation\">(</span>finalpath<span class=\"token punctuation\">,</span> path<span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">strncat</span><span class=\"token punctuation\">(</span>finalpath<span class=\"token punctuation\">,</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">strncat</span><span class=\"token punctuation\">(</span>finalpath<span class=\"token punctuation\">,</span> d<span class=\"token operator\">-></span>d_name<span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>d<span class=\"token operator\">-></span>d_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">stat</span><span class=\"token punctuation\">(</span>finalpath<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>sb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%lld\\t\\t\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span> sb<span class=\"token punctuation\">.</span>st_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%ld\\t\\t\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span> sb<span class=\"token punctuation\">.</span>st_uid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%lo\\t\\t\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span> sb<span class=\"token punctuation\">.</span>st_mode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%ld\\t\\t\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span> sb<span class=\"token punctuation\">.</span>st_nlink<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> d<span class=\"token operator\">-></span>d_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span> \r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token number\">2019312219</span>@swji<span class=\"token operator\">:</span><span class=\"token operator\">~</span><span class=\"token operator\">/</span>hw<span class=\"token operator\">/</span><span class=\"token number\">8</span>$ <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>list\r\n<span class=\"token operator\">&lt;</span>name<span class=\"token operator\">></span>\r\nsearch<span class=\"token punctuation\">.</span>c\r\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\r\nr\r\nstat<span class=\"token punctuation\">.</span>c\r\nlist\r\nlist<span class=\"token punctuation\">.</span>c\r\n<span class=\"token punctuation\">.</span>\r\ntail\r\nstat\r\ntail<span class=\"token punctuation\">.</span>c\r\ntest\r\nsearch\r\n<span class=\"token number\">2019312219</span>@swji<span class=\"token operator\">:</span><span class=\"token operator\">~</span><span class=\"token operator\">/</span>hw<span class=\"token operator\">/</span><span class=\"token number\">8</span>$ <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>list <span class=\"token operator\">-</span>l\r\n<span class=\"token operator\">&lt;</span>size<span class=\"token operator\">></span>          <span class=\"token operator\">&lt;</span>owner<span class=\"token operator\">></span>         <span class=\"token operator\">&lt;</span>mode<span class=\"token operator\">></span>          <span class=\"token operator\">&lt;</span>link count<span class=\"token operator\">></span>    <span class=\"token operator\">&lt;</span>name<span class=\"token operator\">></span>\r\n<span class=\"token number\">1392</span>            <span class=\"token number\">1115</span>            <span class=\"token number\">100644</span>          <span class=\"token number\">1</span>               search<span class=\"token punctuation\">.</span>c\r\n<span class=\"token number\">4096</span>            <span class=\"token number\">1115</span>            <span class=\"token number\">40755</span>           <span class=\"token number\">9</span>               <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\r\n<span class=\"token number\">114</span>             <span class=\"token number\">1115</span>            <span class=\"token number\">100755</span>          <span class=\"token number\">1</span>               r\r\n<span class=\"token number\">989</span>             <span class=\"token number\">1115</span>            <span class=\"token number\">100644</span>          <span class=\"token number\">1</span>               stat<span class=\"token punctuation\">.</span>c\r\n<span class=\"token number\">16808</span>           <span class=\"token number\">1115</span>            <span class=\"token number\">100750</span>          <span class=\"token number\">1</span>               list\r\n<span class=\"token number\">1503</span>            <span class=\"token number\">1115</span>            <span class=\"token number\">100644</span>          <span class=\"token number\">1</span>               list<span class=\"token punctuation\">.</span>c\r\n<span class=\"token number\">4096</span>            <span class=\"token number\">1115</span>            <span class=\"token number\">40755</span>           <span class=\"token number\">3</span>               <span class=\"token punctuation\">.</span>\r\n<span class=\"token number\">12248</span>           <span class=\"token number\">1115</span>            <span class=\"token number\">100750</span>          <span class=\"token number\">1</span>               tail\r\n<span class=\"token number\">11888</span>           <span class=\"token number\">1115</span>            <span class=\"token number\">100755</span>          <span class=\"token number\">1</span>               stat\r\n<span class=\"token number\">853</span>             <span class=\"token number\">1115</span>            <span class=\"token number\">100644</span>          <span class=\"token number\">1</span>               tail<span class=\"token punctuation\">.</span>c\r\n<span class=\"token number\">4096</span>            <span class=\"token number\">1115</span>            <span class=\"token number\">40750</span>           <span class=\"token number\">2</span>               test\r\n<span class=\"token number\">17760</span>           <span class=\"token number\">1115</span>            <span class=\"token number\">100750</span>          <span class=\"token number\">1</span>               search\r\n<span class=\"token number\">2019312219</span>@swji<span class=\"token operator\">:</span><span class=\"token operator\">~</span><span class=\"token operator\">/</span>hw<span class=\"token operator\">/</span><span class=\"token number\">8</span>$ <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>list <span class=\"token operator\">-</span>l <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>test\r\n<span class=\"token operator\">&lt;</span>size<span class=\"token operator\">></span>          <span class=\"token operator\">&lt;</span>owner<span class=\"token operator\">></span>         <span class=\"token operator\">&lt;</span>mode<span class=\"token operator\">></span>          <span class=\"token operator\">&lt;</span>link count<span class=\"token operator\">></span>    <span class=\"token operator\">&lt;</span>name<span class=\"token operator\">></span>\r\n<span class=\"token number\">4096</span>            <span class=\"token number\">1115</span>            <span class=\"token number\">40755</span>           <span class=\"token number\">3</span>               <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\r\n<span class=\"token number\">4096</span>            <span class=\"token number\">1115</span>            <span class=\"token number\">40750</span>           <span class=\"token number\">2</span>               <span class=\"token punctuation\">.</span>\r\n<span class=\"token number\">12</span>              <span class=\"token number\">1115</span>            <span class=\"token number\">100644</span>          <span class=\"token number\">1</span>               test<span class=\"token punctuation\">.</span>txt\r\n</code></pre></div>\n<p>잘 출력되는 모습을 보인다</p>\n<h4 id=\"3-tail-write-a-program-that-prints-out-the-last-few-lines-of-a-file-the-program-should-be-efficient-in-that-it-seeks-to-near-the-end-of-the-file-reads-in-a-block-of-data-and-then-goes-backwards-until-it-finds-the-requested-number-of-lines-at-this-point-it-should-print-out-those-lines-from-beginning-to-the-end-of-the-file-to-invoke-the-program-one-should-type-mytail--n-file-where-n-is-the-number-of-lines-at-the-end-of-the-file-to-print-useful-interfaces-stat-lseek-open-read-close\" style=\"position:relative;\"><a href=\"#3-tail-write-a-program-that-prints-out-the-last-few-lines-of-a-file-the-program-should-be-efficient-in-that-it-seeks-to-near-the-end-of-the-file-reads-in-a-block-of-data-and-then-goes-backwards-until-it-finds-the-requested-number-of-lines-at-this-point-it-should-print-out-those-lines-from-beginning-to-the-end-of-the-file-to-invoke-the-program-one-should-type-mytail--n-file-where-n-is-the-number-of-lines-at-the-end-of-the-file-to-print-useful-interfaces-stat-lseek-open-read-close\" aria-label=\"3 tail write a program that prints out the last few lines of a file the program should be efficient in that it seeks to near the end of the file reads in a block of data and then goes backwards until it finds the requested number of lines at this point it should print out those lines from beginning to the end of the file to invoke the program one should type mytail  n file where n is the number of lines at the end of the file to print useful interfaces stat lseek open read close permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Tail: Write a program that prints out the last few lines of a file. The program should be efficient, in that it seeks to near the end of the file, reads in a block of data, and then goes backwards until it finds the requested number of lines; at this point, it should print out those lines from beginning to the end of the file. To invoke the program, one should type: mytail -n file, where n is the number of lines at the end of the file to print. Useful interfaces: stat(), lseek(), open(), read(), close().</h4>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span>     <span class=\"token comment\">// fprintf, perror</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/types.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/stat.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;unistd.h></span>    <span class=\"token comment\">// lseek, read</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span>    <span class=\"token comment\">// exit, atoi</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;fcntl.h></span>     <span class=\"token comment\">// open</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span></span>\r\n\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\r\n    <span class=\"token keyword\">struct</span> <span class=\"token class-name\">stat</span> sb<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">int</span> fd<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">int</span> offset<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">int</span> line_ptr<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> path <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\r\n\r\n    path <span class=\"token operator\">=</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">stat</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>sb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    fd <span class=\"token operator\">=</span> <span class=\"token function\">open</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> O_RDONLY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">lseek</span><span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">SEEK_END</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    line_ptr <span class=\"token operator\">=</span> <span class=\"token function\">atoi</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    line_ptr <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>line_ptr<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">char</span> buff<span class=\"token punctuation\">[</span>sb<span class=\"token punctuation\">.</span>st_size<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">read</span><span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">,</span> buff<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token char\">'\\n'</span><span class=\"token punctuation\">)</span> line_ptr<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\r\n        offset <span class=\"token operator\">=</span> <span class=\"token function\">lseek</span><span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">SEEK_CUR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>offset <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>line_ptr <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">lseek</span><span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">SEEK_CUR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> sb<span class=\"token punctuation\">.</span>st_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">read</span><span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">,</span> buff<span class=\"token punctuation\">,</span> sb<span class=\"token punctuation\">.</span>st_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\"</span><span class=\"token punctuation\">,</span> buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">close</span><span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token number\">2019312219</span>@swji<span class=\"token operator\">:</span><span class=\"token operator\">~</span><span class=\"token operator\">/</span>hw<span class=\"token operator\">/</span><span class=\"token number\">8</span>$ <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>tail <span class=\"token operator\">-</span><span class=\"token number\">2</span> test<span class=\"token operator\">/</span>test<span class=\"token punctuation\">.</span>txt\r\nhello world<span class=\"token operator\">!</span>\r\nhello world<span class=\"token operator\">!</span></code></pre></div>\n<p>잘 출력하는 모습을 보인다.</p>\n<h4 id=\"4-recursive-search-write-a-program-that-prints-out-the-names-of-each-file-and-directory-in-the-file-system-tree-starting-at-a-given-point-in-the-tree-for-example-when-run-without-arguments-the-program-should-start-with-the-current-working-directory-and-print-its-contents-as-well-as-the-contents-of-any-sub-directories-etc-until-the-entire-tree-root-at-the-cwd-is-printed-if-given-a-single-argument-of-a-directory-name-use-that-as-the-root-of-the-tree-instead-refine-your-recursive-search-with-more-fun-options-similar-to-the-powerful-find-command-line-tool-useful-interfaces-figure-it-out\" style=\"position:relative;\"><a href=\"#4-recursive-search-write-a-program-that-prints-out-the-names-of-each-file-and-directory-in-the-file-system-tree-starting-at-a-given-point-in-the-tree-for-example-when-run-without-arguments-the-program-should-start-with-the-current-working-directory-and-print-its-contents-as-well-as-the-contents-of-any-sub-directories-etc-until-the-entire-tree-root-at-the-cwd-is-printed-if-given-a-single-argument-of-a-directory-name-use-that-as-the-root-of-the-tree-instead-refine-your-recursive-search-with-more-fun-options-similar-to-the-powerful-find-command-line-tool-useful-interfaces-figure-it-out\" aria-label=\"4 recursive search write a program that prints out the names of each file and directory in the file system tree starting at a given point in the tree for example when run without arguments the program should start with the current working directory and print its contents as well as the contents of any sub directories etc until the entire tree root at the cwd is printed if given a single argument of a directory name use that as the root of the tree instead refine your recursive search with more fun options similar to the powerful find command line tool useful interfaces figure it out permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Recursive Search: Write a program that prints out the names of each file and directory in the file system tree, starting at a given point in the tree. For example, when run without arguments, the program should start with the current working directory and print its contents, as well as the contents of any sub-directories, etc., until the entire tree, root at the CWD, is printed. If given a single argument (of a directory name), use that as the root of the tree instead. Refine your recursive search with more fun options, similar to the powerful find command line tool. Useful interfaces: figure it out.</h4>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span>     <span class=\"token comment\">// fprintf, perror</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/types.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/stat.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;unistd.h></span>    <span class=\"token comment\">// getopt</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span>    <span class=\"token comment\">// exit</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span>    <span class=\"token comment\">// strncmp, strlen</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;dirent.h></span>    <span class=\"token comment\">// opendir, readdir, closedir</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;errno.h></span>     <span class=\"token comment\">// EACCES</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;limits.h></span>    <span class=\"token comment\">// INT_MAX</span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;regex.h></span>     <span class=\"token comment\">// regcomp, regexec</span></span>\r\n\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">search</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> pathname<span class=\"token punctuation\">,</span> <span class=\"token class-name\">regex_t</span> <span class=\"token operator\">*</span> preg<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    DIR <span class=\"token operator\">*</span>dir<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">struct</span> <span class=\"token class-name\">dirent</span> <span class=\"token operator\">*</span>d<span class=\"token punctuation\">;</span>\r\n    errno <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    dir <span class=\"token operator\">=</span> <span class=\"token function\">opendir</span><span class=\"token punctuation\">(</span>pathname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>d <span class=\"token operator\">=</span> <span class=\"token function\">readdir</span><span class=\"token punctuation\">(</span>dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> path<span class=\"token punctuation\">[</span><span class=\"token number\">256</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">strncpy</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> pathname<span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>pathname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">strncat</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">strncat</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> d<span class=\"token operator\">-></span>d_name<span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>d<span class=\"token operator\">-></span>d_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>d<span class=\"token operator\">-></span>d_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token char\">'.'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>d<span class=\"token operator\">-></span>d_type <span class=\"token operator\">==</span> DT_DIR<span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">search</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> preg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token function\">closedir</span><span class=\"token punctuation\">(</span>dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> pathname <span class=\"token operator\">=</span> <span class=\"token string\">\".\"</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> pt <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">struct</span> <span class=\"token class-name\">stat</span> sb<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">int</span> opt<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">int</span> is_name <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token class-name\">regex_t</span> preg<span class=\"token punctuation\">;</span>\r\n\r\n    opt <span class=\"token operator\">=</span> <span class=\"token function\">getopt</span><span class=\"token punctuation\">(</span>argc<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">,</span> <span class=\"token string\">\"n:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>opt <span class=\"token operator\">==</span> <span class=\"token char\">'n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n        pt <span class=\"token operator\">=</span> optarg<span class=\"token punctuation\">;</span>\r\n        is_name <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>optind <span class=\"token operator\">==</span> argc <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> pathname <span class=\"token operator\">=</span> argv<span class=\"token punctuation\">[</span>optind<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    \r\n    <span class=\"token function\">regcomp</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>preg<span class=\"token punctuation\">,</span> pt<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">stat</span><span class=\"token punctuation\">(</span>pathname<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>sb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">regexec</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>preg<span class=\"token punctuation\">,</span> pathname<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> pathname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>is_name<span class=\"token punctuation\">)</span> <span class=\"token function\">search</span><span class=\"token punctuation\">(</span>pathname<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>preg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">else</span> <span class=\"token function\">search</span><span class=\"token punctuation\">(</span>pathname<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token number\">2019312219</span>@swji<span class=\"token operator\">:</span><span class=\"token operator\">~</span><span class=\"token operator\">/</span>hw<span class=\"token operator\">/</span><span class=\"token number\">8</span>$ <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>search\r\n<span class=\"token punctuation\">.</span>\r\n<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>search<span class=\"token punctuation\">.</span>c\r\n<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>r\r\n<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>stat<span class=\"token punctuation\">.</span>c\r\n<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>list\r\n<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>list<span class=\"token punctuation\">.</span>c\r\n<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>tail\r\n<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>stat\r\n<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>tail<span class=\"token punctuation\">.</span>c\r\n<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>test\r\n<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>test<span class=\"token operator\">/</span>test<span class=\"token punctuation\">.</span>txt\r\n<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>search\r\n<span class=\"token number\">2019312219</span>@swji<span class=\"token operator\">:</span><span class=\"token operator\">~</span><span class=\"token operator\">/</span>hw<span class=\"token operator\">/</span><span class=\"token number\">8</span>$ <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>search <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>test\r\n<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>test\r\n<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>test<span class=\"token operator\">/</span>test<span class=\"token punctuation\">.</span>txt</code></pre></div>\n<p>잘 출력하는 모습을 보인다.</p>\n<h2 id=\"source\" style=\"position:relative;\"><a href=\"#source\" aria-label=\"source permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Source</h2>\n<ul>\n<li>『Operating Systems: Three Easy Pieces』 <em>-Remzi H. Arpaci-Dusseau 지음</em><br>\n<a href=\"https://pages.cs.wisc.edu/~remzi/OSTEP/\" target=\"_blank\" rel=\"nofollow\">https://pages.cs.wisc.edu/~remzi/OSTEP/</a></li>\n</ul>","id":"02e6ff92-9dc5-519c-9d06-3799d2064279","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EB%AC%B8%EC%A0%9C-%EB%B0%8F-%ED%92%80%EC%9D%B4\">문제 및 풀이</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#1-stat-write-your-own-version-of-the-command-line-program-stat-which-simply-calls-the-stat-system-call-on-a-given-file-or-directory-print-out-file-size-number-of-blocks-allocated-reference-link-count-and-so-forth-what-is-the-link-count-of-a-directory-as-the-number-of-entries-in-the-directory-changes-useful-interfaces-stat-naturally\">1. Stat: Write your own version of the command line program stat, which simply calls the stat() system call on a given file or directory. Print out file size, number of blocks allocated, reference (link) count, and so forth. What is the link count of a directory, as the number of entries in the directory changes? Useful interfaces: stat(), naturally.</a></li>\n<li><a href=\"#2-list-files-write-a-program-that-lists-files-in-the-given-directory-when-called-without-any-arguments-the-program-should-just-print-the-file-names-when-invoked-with-the--l-flag-the-program-should-print-out-information-about-each-file-such-as-the-owner-group-permissions-and-other-information-obtained-from-the-stat-system-call-the-program-should-take-one-additional-argument-which-is-the-directory-to-read-eg-myls--l-directory-if-no-directory-is-given-the-program-should-just-use-the-current-working-directory-useful-interfaces-stat-opendir-readdir-getcwd\">2. List Files: Write a program that lists files in the given directory. When called without any arguments, the program should just print the file names. When invoked with the -l flag, the program should print out information about each file, such as the owner, group, permissions, and other information obtained from the stat() system call. The program should take one additional argument, which is the directory to read, e.g., myls -l directory. If no directory is given, the program should just use the current working directory. Useful interfaces: stat(), opendir(), readdir(), getcwd().</a></li>\n<li><a href=\"#3-tail-write-a-program-that-prints-out-the-last-few-lines-of-a-file-the-program-should-be-efficient-in-that-it-seeks-to-near-the-end-of-the-file-reads-in-a-block-of-data-and-then-goes-backwards-until-it-finds-the-requested-number-of-lines-at-this-point-it-should-print-out-those-lines-from-beginning-to-the-end-of-the-file-to-invoke-the-program-one-should-type-mytail--n-file-where-n-is-the-number-of-lines-at-the-end-of-the-file-to-print-useful-interfaces-stat-lseek-open-read-close\">3. Tail: Write a program that prints out the last few lines of a file. The program should be efficient, in that it seeks to near the end of the file, reads in a block of data, and then goes backwards until it finds the requested number of lines; at this point, it should print out those lines from beginning to the end of the file. To invoke the program, one should type: mytail -n file, where n is the number of lines at the end of the file to print. Useful interfaces: stat(), lseek(), open(), read(), close().</a></li>\n<li><a href=\"#4-recursive-search-write-a-program-that-prints-out-the-names-of-each-file-and-directory-in-the-file-system-tree-starting-at-a-given-point-in-the-tree-for-example-when-run-without-arguments-the-program-should-start-with-the-current-working-directory-and-print-its-contents-as-well-as-the-contents-of-any-sub-directories-etc-until-the-entire-tree-root-at-the-cwd-is-printed-if-given-a-single-argument-of-a-directory-name-use-that-as-the-root-of-the-tree-instead-refine-your-recursive-search-with-more-fun-options-similar-to-the-powerful-find-command-line-tool-useful-interfaces-figure-it-out\">4. Recursive Search: Write a program that prints out the names of each file and directory in the file system tree, starting at a given point in the tree. For example, when run without arguments, the program should start with the current working directory and print its contents, as well as the contents of any sub-directories, etc., until the entire tree, root at the CWD, is printed. If given a single argument (of a directory name), use that as the root of the tree instead. Refine your recursive search with more fun options, similar to the powerful find command line tool. Useful interfaces: figure it out.</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#source\">Source</a></p>\n</li>\n</ul>","frontmatter":{"title":"OS: Three Easy Pieces [Remzi] <39.FS APIs> 풀이","summary":"교재 Operating Systems: Three Easy Pieces [Remzi] 속 Homework 문제 풀이","date":"2023.09.05.","categories":["Operating System"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABESAAAREgEAwpvaAAABrklEQVQozzWSPa/qMAyG08RN4iRNvxADGwL1qiBoqaAduiAhMfADGEAV450Y2BD8+atTn/sMUeTYsvO+ZlEUOeeUUgCgtZZSGmMQ0VqrlPLex3EMAFEUAQAiAoBSii5MSqlG4ji21mZZhohJkiBilmXWWmNMFEVCCMr03mutAUBKyYQQnPMgCIQQv6ERzrmUEgAoQY4EQcAYU0pxzn87c86ttcfjcbvdFkWxXq/7vu+6bj6fV1V1Op2apun7vqqqpmkWiwVNEYYhc85xzrMsu9/v7/d7GIbb7fZ6vYZh+H6/5/P58/n8HXk+n4/H43q9MsZghGmtnXPee6VUnueHw6Esy9Vqtd/v+74vy7Jt2z8jk8lECEFyIqIQgiEi1ZPaZVnWdb3ZbOq67rpuvV4XRbHb7dq2nc1mxhgSIk1T5xwjqYMgoAt9hoQVQmithRD0pLXO89w5J6X8LQYAspROmsI5lyQJ+a+1NsZQkAy31iKiMebHKkQk6eM4FiNku9Y6DEP/H5rZWhtFUZqmy+XypzNV0pIBQBiGAOC9R0SayHtP24KI0+m0LMumaS6Xyz8ykDVBPPlfZQAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/5e3e112afb9c9c7bd4c291006dba33a4/3739d/book2.png","srcSet":"/static/5e3e112afb9c9c7bd4c291006dba33a4/da853/book2.png 141w,\n/static/5e3e112afb9c9c7bd4c291006dba33a4/9f0de/book2.png 283w,\n/static/5e3e112afb9c9c7bd4c291006dba33a4/3739d/book2.png 565w","sizes":"(min-width: 565px) 565px, 100vw"},"sources":[{"srcSet":"/static/5e3e112afb9c9c7bd4c291006dba33a4/cdf2b/book2.webp 141w,\n/static/5e3e112afb9c9c7bd4c291006dba33a4/d9fe4/book2.webp 283w,\n/static/5e3e112afb9c9c7bd4c291006dba33a4/8b8b9/book2.webp 565w","type":"image/webp","sizes":"(min-width: 565px) 565px, 100vw"}]},"width":565,"height":306}},"publicURL":"/static/5e3e112afb9c9c7bd4c291006dba33a4/book2.png"}}}}]}},"pageContext":{"slug":"/os_hw_8/"}},"staticQueryHashes":[]}