{"componentChunkName":"component---src-templates-post-template-tsx","path":"/db_hw1/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p>과거 데이터베이스개론 수업을 들으며 진행했던 DB 개선 과제를 복습겸 정리했습니다.</p>\n<h2 id=\"1-simpledb란-주의-aws-simpledb아님\" style=\"position:relative;\"><a href=\"#1-simpledb%EB%9E%80-%EC%A3%BC%EC%9D%98-aws-simpledb%EC%95%84%EB%8B%98\" aria-label=\"1 simpledb란 주의 aws simpledb아님 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. SimpleDB란? (주의! AWS SimpleDB아님)</h2>\n<p>Boston College의 Edward Sciore 교수님이 논문으로 발표한 Java 기반의 다중 사용자 DB입니다.<br>\n주로 교육용으로 자주 사용됩니다! 관련 논문은 다음과 같습니다.<br>\n<a href=\"https://dl.acm.org/doi/10.1145/1227504.1227498\" target=\"_blank\" rel=\"nofollow\">SimpleDB: a simple java-based multiuser syst for teaching database internals</a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 302px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3f2e40f33f45999ea7c4f4d548074380/83034/001.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 180.20833333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAIAAAAGkY33AAAACXBIWXMAAAsTAAALEwEAmpwYAAADfUlEQVRIx31V69KiOBT0/Z/QKlQMuYfcJSj4qbOk2Yw7u7X9gzqEAOfS3TmUUqy1McYQgq8IFa4ihBArEGAPnpZSDiklpRRjzDl3u92GYRBC5Jz7vldK5ZwJIQiEEEop55xSylqbUjrknEMIwzDEGD+fz/v9/vwTr9fr34vP5zPGeAghXK9XIQRjbBgGVkErWvy9iNvr9RpC2P5sjBFCOOdSSoyxcRydc+M4cs6FEN57zrmU0jlnKzjnxpgt7ZSSc45SKoQIITDGlFLYja9orYdhoJRKKSmlWmvGWAhhexkFc86RM/IHpJSc8xZwzgkhSAfvb39GG1NK2GStRT8JId57pVTf99ZaxhiywCf2tFFVjFFrzTl3zqEEQggoME3Tz8/PPM/LskwVpZS926ICOWutpZRIVQhBKTXGlFJSSrfbLeeMN0GnQ4wRTULPUZKsQDn4RBsYmkcI2f6MUXHO53lGb0E1cPB+v2NCzrm5AiPYu42GnU4nIcRS8Xg8vq8IvrGuayll6zYYhpEgpf/BUEEp/c0wcF1rHWNUSkkprbUYgTFmHEfowVoLzRhjnHM55y1trXXf98MwgGHon5SSEMIY45yD/BiklPJ6vd5ut61h3nu8SQhBSt/J/7HYbvu+39MGE7z3psJaa4yRUmqtvfdIG4ttz97tnDO4XkpZlmWe5/v9Ps/zNE3zPK/r+ng8SsU8z4jvFXu3z+fz6XSSUuKr4xfayh/rnPONYSkldK89UBXjOOoK8ze01iAi4p0kIQStdduNhjvnwFAMTGsN2oIOcI6N21AiuD0MA/iM/3POz+czKAQnhPLHcdxGFWOEGWAHgqZ+6KQ9bW6xCwMkge6xA9pgjLVsY4zWWhgTtIBgr7k1yRiDYBxHxti6rp//wm69MUaYW9MwGoPKEXwDK7sNhRDa/el0gsKEEDCqbxmB7bBBSules/ceQwJP8PNSCo6Lhvf73YJlWX43DEV67621iHGypQoEMcacM+J9zqAndNN1HWPscrlQSruuI4Qcj0fU0nXd5XI5Ho993xNCuq7bfTuEgFMPZwqMdlmW5/MJu30+n8uyvF6vdjtN095tCBBDYoxBTwAE1KTWrnDIA6qH9NYKmN79C7htTojF1+u16zmEAHNCIjgNUQ7cC+cJqArrfTweB5z92ArroJSCD9ApynHOtYMO1v3Xy78AeAjEUDGghV0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3f2e40f33f45999ea7c4f4d548074380/a59e9/001.webp 192w,\n/static/3f2e40f33f45999ea7c4f4d548074380/794ea/001.webp 302w\"\n              sizes=\"(max-width: 302px) 100vw, 302px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3f2e40f33f45999ea7c4f4d548074380/3b721/001.png 192w,\n/static/3f2e40f33f45999ea7c4f4d548074380/83034/001.png 302w\"\n            sizes=\"(max-width: 302px) 100vw, 302px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3f2e40f33f45999ea7c4f4d548074380/83034/001.png\"\n            alt=\".\"\n            title=\".\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span><br>\nSimpleDB 컴포넌트 구조</p>\n<h2 id=\"2-simpledb-실행-방법-embedded-mode\" style=\"position:relative;\"><a href=\"#2-simpledb-%EC%8B%A4%ED%96%89-%EB%B0%A9%EB%B2%95-embedded-mode\" aria-label=\"2 simpledb 실행 방법 embedded mode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. SimpleDB 실행 방법 (Embedded mode)</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 데이터베이스 테이블/레코드 생성</span>\r\n$ <span class=\"token builtin class-name\">cd</span> <span class=\"token variable\">$SDBHOME</span>/target \r\n$ <span class=\"token function\">java</span> <span class=\"token parameter variable\">-cp</span> ./simpledb-project-1.0.0.jar simpleclient.embedded.CreateStudentDB\r\n<span class=\"token comment\"># 데이터베이스 내 레코드 확인</span>\r\n$ <span class=\"token function\">java</span> <span class=\"token parameter variable\">-cp</span> ./simpledb-project-1.0.0.jar\tsimpleclient.embedded.StudentMajor\r\n<span class=\"token comment\"># 데이터베이스 삭제</span>\r\n$ <span class=\"token builtin class-name\">cd</span> <span class=\"token variable\">$SDBHOME</span>/target/studentdb \r\n$ <span class=\"token function\">rm</span> –i *.tbl\r\n<span class=\"token comment\"># Interactive shell을 실행</span>\r\n$ <span class=\"token builtin class-name\">cd</span> <span class=\"token variable\">$SDBHOME</span>/target \r\n$ <span class=\"token function\">java</span> <span class=\"token parameter variable\">-cp</span> ./simpledb-project-1.0.0.jar simpleclient.SimpleIJ</code></pre></div>\n<h2 id=\"목표-improving-buffer-manager-lru-midpoint-insertion-policy\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C-improving-buffer-manager-lru-midpoint-insertion-policy\" aria-label=\"목표 improving buffer manager lru midpoint insertion policy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목표: Improving Buffer Manager (LRU, midpoint-insertion policy)</h2>\n<p>SimpleDB의 vanila buffer manager는 다음과 같은 한계점이 존재한다.</p>\n<ol>\n<li>buffer replace 정책에서 항상 맨 앞에오는 unpinned buffer만 사용한다.</li>\n<li>이미 buffer에 있는 블록을 확인할때 단순히 선형 탐색만 한다.</li>\n</ol>\n<p>buffer manager를 수정하여 위의 2가지 정책을 조금더 효율적으로 바꿀수 있는 LRU policy, midpoint-insertion policy를 구현해보자. midpoint-insertion policy는 다음 포스트에서 다룬다.\r\n향상된 성능은 hit ratio 성능로 확인.</p>\n<h2 id=\"구현-및-테스트\" style=\"position:relative;\"><a href=\"#%EA%B5%AC%ED%98%84-%EB%B0%8F-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"구현 및 테스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>구현 및 테스트</h2>\n<h3 id=\"1-buffer-클래스-필수-구현-항목\" style=\"position:relative;\"><a href=\"#1-buffer-%ED%81%B4%EB%9E%98%EC%8A%A4-%ED%95%84%EC%88%98-%EA%B5%AC%ED%98%84-%ED%95%AD%EB%AA%A9\" aria-label=\"1 buffer 클래스 필수 구현 항목 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Buffer 클래스 필수 구현 항목</h3>\n<p>각 버퍼 객체는 자신의 buffer ID를 알 수 있어야 한다. 생성자에서 buffer ID를 가리키는 3번째 매개변수가 있어야한다. getID() 메소드를 통해 buffer ID를 반환받을 수 있도록 한다.</p>\n<p>Buffer.java</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Buffer</span> <span class=\"token punctuation\">{</span>\r\n   <span class=\"token keyword\">private</span> <span class=\"token class-name\">FileMgr</span> fm<span class=\"token punctuation\">;</span>  <span class=\"token comment\">/* File manager */</span>\r\n   <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>생략<span class=\"token punctuation\">)</span>\r\n   <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> bid<span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// 버퍼 내에서 buffer ID를 가리키는 변수 bid를 추가한다.</span>\r\n\r\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FileMgr</span> fm<span class=\"token punctuation\">,</span> <span class=\"token class-name\">LogMgr</span> lm<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> bid<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fm <span class=\"token operator\">=</span> fm<span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lm <span class=\"token operator\">=</span> lm<span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bid <span class=\"token operator\">=</span> bid<span class=\"token punctuation\">;</span>\r\n      contents <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Page</span><span class=\"token punctuation\">(</span>fm<span class=\"token punctuation\">.</span><span class=\"token function\">blockSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span>\r\n<span class=\"token comment\">// 생성자에서 buffer ID를 가리키는 3번째 매개변수를 추가한다.</span>\r\n\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> <span class=\"token function\">getID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">return</span> bid<span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span>\r\n<span class=\"token comment\">// 자신의 buffer ID를 반환하는 getID() 메소드를 구현한다.</span>\r\n\r\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">VanillaBufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FileMgr</span> fm<span class=\"token punctuation\">,</span> <span class=\"token class-name\">LogMgr</span> lm<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> numbuffs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>생략<span class=\"token punctuation\">)</span>\r\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>numbuffs<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n         bufferpool<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">(</span>fm<span class=\"token punctuation\">,</span> lm<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">LRUBufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FileMgr</span> fm<span class=\"token punctuation\">,</span> <span class=\"token class-name\">LogMgr</span> lm<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> numbuffs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>생략<span class=\"token punctuation\">)</span>\r\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>buff_size<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n         unpin_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">(</span>fm<span class=\"token punctuation\">,</span> lm<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>위의 버퍼 클래스 생성자 변화에 따라, 버퍼 매니저에서도 새로운 n개 버퍼 생성시 BlockID를 0~n-1까지 할당한다.</p>\n<h3 id=\"2-vanillabuffermgr-클래스-필수-구현-항목\" style=\"position:relative;\"><a href=\"#2-vanillabuffermgr-%ED%81%B4%EB%9E%98%EC%8A%A4-%ED%95%84%EC%88%98-%EA%B5%AC%ED%98%84-%ED%95%AD%EB%AA%A9\" aria-label=\"2 vanillabuffermgr 클래스 필수 구현 항목 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. VanillaBufferMgr 클래스 필수 구현 항목</h3>\n<p>printStatus() 메소드를 호출하면 자신의 현재 상태를 나타내야한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">/* Write your code */</span>\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Allocated Buffers:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">:</span> bufferpool<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n         <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Buffer \"</span> <span class=\"token operator\">+</span> buff<span class=\"token punctuation\">.</span><span class=\"token function\">getID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> <span class=\"token string\">\": \"</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token class-name\">String</span> is_pin <span class=\"token operator\">=</span> <span class=\"token string\">\"unpinned\"</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">block</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">block</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">isPinned</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \r\n            is_pin <span class=\"token operator\">=</span> <span class=\"token string\">\"pinned\"</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>is_pin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \r\n      <span class=\"token punctuation\">}</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>각 버퍼의 ID, block, pinnedStatus를 출력한다. buff.block()의 경우 BlockId의 toString() 메소드를 호출하여 [filename, blkID] string을 만들어 낸다. 아직 버퍼가 할당되지 않았을 경우, BlockId는 비어있으므로 해당 부분은 출력하지 않았다.</p>\n<p>getHitRatio() 메소드 호출 시 현재 버퍼의 hit ratio를 나타낸다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">VanillaBufferMgr</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">BufferMgr</span> <span class=\"token punctuation\">{</span>\r\n   <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>생략<span class=\"token punctuation\">)</span>\r\n   <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> hit_cnt<span class=\"token punctuation\">;</span>\r\n   <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> reference_cnt<span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// hit ratio 계산에 활용되는 두 변수를 할당해 준다.</span>\r\n\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token class-name\">Buffer</span> <span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BlockId</span> blk<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n         <span class=\"token keyword\">long</span> timestamp <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> <span class=\"token function\">tryToPin</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token function\">waitingTooLong</span><span class=\"token punctuation\">(</span>timestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token function\">wait</span><span class=\"token punctuation\">(</span><span class=\"token constant\">MAX_TIME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            buff <span class=\"token operator\">=</span> <span class=\"token function\">tryToPin</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token punctuation\">}</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BufferAbortException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>reference_cnt<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\r\n         <span class=\"token keyword\">return</span> buff<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">InterruptedException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n         <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BufferAbortException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>reference cnt는 블럭을 pin하려는 경우, 해당 블럭 반환이 성공적일 때만 증가한다. 따라서 tryToPin(blk) 를 했을때 반환되는 buff가 널이 아닌경우, 즉 성공했을 경우에만(에러가 아닌 경우) reference_cnt++;를 해주었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token class-name\">Buffer</span> <span class=\"token function\">tryToPin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BlockId</span> blk<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> <span class=\"token function\">findExistingBuffer</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// not find in buffer</span>\r\n         buff <span class=\"token operator\">=</span> <span class=\"token function\">chooseUnpinnedBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n         buff<span class=\"token punctuation\">.</span><span class=\"token function\">assignToBlock</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// find in buffer</span>\r\n         hit_cnt<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span> \r\n      <span class=\"token punctuation\">}</span> \r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">isPinned</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n         numAvailable<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// new allocate becaues not in buffer</span>\r\n      buff<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">return</span> buff<span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>hit cnt는 현재 버퍼풀에 pin하고자 하는 블럭이 있을 경우 증가하므로, findExistingBuffer(blk)의 결과값이 널이 아닐때, 즉 찾았을 때만 hit_cnt++로 증가시켜 주었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>math<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">BigDecimal</span></span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>math<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">RoundingMode</span></span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>생략<span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">float</span> <span class=\"token function\">getHitRatio</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">/*Write your code */</span>\r\n   <span class=\"token comment\">//  System.out.println(hit_cnt+\" / \"+reference_cnt); </span>\r\n    <span class=\"token keyword\">float</span> hit_ratio <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span>hit_cnt <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span>reference_cnt<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token class-name\">BigDecimal</span> hit_ratio_bd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BigDecimal</span><span class=\"token punctuation\">(</span>hit_ratio<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token class-name\">BigDecimal</span> hit_ratio_bd_r2 <span class=\"token operator\">=</span> hit_ratio_bd<span class=\"token punctuation\">.</span><span class=\"token function\">setScale</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">RoundingMode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HALF_UP</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> hit_ratio_bd_r2<span class=\"token punctuation\">.</span><span class=\"token function\">floatValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Hit ratio: buffer hit cnt/reference cnt * 100 (%) 공식에 따라 계산한 값을 반환하는 메소드이다. Round to two decimal places를 충족하기위해 BigDecimal과 RoundingMode를 사용하였다. 기존의 float형태의 hit_ratio을 BigDecimal(hit_ratio)로 변환하고, setScale(2, RoundingMode.HALF_UP)을 통해 소숫점 2자리까지 반올림 해주었다. 반환할때는 다시 floatValue()로 변환하여 리턴한다.</p>\n<h3 id=\"3-lrubuffermgr-필수-구현-항목\" style=\"position:relative;\"><a href=\"#3-lrubuffermgr-%ED%95%84%EC%88%98-%EA%B5%AC%ED%98%84-%ED%95%AD%EB%AA%A9\" aria-label=\"3 lrubuffermgr 필수 구현 항목 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. LRUBufferMgr 필수 구현 항목</h3>\n<p>※ LRUBufferMgr 구현에 있어 VanillaBufferMgr의 메소드 tryToPin(), findExistingBuffer(), chooseUnpinnedBuffer() 등을 재활용 하였다.</p>\n<p>Unpinned buffer의 리스트를 따로 관리한다. Allocated buffer들에 대해 map을 유지한다</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">LRUBufferMgr</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">BufferMgr</span> <span class=\"token punctuation\">{</span>\r\n\r\n   <span class=\"token keyword\">private</span> <span class=\"token class-name\">LinkedList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">></span></span> unpin_buffer<span class=\"token punctuation\">;</span>\r\n   <span class=\"token keyword\">private</span> <span class=\"token class-name\">HashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">></span></span> alloc_buffer<span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>생략<span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">LRUBufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FileMgr</span> fm<span class=\"token punctuation\">,</span> <span class=\"token class-name\">LogMgr</span> lm<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> numbuffs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>생략<span class=\"token punctuation\">)</span>\r\n      unpin_buffer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LinkedList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      alloc_buffer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>buff_size<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n         unpin_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">(</span>fm<span class=\"token punctuation\">,</span> lm<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>위와 같이 LinkedList<Buffer> 클래스를 사용하여 unpin_buffer를 만들고, HashMap&#x3C;BlockId,Buffer> 를 활용하여 alloc_buffer를 만들었다. alloc_buffer의 경우 과제 명세 설명 “Keep a map of allocated buffers, keyed on the block they contain.” 처럼 map의 일종인 hashmap을 활용했으며, BlockId를 key로 하여 Buffer를 value로 담도록 하였다.\r\n2) Unpinned buffer 작동</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token class-name\">Buffer</span> <span class=\"token function\">chooseUnpinnedBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>unpin_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n         <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> unpin_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">getFirst</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         unpin_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">removeFirst</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">return</span> buff<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>과제 명세 설명 “When a replacement buffer is needed, remove the buffer at the head of the list and use it.” 를 위와 같이 구현하였다. chooseUnpinnedBuffer()를 통해 replacement buffer가 요청되면, unpin_buffer에서 getFirst()를 통해 가장 앞에 있는 버퍼(head)를 반환한다. 단, 반환하기 전에 removeFirst()통해 버퍼에서 지운다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token keyword\">void</span> <span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Buffer</span> buff<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      buff<span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">isPinned</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n         unpin_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">addLast</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token function\">notifyAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>과제 명세 설명 “When a buffer’s pin count becomes 0, add it to the end of the list.” 를 위와 같이 구현하였다. 버퍼의 pin count가 0이 되는 순간은 unpin을 할때 발생한다. 이때 buff.isPinned()가 false 라면, 즉, pin count가 0이라면 addLast(buff)를 통해 unpin_buffer의 마지막에 버퍼를 넣어준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token class-name\">Buffer</span> <span class=\"token function\">tryToPin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BlockId</span> blk<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> <span class=\"token function\">findExistingBuffer</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// not find in buffer</span>\r\n         buff <span class=\"token operator\">=</span> <span class=\"token function\">chooseUnpinnedBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n         alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">block</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         buff<span class=\"token punctuation\">.</span><span class=\"token function\">assignToBlock</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">,</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// find in buffer</span>\r\n         hit_cnt<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      unpin_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">return</span> buff<span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>과제 명세 설명 “Use LRU policy” 를 위와 같이 구현하였다. LRU 정책에 따라, unpin되어있는 버퍼가 touch 될 경우 리스트에서 뽑은 다음 맨 마지막으로 순서를 바꿔줘야 한다. 단, 여기서 touch는 pin을 의미하므로, 결국 해당 버퍼는 Unpinned buffer에서 빠지게 된다.</p>\n<p>Allocated buffer 구현</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">LRUBufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FileMgr</span> fm<span class=\"token punctuation\">,</span> <span class=\"token class-name\">LogMgr</span> lm<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> numbuffs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>생략<span class=\"token punctuation\">)</span>\r\n      unpin_buffer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LinkedList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      alloc_buffer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>buff_size<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n         unpin_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">(</span>fm<span class=\"token punctuation\">,</span> lm<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">private</span> <span class=\"token class-name\">Buffer</span> <span class=\"token function\">tryToPin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BlockId</span> blk<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> <span class=\"token function\">findExistingBuffer</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// not find in buffer</span>\r\n         buff <span class=\"token operator\">=</span> <span class=\"token function\">chooseUnpinnedBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n         alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">block</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         buff<span class=\"token punctuation\">.</span><span class=\"token function\">assignToBlock</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">,</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// find in buffer</span>\r\n         hit_cnt<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hit buff id: \"</span><span class=\"token operator\">+</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">getID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\" block: \"</span><span class=\"token operator\">+</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">block</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \r\n      <span class=\"token punctuation\">}</span>\r\n      unpin_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">return</span> buff<span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>과제 명세 설명  “A buffer starts out unallocated. It becomes allocated when it is first assigned to a block and stays allocated forever after. When a buffer is firty allocated, it must be added to map. When a buffer is replaced, the map must be changed. the mapping for the old block must be removed, and the mapping for the new block must be added.”을 위와 같이 구현하였다.</p>\n<p>최초 Constructor에서는 모든 버퍼가 아직 할당 전이므로 unpin_buffer에만 등록되고 alloc_buffer는 비어있다. 이후 tryToPin()에서 현재 버퍼에 없을때 실제로 첫 할당이 이루어진다.<br>\n여기서, remove()의 경우에는 해시 맵에 있을때만 해당 원소가 제거되므로, 최초 등록시에는 put()만 작동하여 무조건 alloc_buffer에 버퍼가 등록된다. 따라서 “It becomes allocated when it is first assigned to a block”가 충족된다.<br>\n그리고 한번 등록되면 그 이후로는 remove()와 put()이 쌍으로 작동하므로 “mapping for the old block must be removed, and the mapping for the new block must be added”를 수행하며, “allocated forever after” 도 충족한다(지우고나서 항상 다시 등록하므로).</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token class-name\">Buffer</span> <span class=\"token function\">findExistingBuffer</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BlockId</span> blk<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">containsKey</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n         <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">return</span> buff<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>과제 명세 설명 “Use a map to determine if a block is currently in the buffer.” 을 위와 같이 구현하였다. findExistingBuffer()를 통해 현재 alloc_buffer에 버퍼가 있는지 확인하며, alloc_buffer.containsKey(blk) 가 참이라면 해당 blk에 해당하는 버퍼를 반환한다. 만약 없다면, null을 반환한다.</p>\n<p>printStatus() 구현</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Allocated Buffers:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">BlockId</span> i <span class=\"token operator\">:</span> alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">keySet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n         <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token class-name\">String</span> is_pin <span class=\"token operator\">=</span> <span class=\"token string\">\"unpinned\"</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">isPinned</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> is_pin <span class=\"token operator\">=</span> <span class=\"token string\">\"pinned\"</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Buffer \"</span> <span class=\"token operator\">+</span> buff<span class=\"token punctuation\">.</span><span class=\"token function\">getID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\": \"</span> <span class=\"token operator\">+</span> buff<span class=\"token punctuation\">.</span><span class=\"token function\">block</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span> <span class=\"token operator\">+</span> is_pin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Unpinned Buffers in LRU order: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">:</span> unpin_buffer<span class=\"token punctuation\">)</span>\r\n\t\t<span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">getID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>과제 명세 설명 “Map 내의 각 버퍼의 ID, block, pinnedStatus, unpinned list의 buffer”에 따라 위와 같이 구현하였다. alloc_buffer Map에 존재하는 모든 key들에 대해 value, 즉 버퍼들을 불러와서 해당 버퍼들의 정보를 출력한다. buff.block().toString()을 활용하였다. unpinned buffer의 경우, 앞에서 부터 순차적으로 순회하며 값들을 출력하도록 하였다.</p>\n<p>getHitRatio() 구현</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token class-name\">Buffer</span> <span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BlockId</span> blk<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n         <span class=\"token keyword\">long</span> timestamp <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> <span class=\"token function\">tryToPin</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token function\">waitingTooLong</span><span class=\"token punctuation\">(</span>timestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token function\">wait</span><span class=\"token punctuation\">(</span><span class=\"token constant\">MAX_TIME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            buff <span class=\"token operator\">=</span> <span class=\"token function\">tryToPin</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token punctuation\">}</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BufferAbortException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>reference_cnt<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\r\n         <span class=\"token keyword\">return</span> buff<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">InterruptedException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n         <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BufferAbortException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n   <span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">private</span> <span class=\"token class-name\">Buffer</span> <span class=\"token function\">tryToPin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BlockId</span> blk<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> <span class=\"token function\">findExistingBuffer</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// not find in buffer</span>\r\n         buff <span class=\"token operator\">=</span> <span class=\"token function\">chooseUnpinnedBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n         alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">block</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         buff<span class=\"token punctuation\">.</span><span class=\"token function\">assignToBlock</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">,</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// find in buffer</span>\r\n         hit_cnt<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      unpin_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">return</span> buff<span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">float</span> <span class=\"token function\">getHitRatio</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">float</span> hit_ratio <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span>hit_cnt <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span>reference_cnt<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">BigDecimal</span> hit_ratio_bd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BigDecimal</span><span class=\"token punctuation\">(</span>hit_ratio<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">BigDecimal</span> hit_ratio_bd_r2 <span class=\"token operator\">=</span> hit_ratio_bd<span class=\"token punctuation\">.</span><span class=\"token function\">setScale</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">RoundingMode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HALF_UP</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">return</span> hit_ratio_bd_r2<span class=\"token punctuation\">.</span><span class=\"token function\">floatValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>getHitRatio()의 경우, VanillaBufferMgr와 동일하게 적용했다. tryToPin(blk) 를 했을때 반환되는 buff가 널이 아닌경우, 즉 성공했을 경우에만(에러가 아닌 경우) reference_cnt++;가 되고, findExistingBuffer(blk) 의 결과값이 널이 아닐때, 즉 원하는 블럭을 찾았을 때만 hit_cnt++가 된다. 최종적으로는 cnt/reference cnt * 100 (%) 공식과 BigDecimal과 RoundingMode를 사용해 소숫점 2자리까지 반올림하여 리턴한다.</p>\n<p>기타 구현\r\n위에 소개되지 않았으나, LRU 구현에 사용한 부분들을 정리하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token keyword\">int</span> <span class=\"token function\">available</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> unpin_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>VanillaBufferMgr 에서는 버퍼 중에서 pinned 되어 있지 않은 버퍼들에 대해 numAvailable 변수를 따로 관리한다. 해당 값은 pin을 할때 새로운 버퍼가 할당되면 감소하고, 기존의 버퍼가 unpin 되면 감소한다. LRUBufferMgr에서는 이러한 변수가 따로 필요없다. Unpinned buffer 자체가 해당 역할을 하며, 해당 리스트의 길이가 결국 가능한 버퍼의 수를 뜻하기 때문이다. 따라서 available() 에서는 size()를 반환했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">   <span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token keyword\">void</span> <span class=\"token function\">flushAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> txnum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n\r\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">BlockId</span> i <span class=\"token operator\">:</span> alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">keySet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n         <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">modifyingTx</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> txnum<span class=\"token punctuation\">)</span>\r\n         buff<span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">:</span> unpin_buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">modifyingTx</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> txnum<span class=\"token punctuation\">)</span>\r\n         buff<span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>VanillaBufferMgr 에서는 flushAll()을 진행하면 버퍼풀에 있는 모든 버퍼에 대해 buff.modifyingTx() == txnum를 만족하면 buff.flush();를 진행한다. LRUBufferMgr 에서는  Unpinned buffer, Allocated buffer 속 모든 버퍼에 대해서 flush()를 하도록 하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">long</span> <span class=\"token constant\">MAX_TIME</span> <span class=\"token operator\">=</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">waitingTooLong</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> starttime<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">return</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> starttime <span class=\"token operator\">></span> <span class=\"token constant\">MAX_TIME</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token class-name\">Buffer</span> <span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BlockId</span> blk<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n         <span class=\"token keyword\">long</span> timestamp <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> <span class=\"token function\">tryToPin</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token function\">waitingTooLong</span><span class=\"token punctuation\">(</span>timestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token function\">wait</span><span class=\"token punctuation\">(</span><span class=\"token constant\">MAX_TIME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            buff <span class=\"token operator\">=</span> <span class=\"token function\">tryToPin</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token punctuation\">}</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BufferAbortException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>reference_cnt<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\r\n         <span class=\"token keyword\">return</span> buff<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">InterruptedException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n         <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BufferAbortException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>기존 VanillaBufferMgr와 동일하게, LRUBufferMgr에서도 MAX_TIME을 정해서 일정 시간 이상 tryToPin()에 실패할 경우 에러를 발생시키도록 하였다.</p>\n<h3 id=\"4-테스트\" style=\"position:relative;\"><a href=\"#4-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"4 테스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 테스트</h3>\n<p>Buffer\r\ngetID() 테스트</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BufferMgrTest</span> <span class=\"token punctuation\">{</span>\r\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">SimpleDB</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleDB</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"buffermgrtest\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"vanilla\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">BufferMgr</span> bm <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">bufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buff <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> \r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testfile\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testfile\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testfile\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testfile\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Buffer</span> buf <span class=\"token operator\">:</span> buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buf <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bid: \"</span> <span class=\"token operator\">+</span> buf<span class=\"token punctuation\">.</span><span class=\"token function\">getID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n   <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n결과\r\nbid<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\r\nbid<span class=\"token operator\">:</span> <span class=\"token number\">1</span>\r\nbid<span class=\"token operator\">:</span> <span class=\"token number\">2</span>\r\nbid<span class=\"token operator\">:</span> <span class=\"token number\">3</span></code></pre></div>\n<p>ID가 잘 출력되는 것을 확인할 수 있다.</p>\n<p>VanillaBufferMgr\r\nprintStatus() 테스트</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BufferMgrTest</span> <span class=\"token punctuation\">{</span>\r\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">SimpleDB</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleDB</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"buffermgrtest\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"vanilla\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">BufferMgr</span> bm <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">bufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buff <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> \r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n결과\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">0</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">3</span><span class=\"token punctuation\">]</span> pinned</code></pre></div>\n<p>과제 명세과 동일하게 잘 출력된다.</p>\n<p>getHitRatio() 및 예제 코드 테스트</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BufferMgrTest</span> <span class=\"token punctuation\">{</span>\r\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">SimpleDB</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleDB</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"buffermgrtest\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"vanilla\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// only 3 buffers</span>\r\n      <span class=\"token class-name\">BufferMgr</span> bm <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">bufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buff <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> \r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testfile\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>생략<span class=\"token punctuation\">)</span>\r\n\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hit ratio: \"</span> <span class=\"token operator\">+</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">getHitRatio</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n결과\r\n<span class=\"token class-name\">Available</span> buffers<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\r\n<span class=\"token class-name\">Attempting</span> <span class=\"token keyword\">to</span> <span class=\"token namespace\">pin</span> block <span class=\"token number\">3.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\r\n<span class=\"token class-name\">Exception</span><span class=\"token operator\">:</span> <span class=\"token class-name\">No</span> available buffers\r\n\r\n<span class=\"token class-name\">Final</span> <span class=\"token class-name\">Buffer</span> <span class=\"token class-name\">Allocation</span><span class=\"token operator\">:</span>\r\nbuff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> pinned <span class=\"token keyword\">to</span> <span class=\"token namespace\">block</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\r\nbuff<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> pinned <span class=\"token keyword\">to</span> <span class=\"token namespace\">block</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\r\nbuff<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> pinned <span class=\"token keyword\">to</span> <span class=\"token namespace\">block</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\r\nbuff<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> pinned <span class=\"token keyword\">to</span> <span class=\"token namespace\">block</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\r\nhit ratio<span class=\"token operator\">:</span> <span class=\"token number\">33.33</span></code></pre></div>\n<p>중간에 try가 실패한 buff[5] = bm.pin(new BlockId(“testfile”, 3))를 제외하면 총 6번의 pin에 대한 성공적인 반환이 존재한다. 따라서 reference cnt = 6. 그리고 bm.pin(new BlockId(“testfile”, 0)) 과 bm.pin(new BlockId(“testfile”, 1)) 에서 현재 버퍼풀에 존재하는 블럭을 요청하였으므로 2번의 hit이 발생한다. 따라서  hit ratio = 2 / 6 = 33.3333 이되고, 두자리 반올림에 따라 33.33이 성공적으로 반환이 된다.</p>\n<h3 id=\"lrubuffermgr\" style=\"position:relative;\"><a href=\"#lrubuffermgr\" aria-label=\"lrubuffermgr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>LRUBufferMgr</h3>\n<p>printStatus() 테스트</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BufferMgrTest</span> <span class=\"token punctuation\">{</span>\r\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">SimpleDB</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleDB</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"buffermgrtest\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lru\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">BufferMgr</span> bm <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">bufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buff <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> \r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n결과\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">0</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">3</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Unpinned</span> <span class=\"token class-name\">Buffers</span> in <span class=\"token constant\">LRU</span> order<span class=\"token operator\">:</span> <span class=\"token number\">2</span> <span class=\"token number\">0</span></code></pre></div>\n<p>과제 명세과 동일하게 잘 출력된다.</p>\n<p>getHitRatio() 및 예제 코드 테스트</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BufferMgrTest</span> <span class=\"token punctuation\">{</span>\r\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">SimpleDB</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleDB</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"buffermgrtest\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lru\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// only 3 buffers</span>\r\n      <span class=\"token class-name\">BufferMgr</span> bm <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">bufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buff <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> \r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testfile\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>생략<span class=\"token punctuation\">)</span>\r\n\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hit ratio: \"</span> <span class=\"token operator\">+</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">getHitRatio</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n결과\r\n<span class=\"token class-name\">Available</span> buffers<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\r\n<span class=\"token class-name\">Attempting</span> <span class=\"token keyword\">to</span> <span class=\"token namespace\">pin</span> block <span class=\"token number\">3.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\r\n<span class=\"token class-name\">Exception</span><span class=\"token operator\">:</span> <span class=\"token class-name\">No</span> available buffers\r\n\r\n<span class=\"token class-name\">Final</span> <span class=\"token class-name\">Buffer</span> <span class=\"token class-name\">Allocation</span><span class=\"token operator\">:</span>\r\nbuff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> pinned <span class=\"token keyword\">to</span> <span class=\"token namespace\">block</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\r\nbuff<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> pinned <span class=\"token keyword\">to</span> <span class=\"token namespace\">block</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\r\nbuff<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> pinned <span class=\"token keyword\">to</span> <span class=\"token namespace\">block</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\r\nbuff<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> pinned <span class=\"token keyword\">to</span> <span class=\"token namespace\">block</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\r\nhit ratio<span class=\"token operator\">:</span> <span class=\"token number\">33.33</span></code></pre></div>\n<p>잘 출력된다.</p>\n<p>hit ratio 차이 확인</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BufferMgrTest</span> <span class=\"token punctuation\">{</span>\r\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">SimpleDB</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleDB</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"buffermgrtest\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"vanilla\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// only 3 buffers</span>\r\n      <span class=\"token class-name\">BufferMgr</span> bm <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">bufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buff <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> \r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-----------------------------------------\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testfile\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testfile\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testfile\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testfile\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testfile\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-----------------------------------------\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-----------------------------------------\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testfile\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// repin</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-----------------------------------------\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-----------------------------------------\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testfile\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-----------------------------------------\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testfile\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// repin</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-----------------------------------------\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hit ratio: \"</span> <span class=\"token operator\">+</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">getHitRatio</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token constant\">LRU</span> 결과\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Unpinned</span> <span class=\"token class-name\">Buffers</span> in <span class=\"token constant\">LRU</span> order<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token number\">1</span> <span class=\"token number\">2</span> <span class=\"token number\">3</span> <span class=\"token number\">4</span> \r\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Unpinned</span> <span class=\"token class-name\">Buffers</span> in <span class=\"token constant\">LRU</span> order<span class=\"token operator\">:</span> \r\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Unpinned</span> <span class=\"token class-name\">Buffers</span> in <span class=\"token constant\">LRU</span> order<span class=\"token operator\">:</span> <span class=\"token number\">1</span> <span class=\"token number\">2</span> <span class=\"token number\">3</span> \r\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Unpinned</span> <span class=\"token class-name\">Buffers</span> in <span class=\"token constant\">LRU</span> order<span class=\"token operator\">:</span> <span class=\"token number\">2</span> <span class=\"token number\">3</span> \r\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Unpinned</span> <span class=\"token class-name\">Buffers</span> in <span class=\"token constant\">LRU</span> order<span class=\"token operator\">:</span> <span class=\"token number\">2</span> <span class=\"token number\">3</span> <span class=\"token number\">1</span> \r\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">20</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Unpinned</span> <span class=\"token class-name\">Buffers</span> in <span class=\"token constant\">LRU</span> order<span class=\"token operator\">:</span> <span class=\"token number\">3</span> <span class=\"token number\">1</span> \r\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">20</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Unpinned</span> <span class=\"token class-name\">Buffers</span> in <span class=\"token constant\">LRU</span> order<span class=\"token operator\">:</span> <span class=\"token number\">3</span> \r\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\r\nhit ratio<span class=\"token operator\">:</span> <span class=\"token number\">25.0</span></code></pre></div>\n<p>우선 최초의 pin 이전에는 모두 Unpinned Buffers에 있으며 Allocated Buffers에는 없는 것을 확인할 수있다. 최초pin이모두 끝나면 Allocated Buffers 에 전부 할당되며, Unpinned Buffers는 비어 있음을 확인 할 수 있다. 이후 unpin 된 순서대로 버퍼가 리스트에 쌓이며, 만약 그중에서 하나를 새로 pin하면 해당 버퍼는 리스트에 빠진다. 테스트에서는 block 11이 pin으로 리스트에서 빠졌다가 unpin으로 다시 맨 뒤에 추가된 모습이 보인다. 이때 새로운 block 20을 할당하면 가장 오래된 2번 버퍼가 교체되게 된다.2번 버퍼는 리스트에서 빠지고 새롭게 20을 할당 받는다. 따라서 최종적인 레퍼런스는 8번, hit은 block 11에 대해서 2번이므로 hit ratio: 25.0 이다.\r\nVanilla 결과</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> unpinned\r\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">20</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\r\n<span class=\"token class-name\">Allocated</span> <span class=\"token class-name\">Buffers</span><span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">20</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">-</span>\r\nhit ratio<span class=\"token operator\">:</span> <span class=\"token number\">12.5</span></code></pre></div>\n<p>바닐라의 경우, 위와 동일하지만 교체되는 버퍼가 Buffer 2가 아니라 Buffer 1이 된다. 언제 사용되었는지와 상관없이 1이 제일 앞에 있기 때문이다. 결국 LRU와 다르게 마지막 pin에서 block11 은 hit에 실패하고 Buffer 2를 교체하며. 새로 불러오게 된다. 따라서 따라서 최종적인 레퍼런스는 8번, hit은 block 11에 대해서 1번이므로 hit ratio: 12.5 이다. LRU와  Vanilla에서 차이를 확인가능하다.</p>\n<h2 id=\"source\" style=\"position:relative;\"><a href=\"#source\" aria-label=\"source permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Source</h2>\n<ul>\n<li>『SimpleDB: a simple java-based multiuser syst for teaching database internals』<br>\n<em>Edward Sciore - 지음</em><br>\n<a href=\"https://dl.acm.org/doi/10.1145/1227504.1227498\" target=\"_blank\" rel=\"nofollow\">https://dl.acm.org/doi/10.1145/1227504.1227498</a></li>\n</ul>","id":"612ab426-f442-5b24-bb6e-c032ba036fe2","tableOfContents":"<ul>\n<li>\n<p><a href=\"#1-simpledb%EB%9E%80-%EC%A3%BC%EC%9D%98-aws-simpledb%EC%95%84%EB%8B%98\">1. SimpleDB란? (주의! AWS SimpleDB아님)</a></p>\n</li>\n<li>\n<p><a href=\"#2-simpledb-%EC%8B%A4%ED%96%89-%EB%B0%A9%EB%B2%95-embedded-mode\">2. SimpleDB 실행 방법 (Embedded mode)</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%AA%A9%ED%91%9C-improving-buffer-manager-lru-midpoint-insertion-policy\">목표: Improving Buffer Manager (LRU, midpoint-insertion policy)</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B5%AC%ED%98%84-%EB%B0%8F-%ED%85%8C%EC%8A%A4%ED%8A%B8\">구현 및 테스트</a></p>\n<ul>\n<li><a href=\"#1-buffer-%ED%81%B4%EB%9E%98%EC%8A%A4-%ED%95%84%EC%88%98-%EA%B5%AC%ED%98%84-%ED%95%AD%EB%AA%A9\">1. Buffer 클래스 필수 구현 항목</a></li>\n<li><a href=\"#2-vanillabuffermgr-%ED%81%B4%EB%9E%98%EC%8A%A4-%ED%95%84%EC%88%98-%EA%B5%AC%ED%98%84-%ED%95%AD%EB%AA%A9\">2. VanillaBufferMgr 클래스 필수 구현 항목</a></li>\n<li><a href=\"#3-lrubuffermgr-%ED%95%84%EC%88%98-%EA%B5%AC%ED%98%84-%ED%95%AD%EB%AA%A9\">3. LRUBufferMgr 필수 구현 항목</a></li>\n<li><a href=\"#4-%ED%85%8C%EC%8A%A4%ED%8A%B8\">4. 테스트</a></li>\n<li><a href=\"#lrubuffermgr\">LRUBufferMgr</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#source\">Source</a></p>\n</li>\n</ul>","frontmatter":{"title":"Boston College SimpleDB 개선 과제 part 1","summary":"Edward Sciore의 Java 기반 SimpleDB 개선 과제를 수행합니다.","date":"2024.04.20.","categories":["DB","Java"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAUGBAn/xAAVAQEBAAAAAAAAAAAAAAAAAAAGA//aAAwDAQACEAMQAAAB5dK71kxCxZrFl//EABoQAAMAAwEAAAAAAAAAAAAAAAIDBAABEiL/2gAIAQEAAQUCYnT8UZBgUeTnAdlGmkTlX1//xAAfEQEAAQQBBQAAAAAAAAAAAAABIQACESIEEzFBUfD/2gAIAQMBAT8BOTaAItjiPS4HHnZnvCqyrR0EHaZ+mv/EACQRAAECBQIHAAAAAAAAAAAAAAECEQADBCExEkEiI0JhYnGB/9oACAECAQE/AZNJMWsEEBQsO+4c+OMYsMCJdHy0dXClzqWHLBywVb1t8j//xAAlEAABBAAEBgMAAAAAAAAAAAABAhESIQADMWEEEyIjQYEyUnH/2gAIAQEABj8CVwq1FObkMvhiXMSwcSQTzMrNuNSlH0/bWMtkuD0P7dthGT/K9Aau7dRN6k4SEuCnlmXlwhxq9AnTBK0iXQSoC1BaQWV9o+Hv8wrYtW2P/8QAGxABAQEAAwEBAAAAAAAAAAAAAREhADFBYVH/2gAIAQEAAT8hzeyRxMYOnaG5wEr4SDqFvwgn4zi8o2OwLSlVG53xYHCCVRsYRDmbbkJ4EBZH4S1XSKK76/QCYIVkMnP/2gAMAwEAAgADAAAAEP8A3//EABgRAQEBAQEAAAAAAAAAAAAAAAERITEA/9oACAEDAQE/ECjYmAsacA2L1LwKAMETlj3TM3ucMPf/xAAZEQEBAQEBAQAAAAAAAAAAAAABESExAEH/2gAIAQIBAT8Qj+hF+cbJRE5SMAeJViW62cJbWM4LF//EABgQAQEBAQEAAAAAAAAAAAAAAAERADEh/9oACAEBAAE/EEIExIAegWMzLWoimoFLOVIyggR0TAG4AAUG4YIQAAHMGSH1EVCDW20FqEW8d6vEjuRRCkFRgKzAAMAIG//Z"},"images":{"fallback":{"src":"/static/9b8be93c483a945adf8eeca2ec4bf692/d6c9d/common2.jpg","srcSet":"/static/9b8be93c483a945adf8eeca2ec4bf692/911a9/common2.jpg 1072w,\n/static/9b8be93c483a945adf8eeca2ec4bf692/5b411/common2.jpg 2144w,\n/static/9b8be93c483a945adf8eeca2ec4bf692/d6c9d/common2.jpg 4288w","sizes":"(min-width: 4288px) 4288px, 100vw"},"sources":[{"srcSet":"/static/9b8be93c483a945adf8eeca2ec4bf692/62671/common2.webp 1072w,\n/static/9b8be93c483a945adf8eeca2ec4bf692/18aba/common2.webp 2144w,\n/static/9b8be93c483a945adf8eeca2ec4bf692/85710/common2.webp 4288w","type":"image/webp","sizes":"(min-width: 4288px) 4288px, 100vw"}]},"width":4288,"height":2848}},"publicURL":"/static/9b8be93c483a945adf8eeca2ec4bf692/common2.jpg"}}}}]}},"pageContext":{"slug":"/db_hw1/"}},"staticQueryHashes":[]}