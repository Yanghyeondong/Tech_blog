{"componentChunkName":"component---src-templates-post-template-tsx","path":"/drf-error-collection/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p><em>해당 글은 과거 <strong>velog</strong>에 쓴 글을 다듬어서 이전한 글입니다. 원본은 <a href=\"https://velog.io/@hdyang0686/DRF-%EB%82%9C%EC%A4%91%EC%9D%BC%EA%B8%B0\" target=\"_blank\" rel=\"nofollow\"><strong>링크1</strong></a>, <a href=\"https://velog.io/@hdyang0686/DRF-%EB%82%9C%EC%A4%91%EC%9D%BC%EA%B8%B0-2\" target=\"_blank\" rel=\"nofollow\"><strong>링크2</strong></a>를 참조하시기 바랍니다.</em><br>\n<br>\n이번 글에선 DRF를 사용하며 겪었던 여러 오류들을 정리해보려 합니다.<br>\n<del>여러분은 저처럼 삽질하지 맙시다</del></p>\n<h2 id=\"1-nested-serializers의-requiredfalse-설정\" style=\"position:relative;\"><a href=\"#1-nested-serializers%EC%9D%98-requiredfalse-%EC%84%A4%EC%A0%95\" aria-label=\"1 nested serializers의 requiredfalse 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Nested serializers의 required=False 설정</h2>\n<p>보통 DRF에서 모델을 작성한 후, required를 설정하면 다음처럼 적용하게 됩니다.</p>\n<p><strong>models.py</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Mentoring</span><span class=\"token punctuation\">(</span>AbstractTimeStampModel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    thumbnail<span class=\"token operator\">=</span>models<span class=\"token punctuation\">.</span>ImageField<span class=\"token punctuation\">(</span>null<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> blank<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>serializers.py</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">extra_kwargs <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'thumbnail'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'required'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>하지만 Nested serializers(외부 앱)를 적용하면 얘기가 달라집니다.\n꼭 다음과 같이 extra_kwargs에 넣지 말고 따로 작성해서 삽질하는 일이 없도록 합시다.</p>\n<p><strong>models.py</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Mentoring</span><span class=\"token punctuation\">(</span>AbstractTimeStampModel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    tags<span class=\"token operator\">=</span>models<span class=\"token punctuation\">.</span>ManyToManyField<span class=\"token punctuation\">(</span>Tag<span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>serializers.py</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MentoringSerializer</span><span class=\"token punctuation\">(</span>serializers<span class=\"token punctuation\">.</span>HyperlinkedModelSerializer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    tags <span class=\"token operator\">=</span> TagSerializer<span class=\"token punctuation\">(</span>required<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"2--with-this-name-already-exists\" style=\"position:relative;\"><a href=\"#2--with-this-name-already-exists\" aria-label=\"2  with this name already exists permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. ~ with this name already exists.</h2>\n<p><strong>serializers.py(mentoring)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MentoringSerializer</span><span class=\"token punctuation\">(</span>serializers<span class=\"token punctuation\">.</span>HyperlinkedModelSerializer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    tags <span class=\"token operator\">=</span> TagSerializer<span class=\"token punctuation\">(</span>many<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> validated_data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        tags_data<span class=\"token operator\">=</span>validated_data<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n        <span class=\"token keyword\">for</span> tag_data <span class=\"token keyword\">in</span> tags_data<span class=\"token punctuation\">:</span>\n            tag<span class=\"token punctuation\">,</span> created<span class=\"token operator\">=</span> Tag<span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span>get_or_create<span class=\"token punctuation\">(</span><span class=\"token operator\">**</span>tag_data<span class=\"token punctuation\">)</span>\n            mentoring<span class=\"token punctuation\">.</span>tags<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>tag<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> mentoring</code></pre></div>\n<p><strong>models.py(tag)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Tag</span><span class=\"token punctuation\">(</span>AbstractTimeStampModel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    name<span class=\"token operator\">=</span>models<span class=\"token punctuation\">.</span>CharField<span class=\"token punctuation\">(</span>max_length<span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> unique<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>위의 코드는 metoring 모델의 serializers에서 tag라는 nested serializers 를 불러와 외래 키로써 사용하는 예시입니다. 여기서 만약 tag의 name이 원래 있던 것과 중복된다면, <code class=\"language-text\">tag, created= Tag.objects.get_or_create(**tag_data)</code> 를 쓰기도 전에 <code class=\"language-text\">def create(self, validated_data):</code> 에서 막혀버립니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">HTTP<span class=\"token operator\">/</span><span class=\"token number\">1.1</span> <span class=\"token number\">400</span> Bad Request\nDate<span class=\"token punctuation\">:</span> Sun<span class=\"token punctuation\">,</span> <span class=\"token number\">03</span> Oct <span class=\"token number\">2021</span> <span class=\"token number\">07</span><span class=\"token punctuation\">:</span><span class=\"token number\">06</span><span class=\"token punctuation\">:</span><span class=\"token number\">07</span> GMT\nServer<span class=\"token punctuation\">:</span> WSGIServer<span class=\"token operator\">/</span><span class=\"token number\">0.2</span> CPython<span class=\"token operator\">/</span><span class=\"token number\">3.9</span><span class=\"token number\">.6</span>\nContent<span class=\"token operator\">-</span>Type<span class=\"token punctuation\">:</span> application<span class=\"token operator\">/</span>json\nVary<span class=\"token punctuation\">:</span> Accept\nAllow<span class=\"token punctuation\">:</span> GET<span class=\"token punctuation\">,</span> POST<span class=\"token punctuation\">,</span> HEAD<span class=\"token punctuation\">,</span> OPTIONS\nX<span class=\"token operator\">-</span>Frame<span class=\"token operator\">-</span>Options<span class=\"token punctuation\">:</span> DENY\nContent<span class=\"token operator\">-</span>Length<span class=\"token punctuation\">:</span> <span class=\"token number\">58</span>\nX<span class=\"token operator\">-</span>Content<span class=\"token operator\">-</span>Type<span class=\"token operator\">-</span>Options<span class=\"token punctuation\">:</span> nosniff\nReferrer<span class=\"token operator\">-</span>Policy<span class=\"token punctuation\">:</span> same<span class=\"token operator\">-</span>origin\n<span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"tags\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"tag with this name already exists.\"</span>\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이를 해결하기 위해서는 tag의 <code class=\"language-text\">validated_data</code> 과정에서 예외를 처리해주면 됩니다.<br>\n<strong>serializers.py(tag)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">TagSerializer</span><span class=\"token punctuation\">(</span>serializers<span class=\"token punctuation\">.</span>HyperlinkedModelSerializer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">class</span> <span class=\"token class-name\">Meta</span><span class=\"token punctuation\">:</span>\n        model <span class=\"token operator\">=</span> Tag\n        fields <span class=\"token operator\">=</span> <span class=\"token string\">'__all__'</span>\n        read_only_fields <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        extra_kwargs <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">'name'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'validators'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"3-슬래시--와-301-moved-permanently\" style=\"position:relative;\"><a href=\"#3-%EC%8A%AC%EB%9E%98%EC%8B%9C--%EC%99%80-301-moved-permanently\" aria-label=\"3 슬래시  와 301 moved permanently permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 슬래시 / 와 301 Moved Permanently</h2>\n<p>Django에서 라우트 설정을 하다 보면 / 를 넣을지 말지 고민하는 경우가 있습니다. 각 경우에 대해 나타나는 현상을 정리하면 다음과 같습니다.</p>\n<p><strong>(1) / 를 빼는 경우</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">from</span> django<span class=\"token punctuation\">.</span>urls <span class=\"token keyword\">import</span> path<span class=\"token punctuation\">,</span> include\n<span class=\"token keyword\">from</span> <span class=\"token punctuation\">.</span>views <span class=\"token keyword\">import</span>  LogoutAPI<span class=\"token punctuation\">,</span> RegistrationAPI<span class=\"token punctuation\">,</span> LoginAPI<span class=\"token punctuation\">,</span> UserAPI\nurlpatterns <span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>\n    path<span class=\"token punctuation\">(</span><span class=\"token string\">\"register\"</span><span class=\"token punctuation\">,</span> RegistrationAPI<span class=\"token punctuation\">.</span>as_view<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    path<span class=\"token punctuation\">(</span><span class=\"token string\">\"login\"</span><span class=\"token punctuation\">,</span> LoginAPI<span class=\"token punctuation\">.</span>as_view<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    path<span class=\"token punctuation\">(</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">,</span> UserAPI<span class=\"token punctuation\">.</span>as_view<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    path<span class=\"token punctuation\">(</span><span class=\"token string\">\"logout\"</span><span class=\"token punctuation\">,</span> LogoutAPI<span class=\"token punctuation\">.</span>as_view<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>auth/register 로 접근 시 => <strong>정상 접속</strong><br>\nauth/register/ 로 접근 시 => <strong>404 에러</strong><br>\n<br>\n<strong>(2) / 를 넣는 경우</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">from</span> django<span class=\"token punctuation\">.</span>urls <span class=\"token keyword\">import</span> path<span class=\"token punctuation\">,</span> include\n<span class=\"token keyword\">from</span> <span class=\"token punctuation\">.</span>views <span class=\"token keyword\">import</span>  LogoutAPI<span class=\"token punctuation\">,</span> RegistrationAPI<span class=\"token punctuation\">,</span> LoginAPI<span class=\"token punctuation\">,</span> UserAPI\nurlpatterns <span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>\n    path<span class=\"token punctuation\">(</span><span class=\"token string\">\"register\"</span><span class=\"token punctuation\">,</span> RegistrationAPI<span class=\"token punctuation\">.</span>as_view<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    path<span class=\"token punctuation\">(</span><span class=\"token string\">\"login\"</span><span class=\"token punctuation\">,</span> LoginAPI<span class=\"token punctuation\">.</span>as_view<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    path<span class=\"token punctuation\">(</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">,</span> UserAPI<span class=\"token punctuation\">.</span>as_view<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    path<span class=\"token punctuation\">(</span><span class=\"token string\">\"logout\"</span><span class=\"token punctuation\">,</span> LogoutAPI<span class=\"token punctuation\">.</span>as_view<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>auth/register 로 접근 시 -> <strong>301 에러</strong><br>\nauth/register/ 로 접근 시 -> <strong>정상 접속</strong><br>\n<br>\n(2)에서 301 Moved Permanently 에러가 나는 이유는 장고가 자체적으로 / 가 없는 주소를 / 가 있는 주소로 리다이렉트 하면서 발생하는 것입니다.</p>\n<p>결론적으로, / 를 붙이는 것은 하나로 통일하여 미연에 에러를 방지하는 것이 좋습니다.</p>\n<h2 id=\"4-drf--heroku-static-설정-오류\" style=\"position:relative;\"><a href=\"#4-drf--heroku-static-%EC%84%A4%EC%A0%95-%EC%98%A4%EB%A5%98\" aria-label=\"4 drf  heroku static 설정 오류 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. DRF + Heroku static 설정 오류</h2>\n<p>DRF를 Heroku에 올린 후 따로 설정을 하지 않으면 이미지나 CSS 같은 static 파일에 오류가 생겨 페이지가 제대로 뜨지 않습니다. 이때 다음과 같은 설정을 해줍시다.</p>\n<p><strong>setings.py</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">STATIC_ROOT <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>BASE_DIR<span class=\"token punctuation\">,</span> <span class=\"token string\">'staticfiles'</span><span class=\"token punctuation\">)</span>\nSTATIC_URL <span class=\"token operator\">=</span> <span class=\"token string\">'/static/'</span>\n\n<span class=\"token comment\"># Extra places for collectstatic to find static files.</span>\nSTATICFILES_DIRS <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n    os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>BASE_DIR<span class=\"token punctuation\">,</span> <span class=\"token string\">'static'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>그리고 한 가지 더 중요한 점은 다음과 같은 명령어를 쳐주는 것입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">python manage<span class=\"token punctuation\">.</span>py collectstatic</code></pre></div>\n<p>여기서 만약 오류가 난다면, <strong>staticfiles</strong> 이나 <strong>static</strong> 폴더를 미리 만들어 놓고 다시 한번 명령어를 쳐보면 됩니다.</p>\n<h2 id=\"5-drf-media-file-serving-오류\" style=\"position:relative;\"><a href=\"#5-drf-media-file-serving-%EC%98%A4%EB%A5%98\" aria-label=\"5 drf media file serving 오류 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. DRF media file serving 오류</h2>\n<p>DRF에서 media 파일을 저장/서빙하기 위해서는 다음과 같이 설정해줍니다.</p>\n<p><strong>setings.py</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">MEDIA_URL <span class=\"token operator\">=</span> <span class=\"token string\">'/media/'</span>\nMEDIA_ROOT <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>BASE_DIR<span class=\"token punctuation\">,</span> <span class=\"token string\">'media'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>urls.py</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">urlpatterns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    path<span class=\"token punctuation\">(</span><span class=\"token string\">'api-auth/'</span><span class=\"token punctuation\">,</span> include<span class=\"token punctuation\">(</span><span class=\"token string\">'rest_framework.urls'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    path<span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> include<span class=\"token punctuation\">(</span>router<span class=\"token punctuation\">.</span>urls<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    path<span class=\"token punctuation\">(</span><span class=\"token string\">'auth/'</span><span class=\"token punctuation\">,</span> include<span class=\"token punctuation\">(</span><span class=\"token string\">'accounts.urls'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> static<span class=\"token punctuation\">(</span>settings<span class=\"token punctuation\">.</span>MEDIA_URL<span class=\"token punctuation\">,</span> document_root<span class=\"token operator\">=</span>settings<span class=\"token punctuation\">.</span>MEDIA_ROOT<span class=\"token punctuation\">)</span></code></pre></div>\n<p>하지만 위의 설정만 하면 파일이 저장은 되지만 서빙이 되지 않습니다.</p>\n<p>답은 간단합니다. 디버그 모드를 켜주면 됩니다.\n<del>이거 하나 때문에…</del></p>\n<p><strong>setings.py</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">DEBUG <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span></code></pre></div>\n<p>단, 추후 제대로 웹사이트를 운영하기 위해서는 디버그가 끝난 후 제대로 빌드해서 파일을 적용시켜줘야 합니다.</p>\n<h2 id=\"source\" style=\"position:relative;\"><a href=\"#source\" aria-label=\"source permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Source</h2>\n<ul>\n<li>깃허브 프로젝트 주소<br>\n<a href=\"https://github.com/Yanghyeondong/web_Guntor-Guntee_EarlyFried\" target=\"_blank\" rel=\"nofollow\">https://github.com/Yanghyeondong/web_Guntor-Guntee_EarlyFried</a></li>\n</ul>","id":"f16cdcf7-b803-55e7-a3ca-9724de951bf4","tableOfContents":"<ul>\n<li><a href=\"#1-nested-serializers%EC%9D%98-requiredfalse-%EC%84%A4%EC%A0%95\">1. Nested serializers의 required=False 설정</a></li>\n<li><a href=\"#2--with-this-name-already-exists\">2. ~ with this name already exists.</a></li>\n<li><a href=\"#3-%EC%8A%AC%EB%9E%98%EC%8B%9C--%EC%99%80-301-moved-permanently\">3. 슬래시 / 와 301 Moved Permanently</a></li>\n<li><a href=\"#4-drf--heroku-static-%EC%84%A4%EC%A0%95-%EC%98%A4%EB%A5%98\">4. DRF + Heroku static 설정 오류</a></li>\n<li><a href=\"#5-drf-media-file-serving-%EC%98%A4%EB%A5%98\">5. DRF media file serving 오류</a></li>\n<li><a href=\"#source\">Source</a></li>\n</ul>","frontmatter":{"title":"[velog 이전] DRF 에러 해결 모음집","summary":"DRF 에러 중 Heroku static, media file serving, Nested serializers, name already exists, Moved Permanently 등에 대해 알아본다","date":"2021.10.11.","categories":["Web","Back-end"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADJklEQVQozyXFWUzbBQDA4X+ixheNMca4JTNjG8yBwIQWCrT0TA+OAu1aejigLdIChUrbAa5dy1xDC7h1g8KYq+HYxHQJ0zFYpiEaTUyMbg9uhrdp4sOSaaIuc3FbN/2Z6PfyCb/99BX37vzAg7s/8+j+r+T/+p2/8w/+/9E9fryWYylhZWrEwoBLx/iwmVzaxfxRB5G+FqL+Fka8RnwOPbZmJcLdO1s8yf9JPv+Qx08e8w/wx+0bbH0+za1vFtg8P0L6nQPYjHJMBhm11ftxtSuZG3MSHzSRGraQGXMwE7MTH2xDuPntp9zaus5/Hv7C/dvfcW0txdbGGDfWYmzMeTnsM5AY6uT7tVnG/e2UFe8hHXWSHXezOPUWK6f6WD3t59xxD8K5xRTl9WJcficOl4FmUw1ynQhbpx6zXUmrWcZwdyOTwU7Oxns51mOmp1XB8ok+1rMB1heCXDgdYGNxmM2VCEKfW8cL5a/R4nZSopaxS1rFLqmInbWVFNSJebG0EL9TRy7Zy1i/g9GDemLuZr6+PM31z6ZZnfCyEO/iQibEaiaM4LCp6AwOcGXzKtmVJXKXVkll0qxvXiWzcIZydS0TR7rxmBVoJJXUlBZh0UpYTgbJHQ9ycXaERLiDsNfC8slDCIFQJ0/v3oHcYuSNBhXbRCVITQ24QgMU1ot5bu8OLq68x7ujvdj1Mhrrxdi01VzOREnYtFyZ6OVMcoBkxMOJo16E+dkYbQebsHQ1YTCpsHYYKZNWUKWppkIpol5bw5efzBELeRCEZ3nqmecRFewk62vlfLSDpSMulo55yc1HuPRhAmHjo0mSER+T8X6WJkPcXJvh/VSIUzE/y9OHGY8NEQ92E+4yYlVUs/uVbTRVvE7UpKZXL6XPKKfHqGCq30J2MoAQebuDYLeVuvJiWtW1+ByNeOxNtKkkVJUUUbB9O7FgD1/MD/FxvJ1DJgUeVR0BrYyURcPMmzrSTg1pu4IpuwZBVFbMBydHcTYp2Ve4B3FFKZVl+2gxyNEqJPjdB4gPdXF2sIHcqJGVcBtjDjXDLTIkewt59aWXqS8pwlS3H2tNGf8CUbcAKzR8gCoAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/20802949b7902fb8572790a8f98db762/64c0c/main.png","srcSet":"/static/20802949b7902fb8572790a8f98db762/2c2b3/main.png 288w,\n/static/20802949b7902fb8572790a8f98db762/3458c/main.png 576w,\n/static/20802949b7902fb8572790a8f98db762/64c0c/main.png 1152w","sizes":"(min-width: 1152px) 1152px, 100vw"},"sources":[{"srcSet":"/static/20802949b7902fb8572790a8f98db762/30e6b/main.webp 288w,\n/static/20802949b7902fb8572790a8f98db762/87340/main.webp 576w,\n/static/20802949b7902fb8572790a8f98db762/294e1/main.webp 1152w","type":"image/webp","sizes":"(min-width: 1152px) 1152px, 100vw"}]},"width":1152,"height":640}},"publicURL":"/static/20802949b7902fb8572790a8f98db762/main.png"}}}}]}},"pageContext":{"slug":"/drf-error-collection/"}},"staticQueryHashes":[]}