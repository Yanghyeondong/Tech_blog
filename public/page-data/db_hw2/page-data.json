{"componentChunkName":"component---src-templates-post-template-tsx","path":"/db_hw2/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p>이전 포스트 Boston College SimpleDB 개선 과제 part 1에서 이어집니다!</p>\n<h4 id=\"simpledb란-주의-aws-simpledb아님\" style=\"position:relative;\"><a href=\"#simpledb%EB%9E%80-%EC%A3%BC%EC%9D%98-aws-simpledb%EC%95%84%EB%8B%98\" aria-label=\"simpledb란 주의 aws simpledb아님 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SimpleDB란? (주의! AWS SimpleDB아님)</h4>\n<p>Boston College의 Edward Sciore 교수님이 논문으로 발표한 Java 기반의 다중 사용자 DB.<br>\n<a href=\"https://dl.acm.org/doi/10.1145/1227504.1227498\" target=\"_blank\" rel=\"nofollow\">SimpleDB: a simple java-based multiuser syst for teaching database internals</a></p>\n<h2 id=\"목표-midpoint-insertion-policy를-simpledb에-적용해-보자\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C-midpoint-insertion-policy%EB%A5%BC-simpledb%EC%97%90-%EC%A0%81%EC%9A%A9%ED%95%B4-%EB%B3%B4%EC%9E%90\" aria-label=\"목표 midpoint insertion policy를 simpledb에 적용해 보자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목표: midpoint-insertion policy를 SimpleDB에 적용해 보자.</h2>\n<ul>\n<li>midpoint insertion은 MySQL InnoDB에 적용되어 있는 버퍼 정책입니다.</li>\n<li>디스크에서 페이지를 읽어 버퍼 풀로 들여올 때, 리스트의 중간 부분(midpoint)에 페이지를 삽입하는 방식입니다.</li>\n<li>read-ahead page, large scan(full table/index scan) 등으로 읽혀진 page들이 빨리 aged out 된다는 장점이 있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 347px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/63ba38717acd3551956626f112b356d9/c8500/001.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 161.97916666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAgCAIAAACdAM/hAAAACXBIWXMAAAsTAAALEwEAmpwYAAADIElEQVQ4y52VTY/bNhCG9/9fc+kvKNBFgva0LdAeckgC7LapY1v+jO2VZFmyJFIih+TwQ1o5kLQxNo433nYwEAiCDzmceUe8qqrq4VtrmsZ0Vjlnjanr6nA4VFXlupnKOSFEXdfW2qvKucN3pqQsAAZJOqXlh9Xm5vbuzg89UkwzIlEVlFprlVLnYY0ISnlptqDFv0H49tNwGEUzQpeEoNFGa2PMs7BSymhUwFBwg6KyWiuBwLQE22EXYI2K81IILoABLwFYOxbcaK0QL8PASyn4iRujX3Sy+AorCT+C+9Rba7XWdV0/PRmAlQURwJ6FpVKz2SwIAm8yybIMhMAORiX2ye7vu1tW0v78/xz2yZ31Samapum19fDw8H3CjjF3sGGc/59sKwGIKggCQkgcxy+o8xOXEpSSq/U6TdNot2vhpgu7aZoObI4KQ9FKSkswSvQDLdtE+r6fpunuzMndDqgUKDmKo3GyG0bhP+vVKI5GcbTMUxCwXC79ILj3/Stn7WQyGY5G976vpMjTJM/3KNW+LF5PvV8Xs2tv9NNff76Zeq/n0z9WS5ByF0UgRFEULTyfzweDwWq9FsB3Wz+JQyVlCdxLs2lOBlF0u94M43iS5QtCtDXWWuec1vo07L5giKqUcrDPpiX/sNr89u79XbD1CjYhVCKeEUmP9Wlrs62RsZLxkgsQSnLgJStAcGsvtiRirzAlOEpoFdkWufVOnt+2ZFVV2yiK4zgIQ4UIAEdtU5JNvDFnxbParus67yxOEmOMlO3VOC+lBErz1WrZCkZ2P4PLjdGFLYGhBK2EM4gSen9hVyEpC8Jap8AIK3JGS2CXE6YRc+C/TMZvFvOfPw1e/X5z7Y2vZ9Obz0up21r9CEZEJmCcxN4+GSe7j/ebcRKP98kiS40xzjkAYIydh4+N3da/rrSAx7Z5bJ5DX6Dz8HGLw+EgBPj3K2tM89g1L4O/Pj2wCzfO2ZP5y3CSJNtoG4ZhEAS0KE5h51z/OB7jfGqMsTzPKaXRdss5f7qmhY9v6n6/70WWZRkhpP8SQiileZ4DAKW0X0MISZIEAL4Ai2ElWlkjtrIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/63ba38717acd3551956626f112b356d9/a59e9/001.webp 192w,\n/static/63ba38717acd3551956626f112b356d9/8f955/001.webp 347w\"\n              sizes=\"(max-width: 347px) 100vw, 347px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/63ba38717acd3551956626f112b356d9/3b721/001.png 192w,\n/static/63ba38717acd3551956626f112b356d9/c8500/001.png 347w\"\n            sizes=\"(max-width: 347px) 100vw, 347px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/63ba38717acd3551956626f112b356d9/c8500/001.png\"\n            alt=\".\"\n            title=\".\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"구현-및-테스트\" style=\"position:relative;\"><a href=\"#%EA%B5%AC%ED%98%84-%EB%B0%8F-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"구현 및 테스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>구현 및 테스트</h2>\n<h4 id=\"free-buffer-list-allocated-buffer-lru-list-기타-변수-선언-및-초기화\" style=\"position:relative;\"><a href=\"#free-buffer-list-allocated-buffer-lru-list-%EA%B8%B0%ED%83%80-%EB%B3%80%EC%88%98-%EC%84%A0%EC%96%B8-%EB%B0%8F-%EC%B4%88%EA%B8%B0%ED%99%94\" aria-label=\"free buffer list allocated buffer lru list 기타 변수 선언 및 초기화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Free buffer list, Allocated Buffer, LRU list, 기타 변수 선언 및 초기화</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MidInsBufferMgr</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">BufferMgr</span> <span class=\"token punctuation\">{</span>\r\n   <span class=\"token keyword\">private</span> <span class=\"token class-name\">LinkedList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">></span></span> free_list<span class=\"token punctuation\">;</span>\r\n   <span class=\"token keyword\">private</span> <span class=\"token class-name\">LinkedList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">></span></span> lru_list<span class=\"token punctuation\">;</span>\r\n   <span class=\"token keyword\">private</span> <span class=\"token class-name\">HashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">></span></span> alloc_buffer<span class=\"token punctuation\">;</span>\r\n   <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> buff_size<span class=\"token punctuation\">;</span>\r\n   <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> hit_cnt<span class=\"token punctuation\">;</span>\r\n   <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> reference_cnt<span class=\"token punctuation\">;</span>\r\n   <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">long</span> <span class=\"token constant\">MAX_TIME</span> <span class=\"token operator\">=</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">MidInsBufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FileMgr</span> fm<span class=\"token punctuation\">,</span> <span class=\"token class-name\">LogMgr</span> lm<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> numbuffs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      buff_size <span class=\"token operator\">=</span> numbuffs<span class=\"token punctuation\">;</span>\r\n      hit_cnt <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n      reference_cnt <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n      free_list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LinkedList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      lru_list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LinkedList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      alloc_buffer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>buff_size<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n         free_list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">(</span>fm<span class=\"token punctuation\">,</span> lm<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      \r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>과제 명세 설명 “LRU list는 doubly linked list로 구현한다.”에 따라 lru_list 는 java의 LinkedList로 구현하였다. 자바 공식홈페이지에 “Doubly-linked list implementation…” 로 설명되어있는 클래스이다. <code class=\"language-text\">free_list</code>의 경우에도 편의를 위해 LinkedList로 구현하였다. 과제 명세 설명 “버퍼풀 초기화 시  버퍼들을 <code class=\"language-text\">numbuff</code>만큼 생성, <code class=\"language-text\">free list</code>에 삽입”에 따라 <code class=\"language-text\">free_list.add </code>를 진행하였다. <code class=\"language-text\">alloc_buffer</code>는 이전 과제와 동일하게 <code class=\"language-text\">HashMap</code>으로 구현하였다. <code class=\"language-text\">hit_cnt</code>, <code class=\"language-text\">reference_cnt</code>은 hit ratio를 구하기위해 사용하며 <code class=\"language-text\">MAX_TIME</code>은 pin에서 시간 초과를 확인하기위해 사용한다.</p>\n<h4 id=\"lru-midpoint-insertion-기능-구현\" style=\"position:relative;\"><a href=\"#lru-midpoint-insertion-%EA%B8%B0%EB%8A%A5-%EA%B5%AC%ED%98%84\" aria-label=\"lru midpoint insertion 기능 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>LRU MidPoint Insertion 기능 구현</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">midIns</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Buffer</span> buff<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">int</span> size <span class=\"token operator\">=</span> lru_list<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>size <span class=\"token operator\">&lt;=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n         lru_list<span class=\"token punctuation\">.</span><span class=\"token function\">addFirst</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\r\n         <span class=\"token keyword\">int</span> pos <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>size <span class=\"token operator\">*</span> <span class=\"token number\">5</span> <span class=\"token operator\">/</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n         lru_list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>pos<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>과제 명세내용에 따라 LRU list 길이가 3이하면 LRU head로 삽입하고, 아닌 경우에는 LRU list의 head에서 5/8 지점에 페이지를 삽입하도록 하였다. “(현재 LRU list 길이 * 5/8) 의 다음 노드로 삽입” 라는 설명에따라 <code class=\"language-text\">pos = (size * 5 / 8) + 1</code> 을 하였다. 소숫점일 경우 나누기에 의해 int 부분이 절사 된다. 리스트에 집어넣을때는 <code class=\"language-text\">lru_list.add(pos-1, buff)</code> 를 하는데, pos-1인 이유는 리스트에서 첫번째를 0이 아닌 1로봐야 하기때문이다.</p>\n<h4 id=\"available-기능-구현\" style=\"position:relative;\"><a href=\"#available-%EA%B8%B0%EB%8A%A5-%EA%B5%AC%ED%98%84\" aria-label=\"available 기능 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>available() 기능 구현</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token keyword\">int</span> <span class=\"token function\">available</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">int</span> freenum <span class=\"token operator\">=</span> free_list<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">int</span> unpinnum <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">:</span> lru_list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">isPinned</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> unpinnum <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">return</span> freenum <span class=\"token operator\">+</span> unpinnum<span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>과제 설명 “Free list의 버퍼 개수와 unpin된 버퍼 개수를 합한 값” 을 구하기 위해 <code class=\"language-text\">free_list.size()</code> 값을 구하고 lru_list 내 <code class=\"language-text\">!buff.isPinned()</code> 인 경우의 개수를 누적하여 합을 리턴한다.</p>\n<h4 id=\"touch-함수-구현\" style=\"position:relative;\"><a href=\"#touch-%ED%95%A8%EC%88%98-%EA%B5%AC%ED%98%84\" aria-label=\"touch 함수 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>touch() 함수 구현</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">touch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Buffer</span> buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">Boolean</span> valid <span class=\"token operator\">=</span> lru_list<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>valid<span class=\"token punctuation\">)</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"touch error!!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      lru_list<span class=\"token punctuation\">.</span><span class=\"token function\">addFirst</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>과제 명세 설명에 따르면 LRU list에 있는 buffer가 hit되었을 때 (= hash map에 해당 buffer가 존재할 때) buffer를 new sublist의 head로 보낸다. 즉, pin이 되면 맨 앞으로 옮겨진다. 따라서 해당 동작을 touch라는 함수로 따로 구현하였다. <code class=\"language-text\">lru_list.remove(buff)</code>을 통해 요청 받은 버퍼를 지우고, <code class=\"language-text\">lru_list.addFirst(buff)</code>을 통해 맨앞에 넣게된다. 만약 없을경우 에러 메세지를 출력한다.</p>\n<h4 id=\"waitingtoolong-설정\" style=\"position:relative;\"><a href=\"#waitingtoolong-%EC%84%A4%EC%A0%95\" aria-label=\"waitingtoolong 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>waitingTooLong() 설정</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">waitingTooLong</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> starttime<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">return</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> starttime <span class=\"token operator\">></span> <span class=\"token constant\">MAX_TIME</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>exception 관련 코드도 구현하라는 공지에따라 vanilla의 코드를 그대로 가져왔다.</p>\n<h4 id=\"pin-구현\" style=\"position:relative;\"><a href=\"#pin-%EA%B5%AC%ED%98%84\" aria-label=\"pin 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>pin() 구현</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token class-name\">Buffer</span> <span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BlockId</span> blk<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n         <span class=\"token keyword\">long</span> timestamp <span class=\"token operator\">=</span> <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">currentTimeMillis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> <span class=\"token function\">tryToPin</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token function\">waitingTooLong</span><span class=\"token punctuation\">(</span>timestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token function\">wait</span><span class=\"token punctuation\">(</span><span class=\"token constant\">MAX_TIME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            buff <span class=\"token operator\">=</span> <span class=\"token function\">tryToPin</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token punctuation\">}</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BufferAbortException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>reference_cnt<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\r\n         <span class=\"token keyword\">return</span> buff<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">InterruptedException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n         <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BufferAbortException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>pin()함수의 경우 이전 과제와 크게다르지 않다. 대부분다 동일하며, reference_cnt를 늘려주는 부분이 따로 존재한다.</p>\n<h4 id=\"trytopin-구현\" style=\"position:relative;\"><a href=\"#trytopin-%EA%B5%AC%ED%98%84\" aria-label=\"trytopin 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>tryToPin() 구현</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token class-name\">Buffer</span> <span class=\"token function\">tryToPin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BlockId</span> blk<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> <span class=\"token function\">findExistingBuffer</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// not find in lru list(alloc_buffer)</span>\r\n         buff <span class=\"token operator\">=</span> <span class=\"token function\">chooseFreeBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n         alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">block</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         buff<span class=\"token punctuation\">.</span><span class=\"token function\">assignToBlock</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token function\">midIns</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">,</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// find in lru list(alloc_buffer)</span>\r\n         hit_cnt<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token function\">touch</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \r\n      <span class=\"token punctuation\">}</span>\r\n      buff<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">return</span> buff<span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>trypin()의 경우, 이전과 달라진 점이 있다. <code class=\"language-text\">findExistingBuffer()</code>에 실패해서 새로운 버퍼를 <code class=\"language-text\">chooseFreeBuffer()</code>로 할당받을 경우, 과제 설명 “(첫번째로 reference되는 페이지일 경우) block id를 해당 버퍼에 할당, LRU list에 삽입. midpoint Insertion 로직에 따라 LRU list내 위치 조정” 에 따른 일련의 과정을 수행한다. 우선 alloc_buffer.remove를 통해 현재 할당된 맵에서 해당 버퍼를 지우고, <code class=\"language-text\">buff.assignToBlock(blk)</code>를 통해 주어진 blk로 초기화하게 된다. 이후 앞서 소개한 <code class=\"language-text\">midIns()</code>를 통해서 해당 버퍼를 집어넣게된다. 또한,  findExistingBuffer(blk)에 성공했을때는 buffer가 hit되었을 때를 의미하므로 hit_cnt를 증가시켜주고 앞서 설명한 <code class=\"language-text\">touch()</code>를 수행하게 된다. <code class=\"language-text\">buff.pin()</code>을 통해 pin 값도 늘려준다.</p>\n<h4 id=\"findexistingbuffer-구현\" style=\"position:relative;\"><a href=\"#findexistingbuffer-%EA%B5%AC%ED%98%84\" aria-label=\"findexistingbuffer 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>findExistingBuffer() 구현</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token class-name\">Buffer</span> <span class=\"token function\">findExistingBuffer</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BlockId</span> blk<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">containsKey</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n         <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>blk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">return</span> buff<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>해당 함수의 경우에는 저번 과제와 크게 달라진점이 없다. 버퍼에 대해 “Must keyed on the block” 를 만족하는 alloc_buffer를 항상 유지하면서, <code class=\"language-text\">alloc_buffer.containsKey</code>를 통해 Map으로 블럭이 버퍼 안에 있는지 판별한다. 만약 있을경우, 해당 버퍼를 찾아서 리턴한다.</p>\n<h4 id=\"choosefreebuffer\" style=\"position:relative;\"><a href=\"#choosefreebuffer\" aria-label=\"choosefreebuffer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>chooseFreeBuffer()</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token class-name\">Buffer</span> <span class=\"token function\">chooseFreeBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\r\n      <span class=\"token keyword\">int</span> size <span class=\"token operator\">=</span> free_list<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>size <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n         <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> free_list<span class=\"token punctuation\">.</span><span class=\"token function\">poll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">return</span> buff<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\r\n         <span class=\"token keyword\">int</span> lru_size <span class=\"token operator\">=</span> lru_list<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>lru_size <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\r\n         <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span> lru_size <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">>=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">=</span> lru_list<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">isPinned</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n               buff<span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n               lru_list<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n               <span class=\"token keyword\">return</span> buff<span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n         <span class=\"token punctuation\">}</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">chooseFreeBuffer()</code>의 경우 새롭게 추가된 부분이다. 우선 공지 설명 “pin 메소드 호출 시 버퍼를 free list로부터 할당받음. 버퍼가 필요할 때 free buffer list의 head에서 버퍼를 제거 후 사용한다.”에 따라 우선 free_list의 크기가 0 이상이라면 제일 앞 버퍼를 poll()을 통해 뽑아낸다. 혹시 free list에 없다면, 설명 “더 이상 free list에서 버퍼를 가져올 수 없을 때는, LRU list의 tail부터 탐색하여 첫번째 unpin된 버퍼를 flush 후, 해당 버퍼를 그대로 사용” 에 따른다. 즉, lru_list를 뒤에서부터 순회하며 !buff.isPinned() 을 만족하는 버퍼를 찾는순간 리스트에서 지워주고 flush한 다음 리턴해주게 된다.</p>\n<h4 id=\"unpin\" style=\"position:relative;\"><a href=\"#unpin\" aria-label=\"unpin permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>unpin()</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token keyword\">void</span> <span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Buffer</span> buff<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      buff<span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">isPinned</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n         <span class=\"token function\">notifyAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>unpin()함수의 경우 기존과 달라진 부분이 따로 없다. Buffer의 pin count 감소하고, Pin count가 0이면 기다리는 스레드들에게 알림을 보낸다.</p>\n<h4 id=\"flushallint-txnum-함수-구현\" style=\"position:relative;\"><a href=\"#flushallint-txnum-%ED%95%A8%EC%88%98-%EA%B5%AC%ED%98%84\" aria-label=\"flushallint txnum 함수 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>flushAll(int txnum) 함수 구현</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token keyword\">void</span> <span class=\"token function\">flushAll</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> txnum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n\r\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">:</span> lru_list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n         buff<span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">isPinned</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n            buff<span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token punctuation\">}</span>\r\n         free_list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      lru_list<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      alloc_buffer<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>해당 함수에서는 우선 과제 명세설명 “LRU list에 있는 버퍼들을 모두 flush하고, free list에 빈 버퍼들을 추가” 에 따라 lru 리스트의 모든 버퍼들에 대해 flush를 진행하고 free_list에 추가했다. 그리고 공지 사항 설명중 “pin되어있는 모든 버퍼들도 강제로 unpin시키고 flush 수행”을 위해 각 버퍼마다 <code class=\"language-text\">pin == 0</code> 이 될때까지 unpin을 진행해 주었다.</p>\n<h4 id=\"printstatus-구현\" style=\"position:relative;\"><a href=\"#printstatus-%EA%B5%AC%ED%98%84\" aria-label=\"printstatus 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>printStatus() 구현</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"LRU list:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Buffer</span> buff <span class=\"token operator\">:</span> lru_list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n         <span class=\"token class-name\">String</span> is_pin <span class=\"token operator\">=</span> <span class=\"token string\">\"unpinned\"</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">.</span><span class=\"token function\">isPinned</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> is_pin <span class=\"token operator\">=</span> <span class=\"token string\">\"pinned\"</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Buffer \"</span> <span class=\"token operator\">+</span> buff<span class=\"token punctuation\">.</span><span class=\"token function\">getID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\": \"</span> <span class=\"token operator\">+</span> buff<span class=\"token punctuation\">.</span><span class=\"token function\">block</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span> <span class=\"token operator\">+</span> is_pin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n   <span class=\"token punctuation\">}</span></code></pre></div>\n<p>저번 <code class=\"language-text\">printStatus()</code> 와는 조금 다르게 alloc_buffer가 아닌 LRU 리스트에 대해 정보를 출력하도록 하였다.\r\n각 버퍼의 ID, block, pinnedStatus 를 출력하며, BlockId의 <code class=\"language-text\">toString()</code> 메소드를 활용하였다. 자바의 반복문을 사용하면 자동으로 LRU list head부터 버퍼를 순차적으로 출력한다.</p>\n<h4 id=\"gethitratio-구현\" style=\"position:relative;\"><a href=\"#gethitratio-%EA%B5%AC%ED%98%84\" aria-label=\"gethitratio 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>getHitRatio() 구현</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">float</span> <span class=\"token function\">getHitRatio</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">float</span> hit_ratio <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span>hit_cnt <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span>reference_cnt<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">BigDecimal</span> hit_ratio_bd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BigDecimal</span><span class=\"token punctuation\">(</span>hit_ratio<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">BigDecimal</span> hit_ratio_bd_r2 <span class=\"token operator\">=</span> hit_ratio_bd<span class=\"token punctuation\">.</span><span class=\"token function\">setScale</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">RoundingMode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">HALF_UP</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">return</span> hit_ratio_bd_r2<span class=\"token punctuation\">.</span><span class=\"token function\">floatValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">getHitRatio()</code> 함수는 이전 과제와 크게 다르지 않다. 똑같이 <code class=\"language-text\">tryToPin(blk)</code> 를 했을때 반환되는 buff가 널이 아닌경우, 즉 성공했을 경우에만(에러가 아닌 경우) <code class=\"language-text\">reference_cnt++;</code>가 되고, <code class=\"language-text\">findExistingBuffer(blk)</code> 의 결과값이 널이 아닐때, 즉 원하는 블럭을 찾았을 때만 hit_cnt++가 된다. 최종적으로는 <code class=\"language-text\">cnt/reference cnt * 100 (%)</code> 공식과 BigDecimal과 RoundingMode를 사용해 소숫점 2자리까지 반올림하여 리턴한다.</p>\n<h3 id=\"테스트\" style=\"position:relative;\"><a href=\"#%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"테스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>테스트</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BufferMgrTest</span> <span class=\"token punctuation\">{</span>\r\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">SimpleDB</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleDB</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"buffermgrtest\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"midIns\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// only 3 buffers</span>\r\n      <span class=\"token class-name\">BufferMgr</span> bm <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">bufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>생략<span class=\"token punctuation\">)</span>\r\n\r\n      <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Final Buffer Allocation:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>buff<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n         <span class=\"token class-name\">Buffer</span> b <span class=\"token operator\">=</span> buff<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> \r\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"buff[\"</span><span class=\"token operator\">+</span>i<span class=\"token operator\">+</span><span class=\"token string\">\"] pinned to block \"</span> <span class=\"token operator\">+</span> b<span class=\"token punctuation\">.</span><span class=\"token function\">block</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n   <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n결과\r\n<span class=\"token class-name\">Available</span> buffers<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\r\n<span class=\"token class-name\">Attempting</span> <span class=\"token keyword\">to</span> <span class=\"token namespace\">pin</span> block <span class=\"token number\">3.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\r\n<span class=\"token class-name\">Exception</span><span class=\"token operator\">:</span> <span class=\"token class-name\">No</span> available buffers\r\n\r\n<span class=\"token class-name\">Final</span> <span class=\"token class-name\">Buffer</span> <span class=\"token class-name\">Allocation</span><span class=\"token operator\">:</span>\r\nbuff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> pinned <span class=\"token keyword\">to</span> <span class=\"token namespace\">block</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\r\nbuff<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> pinned <span class=\"token keyword\">to</span> <span class=\"token namespace\">block</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\r\nbuff<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> pinned <span class=\"token keyword\">to</span> <span class=\"token namespace\">block</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\r\nbuff<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> pinned <span class=\"token keyword\">to</span> <span class=\"token namespace\">block</span> <span class=\"token punctuation\">[</span>file testfile<span class=\"token punctuation\">,</span> block <span class=\"token number\">3</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>과제 명세에 기본으로 소개되어있는 코드다. block 3를 pin 할때는 이미 블록이 꽉 차있기 때문에 Available buffers 가 0가 되는것이 맞으며, Exception 관련 코드도 잘 작동함을 알 수 있다. Final Buffer Allocation 의 결과도 기존과 동일함을 알 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BufferMgrTest</span> <span class=\"token punctuation\">{</span>\r\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">SimpleDB</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleDB</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"buffermgrtest\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"midIns\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">BufferMgr</span> bm <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">bufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buff <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> \r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n결과\r\n<span class=\"token constant\">LRU</span> list<span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">3</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">0</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token constant\">LRU</span> list<span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">3</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">4</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">0</span><span class=\"token punctuation\">]</span> unpinned</code></pre></div>\n<p>과제 명세의 예제 &#x3C;4개의 버퍼, test file의 블럭 0번 ~ 3번이 차례로 reference(pin) 된 후, block 2번과 0번이 unpin 되었을 때> 와 동일한 결과가 잘 관찰된다.</p>\n<p>hit ratio: 33.33\r\n위의 경우에 대하여 hit ratio 도 정상적으로 잘 출력된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BufferMgrTest</span> <span class=\"token punctuation\">{</span>\r\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">SimpleDB</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleDB</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"buffermgrtest\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"midIns\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">BufferMgr</span> bm <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">bufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buff <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> \r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n마지막 결과\r\n<span class=\"token constant\">LRU</span> list<span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">6</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">16</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">7</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">17</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">5</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">15</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token constant\">LRU</span> list<span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">6</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">16</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">7</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">17</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">8</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">18</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">5</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">15</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned</code></pre></div>\n<p>위의 코드는 총 8개의 버퍼를 pin 해본 것이다. 과제 명세의 그림</p>\n<p>처럼 8개의 리스트에서 9번째 블록(block 18)이 들어가는 위치는 앞에서 6번째로 잘 들어가는 모습을 보인다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BufferMgrTest</span> <span class=\"token punctuation\">{</span>\r\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token class-name\">SimpleDB</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleDB</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"buffermgrtest\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"midIns\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token class-name\">BufferMgr</span> bm <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">bufferMgr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buff <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Buffer</span><span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> \r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">unpin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">flushAll</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      buff<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bm<span class=\"token punctuation\">.</span><span class=\"token function\">pin</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BlockId</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      bm<span class=\"token punctuation\">.</span><span class=\"token function\">printStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n   <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n결과\r\n<span class=\"token constant\">LRU</span> list<span class=\"token operator\">:</span>\r\n<span class=\"token constant\">LRU</span> list<span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token constant\">LRU</span> list<span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token constant\">LRU</span> list<span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">14</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token constant\">LRU</span> list<span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">10</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">13</span><span class=\"token punctuation\">]</span> unpinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">20</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">12</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">11</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token constant\">LRU</span> list<span class=\"token operator\">:</span>\r\n<span class=\"token constant\">LRU</span> list<span class=\"token operator\">:</span>\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">32</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">31</span><span class=\"token punctuation\">]</span> pinned\r\n<span class=\"token class-name\">Buffer</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>file test<span class=\"token punctuation\">,</span> block <span class=\"token number\">30</span><span class=\"token punctuation\">]</span> pinned</code></pre></div>\n<p>우선 제일 처음 pin 하기 전에는 LRU list 에 아무것도 없다가 그 다음부터 순차적으로 들어간다. 그리고 기존의 10을 새롭게 pin하자 정상적으로 LRU 리스트의 제일 앞으로 가는 모습을 보여준다. 그리고 free list가 없는 상태에서 새로 pin을 요구할 경우 가장 뒤에있는 unpin 버퍼인 buffer 4를 선택하여 flush하고 새로 블럭 20을 할당하여 중간에 mid insert를 하는 모습을 보여준다. 그리고 flush all을 하면 LRU와 해시 맵에서 모든 버퍼가 제거된다. 이후 새롭게 넣으면 다시 잘 출력되는 모습을 보여준다.</p>\n<h2 id=\"source\" style=\"position:relative;\"><a href=\"#source\" aria-label=\"source permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Source</h2>\n<ul>\n<li>『SimpleDB: a simple java-based multiuser syst for teaching database internals』<br>\n<em>Edward Sciore - 지음</em><br>\n<a href=\"https://dl.acm.org/doi/10.1145/1227504.1227498\" target=\"_blank\" rel=\"nofollow\">https://dl.acm.org/doi/10.1145/1227504.1227498</a></li>\n</ul>","id":"ef73c11d-d26a-5663-a7bc-f1375dfe33b6","tableOfContents":"<ul>\n<li>\n<ul>\n<li>\n<ul>\n<li><a href=\"#simpledb%EB%9E%80-%EC%A3%BC%EC%9D%98-aws-simpledb%EC%95%84%EB%8B%98\">SimpleDB란? (주의! AWS SimpleDB아님)</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%AA%A9%ED%91%9C-midpoint-insertion-policy%EB%A5%BC-simpledb%EC%97%90-%EC%A0%81%EC%9A%A9%ED%95%B4-%EB%B3%B4%EC%9E%90\">목표: midpoint-insertion policy를 SimpleDB에 적용해 보자.</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B5%AC%ED%98%84-%EB%B0%8F-%ED%85%8C%EC%8A%A4%ED%8A%B8\">구현 및 테스트</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#free-buffer-list-allocated-buffer-lru-list-%EA%B8%B0%ED%83%80-%EB%B3%80%EC%88%98-%EC%84%A0%EC%96%B8-%EB%B0%8F-%EC%B4%88%EA%B8%B0%ED%99%94\">Free buffer list, Allocated Buffer, LRU list, 기타 변수 선언 및 초기화</a></li>\n<li><a href=\"#lru-midpoint-insertion-%EA%B8%B0%EB%8A%A5-%EA%B5%AC%ED%98%84\">LRU MidPoint Insertion 기능 구현</a></li>\n<li><a href=\"#available-%EA%B8%B0%EB%8A%A5-%EA%B5%AC%ED%98%84\">available() 기능 구현</a></li>\n<li><a href=\"#touch-%ED%95%A8%EC%88%98-%EA%B5%AC%ED%98%84\">touch() 함수 구현</a></li>\n<li><a href=\"#waitingtoolong-%EC%84%A4%EC%A0%95\">waitingTooLong() 설정</a></li>\n<li><a href=\"#pin-%EA%B5%AC%ED%98%84\">pin() 구현</a></li>\n<li><a href=\"#trytopin-%EA%B5%AC%ED%98%84\">tryToPin() 구현</a></li>\n<li><a href=\"#findexistingbuffer-%EA%B5%AC%ED%98%84\">findExistingBuffer() 구현</a></li>\n<li><a href=\"#choosefreebuffer\">chooseFreeBuffer()</a></li>\n<li><a href=\"#unpin\">unpin()</a></li>\n<li><a href=\"#flushallint-txnum-%ED%95%A8%EC%88%98-%EA%B5%AC%ED%98%84\">flushAll(int txnum) 함수 구현</a></li>\n<li><a href=\"#printstatus-%EA%B5%AC%ED%98%84\">printStatus() 구현</a></li>\n<li><a href=\"#gethitratio-%EA%B5%AC%ED%98%84\">getHitRatio() 구현</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%ED%85%8C%EC%8A%A4%ED%8A%B8\">테스트</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#source\">Source</a></p>\n</li>\n</ul>","frontmatter":{"title":"Boston College SimpleDB 개선 과제 part 2","summary":"Edward Sciore의 Java 기반 SimpleDB 개선 과제를 수행합니다.","date":"2024.04.20.","categories":["DB","Java"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAUCBAn/xAAXAQADAQAAAAAAAAAAAAAAAAADBAUH/9oADAMBAAIQAxAAAAHCmDVCKfXGgnoP/8QAGxAAAgIDAQAAAAAAAAAAAAAAAQMCBAUTFCL/2gAIAQEAAQUCNB0Q6tzlqfSMxri+3NzRMkf/xAAhEQADAAICAAcAAAAAAAAAAAABAgMEEQAhBRITFCJhgf/aAAgBAwEBPwHBXPfPm2WntsRKFmYUSjWPqHQmEZiJCfSGoFGbt5L3ynheDV2qr0VafMKsxoebR0NuD+a+hz//xAAfEQEAAQQCAwEAAAAAAAAAAAABEQIDEiEAURMxceH/2gAIAQIBAT8BxveLJKXbR1L7NT0639hI4XrtICDGpy/Of//EACMQAAECBQQDAQAAAAAAAAAAAAECEQADEiJRBCExQRNhccH/2gAIAQEABj8Cl2krmvS29tVKVHvosOcs0Jl03cKyTg78+hx7i3holk6ZC9TLQJSZ5mK6elZlEEeRKbHBALVFNZKj5FuVfc74gfMA/kf/xAAdEAEBAQACAgMAAAAAAAAAAAABESEAMUFxUYHh/9oACAEBAAE/IQG0cexFFhUE10C4lRDr5OuIMfEcarxjIoO3NSEuZ+ScdhntEVsLSLqHAd0Db6kQGVX2r6V8OjUMUqtWQ+uf/9oADAMBAAIAAwAAABD/AN//xAAYEQEBAQEBAAAAAAAAAAAAAAABESEAMf/aAAgBAwEBPxDXoyjODPN4BTjcwIniQAFfANwj3//EABkRAQEBAQEBAAAAAAAAAAAAAAERITEAQf/aAAgBAgEBPxB4MK2ICTwUULiCJ4saSqmV1uH15ff/xAAZEAEBAQEBAQAAAAAAAAAAAAABESEAMUH/2gAIAQEAAT8QiwJpIF+mcAPRyjUBhgAivpEi1hWLoHdSaiEVKqgVc5UrFHvA5OsSug3J8A9QCezU5OLQiSRaIotrWWH/2Q=="},"images":{"fallback":{"src":"/static/fd598b498e9c397c447258464db7e128/45aa4/common1.jpg","srcSet":"/static/fd598b498e9c397c447258464db7e128/5ecfb/common1.jpg 1404w,\n/static/fd598b498e9c397c447258464db7e128/028a7/common1.jpg 2808w,\n/static/fd598b498e9c397c447258464db7e128/45aa4/common1.jpg 5616w","sizes":"(min-width: 5616px) 5616px, 100vw"},"sources":[{"srcSet":"/static/fd598b498e9c397c447258464db7e128/75a72/common1.webp 1404w,\n/static/fd598b498e9c397c447258464db7e128/79cd7/common1.webp 2808w,\n/static/fd598b498e9c397c447258464db7e128/5e37e/common1.webp 5616w","type":"image/webp","sizes":"(min-width: 5616px) 5616px, 100vw"}]},"width":5616,"height":3744}},"publicURL":"/static/fd598b498e9c397c447258464db7e128/common1.jpg"}}}}]}},"pageContext":{"slug":"/db_hw2/"}},"staticQueryHashes":[]}